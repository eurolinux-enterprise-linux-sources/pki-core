diff -rupN pki-core-9.0.3.orig/CMakeLists.txt pki-core-9.0.3/CMakeLists.txt
--- pki-core-9.0.3.orig/CMakeLists.txt	2011-02-04 09:23:42.000000000 -0800
+++ pki-core-9.0.3/CMakeLists.txt	2015-02-04 15:53:27.000000000 -0800
@@ -58,7 +58,13 @@ macro_ensure_out_of_source_build("${PROJ
 
 # add macros
 include(MacroCopyFile)
-include(UseJava)
+include(Java)
+
+file(MAKE_DIRECTORY ${CMAKE_BINARY_DIR}/classes)
+file(MAKE_DIRECTORY ${CMAKE_BINARY_DIR}/dist)
+
+# required for all PKI components
+include(JUnit)
 
 # search for libraries
 
@@ -77,7 +83,8 @@ if (APPLICATION_FLAVOR_PKI_CORE      OR
     APPLICATION_FLAVOR_PKI_OCSP      OR
     APPLICATION_FLAVOR_PKI_TKS       OR
     APPLICATION_FLAVOR_PKI_CONSOLE   OR
-    APPLICATION_FLAVOR_PKI_MIGRATE)
+    APPLICATION_FLAVOR_PKI_MIGRATE   OR
+    APPLICATION_FLAVOR_DOGTAG_PKI_THEME)
     find_package(Java REQUIRED)
     find_package(JNI REQUIRED)
 endif ()
@@ -113,6 +120,29 @@ add_custom_target(uninstall
                   COMMAND ${CMAKE_COMMAND}
                       -P ${CMAKE_CURRENT_BINARY_DIR}/cmake_uninstall.cmake)
 
+# clean-dist target
+add_custom_target(clean-dist
+    COMMAND ${CMAKE_COMMAND}
+        -E remove_directory ${CMAKE_BINARY_DIR}/dist
+)
+
+# clean-cmake target
+add_custom_target(clean-cmake
+    COMMAND ${CMAKE_COMMAND}
+        -E remove_directory ${CMAKE_BINARY_DIR}/base
+    COMMAND ${CMAKE_COMMAND}
+        -E remove_directory ${CMAKE_BINARY_DIR}/CMakeFiles
+    COMMAND ${CMAKE_COMMAND}
+        -E remove -f
+        ${CMAKE_BINARY_DIR}/CMakeCache.txt
+        ${CMAKE_BINARY_DIR}/cmake_install.cmake
+        ${CMAKE_BINARY_DIR}/cmake_uninstall.cmake
+        ${CMAKE_BINARY_DIR}/config.h
+        ${CMAKE_BINARY_DIR}/CPackConfig.cmake
+        ${CMAKE_BINARY_DIR}/CPackSourceConfig.cmake
+        ${CMAKE_BINARY_DIR}/install_manifest.txt
+        ${CMAKE_BINARY_DIR}/Makefile
+)
 
 # check subdirectories
 if (APPLICATION_FLAVOR_PKI_CORE      OR
diff -rupN pki-core-9.0.3.orig/base/ca/CMakeLists.txt pki-core-9.0.3/base/ca/CMakeLists.txt
--- pki-core-9.0.3.orig/base/ca/CMakeLists.txt	2011-02-04 08:56:27.000000000 -0800
+++ pki-core-9.0.3/base/ca/CMakeLists.txt	2015-02-04 15:53:27.000000000 -0800
@@ -1,4 +1,4 @@
-project(ca Java)
+project(ca NONE)
 
 add_subdirectory(src)
 add_subdirectory(setup)
diff -rupN pki-core-9.0.3.orig/base/ca/src/CMakeLists.txt pki-core-9.0.3/base/ca/src/CMakeLists.txt
--- pki-core-9.0.3.orig/base/ca/src/CMakeLists.txt	2011-02-04 08:56:27.000000000 -0800
+++ pki-core-9.0.3/base/ca/src/CMakeLists.txt	2015-02-04 16:25:36.000000000 -0800
@@ -1,4 +1,4 @@
-project(pki-ca_java Java)
+project(pki-ca_java NONE)
 
 # '/usr/share/java' jars
 find_file(LDAPJDK_JAR
@@ -25,33 +25,37 @@ find_file(OSUTIL_JAR
 )
 
 
-# identify java sources
-set(pki-ca_java_SRCS
-    com/netscape/ca/CMSCRLExtensions.java
-    com/netscape/ca/CAService.java
-    com/netscape/ca/SigningUnit.java
-    com/netscape/ca/CRLWithExpiredCerts.java
-    com/netscape/ca/CRLIssuingPoint.java
-    com/netscape/ca/CAPolicy.java
-    com/netscape/ca/CertificateAuthority.java
+# build pki-ca
+javac(pki-ca-classes
+    SOURCES
+        com/netscape/ca/*.java
+    CLASSPATH
+        ${PKI_CERTSRV_JAR} ${PKI_CMS_JAR} ${PKI_CMSCORE_JAR}
+        ${PKI_CMSUTIL_JAR} ${PKI_NSUTIL_JAR}
+        ${LDAPJDK_JAR}
+        ${JSS_JAR} ${OSUTIL_JAR} ${SYMKEY_JAR}
+    OUTPUT_DIR
+        ${CMAKE_BINARY_DIR}/classes
+    DEPENDS
+        symkey-jar pki-nsutil-jar pki-cmsutil-jar pki-certsrv-jar pki-cms-jar pki-cmscore-jar
 )
 
+jar(pki-ca-jar
+    CREATE
+        ${CMAKE_BINARY_DIR}/dist/pki-ca.jar
+    INPUT_DIR
+        ${CMAKE_BINARY_DIR}/classes
+    FILES
+        com/netscape/ca/*.class
+    DEPENDS
+        pki-ca-classes
+)
 
-# set classpath
-set(CMAKE_JAVA_INCLUDE_PATH
-    ${PKI_CERTSRV_JAR} ${PKI_CMS_JAR} ${PKI_CMSCORE_JAR}
-    ${PKI_CMSUTIL_JAR} ${PKI_NSUTIL_JAR}
-    ${LDAPJDK_JAR}
-    ${JSS_JAR} ${OSUTIL_JAR} ${SYMKEY_JAR})
-
-
-# set version
-set(CMAKE_JAVA_TARGET_VERSION ${APPLICATION_VERSION})
-
-
-# build pki-ca.jar
-add_jar(pki-ca ${pki-ca_java_SRCS})
-add_dependencies(pki-ca osutil symkey pki-nsutil pki-cmsutil pki-certsrv pki-cms pki-cmscore)
-install_jar(pki-ca ${JAVA_JAR_INSTALL_DIR}/pki)
-set(PKI_CA_JAR ${pki-ca_JAR_FILE} CACHE INTERNAL "pki-ca jar file")
+install(
+    FILES
+        ${CMAKE_BINARY_DIR}/dist/pki-ca.jar
+    DESTINATION
+        ${JAVA_JAR_INSTALL_DIR}/pki
+)
 
+set(PKI_CA_JAR ${CMAKE_BINARY_DIR}/dist/pki-ca.jar CACHE INTERNAL "pki-ca jar file")
diff -rupN pki-core-9.0.3.orig/base/common/CMakeLists.txt pki-core-9.0.3/base/common/CMakeLists.txt
--- pki-core-9.0.3.orig/base/common/CMakeLists.txt	2011-02-04 08:57:14.000000000 -0800
+++ pki-core-9.0.3/base/common/CMakeLists.txt	2015-02-04 15:53:28.000000000 -0800
@@ -1,4 +1,4 @@
-project(common Java)
+project(common NONE)
 
 install(
     FILES
diff -rupN pki-core-9.0.3.orig/base/common/src/CMakeLists.txt pki-core-9.0.3/base/common/src/CMakeLists.txt
--- pki-core-9.0.3.orig/base/common/src/CMakeLists.txt	2015-02-04 15:42:26.000000000 -0800
+++ pki-core-9.0.3/base/common/src/CMakeLists.txt	2015-02-04 19:56:04.000000000 -0800
@@ -1,4 +1,4 @@
-project(pki-certsrv_java Java)
+project(pki-certsrv_java NONE)
 
 find_file(JSS_JAR
     NAMES
@@ -56,983 +56,158 @@ find_file(XERCES_JAR
         /usr/share/java
 )
 
-set(pki-certsrv_java_SRCS
-    com/netscape/certsrv/apps/ICommandQueue.java
-    com/netscape/certsrv/apps/CMS.java
-    com/netscape/certsrv/apps/ICMSEngine.java
-    com/netscape/certsrv/ldap/ILdapBoundConnFactory.java
-    com/netscape/certsrv/ldap/ILdapConnFactory.java
-    com/netscape/certsrv/ldap/ELdapException.java
-    com/netscape/certsrv/ldap/ILdapConnInfo.java
-    com/netscape/certsrv/ldap/ELdapServerDownException.java
-    com/netscape/certsrv/ldap/ILdapAuthInfo.java
-    com/netscape/certsrv/ldap/LdapResources.java
-    com/netscape/certsrv/ldap/ILdapConnModule.java
-    com/netscape/certsrv/listeners/ListenersResources.java
-    com/netscape/certsrv/listeners/IRequestListenerPlugin.java
-    com/netscape/certsrv/listeners/EListenersException.java
-    com/netscape/certsrv/common/TaskId.java
-    com/netscape/certsrv/common/DestDef.java
-    com/netscape/certsrv/common/NameValuePairs.java
-    com/netscape/certsrv/common/ScopeDef.java
-    com/netscape/certsrv/common/PrefixDef.java
-    com/netscape/certsrv/common/ConfigConstants.java
-    com/netscape/certsrv/common/NameValuePair.java
-    com/netscape/certsrv/common/OpDef.java
-    com/netscape/certsrv/common/Constants.java
-    com/netscape/certsrv/usrgrp/EUsrGrpException.java
-    com/netscape/certsrv/usrgrp/IGroupConstants.java
-    com/netscape/certsrv/usrgrp/Certificates.java
-    com/netscape/certsrv/usrgrp/ICertUserLocator.java
-    com/netscape/certsrv/usrgrp/IGroup.java
-    com/netscape/certsrv/usrgrp/IUser.java
-    com/netscape/certsrv/usrgrp/IUGSubsystem.java
-    com/netscape/certsrv/usrgrp/IIdEvaluator.java
-    com/netscape/certsrv/usrgrp/UsrGrpResources.java
-    com/netscape/certsrv/usrgrp/IUserConstants.java
-    com/netscape/certsrv/usrgrp/IUsrGrp.java
-    com/netscape/certsrv/pattern/Pattern.java
-    com/netscape/certsrv/pattern/AttrSetCollection.java
-    com/netscape/certsrv/publish/ILdapPlugin.java
-    com/netscape/certsrv/publish/ECompSyntaxErr.java
-    com/netscape/certsrv/publish/ERuleNotFound.java
-    com/netscape/certsrv/publish/ILdapPublishModule.java
-    com/netscape/certsrv/publish/EMapperPluginNotFound.java
-    com/netscape/certsrv/publish/RulePlugin.java
-    com/netscape/certsrv/publish/EPublisherNotFound.java
-    com/netscape/certsrv/publish/MapperPlugin.java
-    com/netscape/certsrv/publish/EPublisherPluginNotFound.java
-    com/netscape/certsrv/publish/IXcertPublisherProcessor.java
-    com/netscape/certsrv/publish/PublisherProxy.java
-    com/netscape/certsrv/publish/ICRLPublisher.java
-    com/netscape/certsrv/publish/ILdapPublisher.java
-    com/netscape/certsrv/publish/EMapperNotFound.java
-    com/netscape/certsrv/publish/ILdapPluginImpl.java
-    com/netscape/certsrv/publish/ILdapRule.java
-    com/netscape/certsrv/publish/IPublisherProcessor.java
-    com/netscape/certsrv/publish/LdapCertMapResult.java
-    com/netscape/certsrv/publish/IPublishRuleSet.java
-    com/netscape/certsrv/publish/ILdapExpression.java
-    com/netscape/certsrv/publish/ILdapCertMapper.java
-    com/netscape/certsrv/publish/ILdapMapper.java
-    com/netscape/certsrv/publish/PublisherPlugin.java
-    com/netscape/certsrv/publish/ERulePluginNotFound.java
-    com/netscape/certsrv/publish/MapperProxy.java
-    com/netscape/certsrv/publish/ILdapCrlMapper.java
-    com/netscape/certsrv/util/IStatsSubsystem.java
-    com/netscape/certsrv/util/HttpInput.java
-    com/netscape/certsrv/util/StatsEvent.java
-    com/netscape/certsrv/policy/IGeneralNameUtil.java
-    com/netscape/certsrv/policy/IGeneralNamesAsConstraintsConfig.java
-    com/netscape/certsrv/policy/IExpression.java
-    com/netscape/certsrv/policy/EPolicyException.java
-    com/netscape/certsrv/policy/PolicyResources.java
-    com/netscape/certsrv/policy/IGeneralNamesConfig.java
-    com/netscape/certsrv/policy/IPolicySet.java
-    com/netscape/certsrv/policy/IPolicyProcessor.java
-    com/netscape/certsrv/policy/IKeyRecoveryPolicy.java
-    com/netscape/certsrv/policy/IGeneralNameConfig.java
-    com/netscape/certsrv/policy/IPolicyPredicateParser.java
-    com/netscape/certsrv/policy/IKeyArchivalPolicy.java
-    com/netscape/certsrv/policy/IRevocationPolicy.java
-    com/netscape/certsrv/policy/ISubjAltNameConfig.java
-    com/netscape/certsrv/policy/IGeneralNameAsConstraintsConfig.java
-    com/netscape/certsrv/policy/IEnrollmentPolicy.java
-    com/netscape/certsrv/policy/IRenewalPolicy.java
-    com/netscape/certsrv/policy/IPolicyRule.java
-    com/netscape/certsrv/acls/IACL.java
-    com/netscape/certsrv/acls/ACLsResources.java
-    com/netscape/certsrv/acls/EACLsException.java
-    com/netscape/certsrv/acls/ACL.java
-    com/netscape/certsrv/acls/IACLEntry.java
-    com/netscape/certsrv/acls/ACLEntry.java
-    com/netscape/certsrv/cert/ICrossCertPairSubsystem.java
-    com/netscape/certsrv/registry/IPluginInfo.java
-    com/netscape/certsrv/registry/ERegistryException.java
-    com/netscape/certsrv/registry/IPluginRegistry.java
-    com/netscape/certsrv/base/EPropertyNotDefined.java
-    com/netscape/certsrv/base/MessageFormatter.java
-    com/netscape/certsrv/base/MetaInfo.java
-    com/netscape/certsrv/base/ITimeSource.java
-    com/netscape/certsrv/base/AttributeNameHelper.java
-    com/netscape/certsrv/base/ISourceConfigStore.java
-    com/netscape/certsrv/base/PasswordResources.java
-    com/netscape/certsrv/base/ASubsystem.java
-    com/netscape/certsrv/base/IArgBlock.java
-    com/netscape/certsrv/base/SessionContext.java
-    com/netscape/certsrv/base/IExtPrettyPrint.java
-    com/netscape/certsrv/base/IConfigStoreEventListener.java
-    com/netscape/certsrv/base/Plugin.java
-    com/netscape/certsrv/base/IConfigStore.java
-    com/netscape/certsrv/base/EPropertyNotFound.java
-    com/netscape/certsrv/base/ISubsystem.java
-    com/netscape/certsrv/base/ISubsystemSource.java
-    com/netscape/certsrv/base/IPrettyPrintFormat.java
-    com/netscape/certsrv/base/MetaAttributeDef.java
-    com/netscape/certsrv/base/IAuthInfo.java
-    com/netscape/certsrv/base/ExtendedPluginInfo.java
-    com/netscape/certsrv/base/EBaseException.java
-    com/netscape/certsrv/base/Nonces.java
-    com/netscape/certsrv/base/ISecurityDomainSessionTable.java
-    com/netscape/certsrv/base/IExtendedPluginInfo.java
-    com/netscape/certsrv/base/KeyGenInfo.java
-    com/netscape/certsrv/base/BaseResources.java
-    com/netscape/certsrv/base/IPluginImpl.java
-    com/netscape/certsrv/base/IAttrSet.java
-    com/netscape/certsrv/base/ICRLPrettyPrint.java
-    com/netscape/certsrv/base/ICertPrettyPrint.java
-    com/netscape/certsrv/dbs/IDBRegistry.java
-    com/netscape/certsrv/dbs/IDBAttrMapper.java
-    com/netscape/certsrv/dbs/IElementProcessor.java
-    com/netscape/certsrv/dbs/Modification.java
-    com/netscape/certsrv/dbs/EDBNotAvailException.java
-    com/netscape/certsrv/dbs/IDBVirtualList.java
-    com/netscape/certsrv/dbs/keydb/KeyState.java
-    com/netscape/certsrv/dbs/keydb/IKeyRecord.java
-    com/netscape/certsrv/dbs/keydb/IKeyRecordList.java
-    com/netscape/certsrv/dbs/keydb/IKeyRepository.java
-    com/netscape/certsrv/dbs/crldb/ICRLRepository.java
-    com/netscape/certsrv/dbs/crldb/ICRLIssuingPointRecord.java
-    com/netscape/certsrv/dbs/EDBException.java
-    com/netscape/certsrv/dbs/certdb/ICertRecordList.java
-    com/netscape/certsrv/dbs/certdb/ICertificateRepository.java
-    com/netscape/certsrv/dbs/certdb/IRevocationInfo.java
-    com/netscape/certsrv/dbs/certdb/ICertRecord.java
-    com/netscape/certsrv/dbs/DBResources.java
-    com/netscape/certsrv/dbs/IDBSearchResults.java
-    com/netscape/certsrv/dbs/IFilterConverter.java
-    com/netscape/certsrv/dbs/ModificationSet.java
-    com/netscape/certsrv/dbs/IDBDynAttrMapper.java
-    com/netscape/certsrv/dbs/IDBSubsystem.java
-    com/netscape/certsrv/dbs/repository/IRepository.java
-    com/netscape/certsrv/dbs/repository/IRepositoryRecord.java
-    com/netscape/certsrv/dbs/IDBObj.java
-    com/netscape/certsrv/dbs/EDBRecordNotFoundException.java
-    com/netscape/certsrv/dbs/IDBSSession.java
-    com/netscape/certsrv/dbs/replicadb/IReplicaIDRepository.java
-    com/netscape/certsrv/kra/IShare.java
-    com/netscape/certsrv/kra/EKRAException.java
-    com/netscape/certsrv/kra/ProofOfArchival.java
-    com/netscape/certsrv/kra/IKeyService.java
-    com/netscape/certsrv/kra/IJoinShares.java
-    com/netscape/certsrv/kra/IKeyRecoveryAuthority.java
-    com/netscape/certsrv/kra/IProofOfArchival.java
-    com/netscape/certsrv/kra/KRAResources.java
-    com/netscape/certsrv/authentication/ISharedToken.java
-    com/netscape/certsrv/authentication/AuthMgrPlugin.java
-    com/netscape/certsrv/authentication/EInvalidCredentials.java
-    com/netscape/certsrv/authentication/EAuthMgrNotFound.java
-    com/netscape/certsrv/authentication/ECompSyntaxErr.java
-    com/netscape/certsrv/authentication/EAuthUserError.java
-    com/netscape/certsrv/authentication/IAuthToken.java
-    com/netscape/certsrv/authentication/EAuthInternalError.java
-    com/netscape/certsrv/authentication/IAuthManager.java
-    com/netscape/certsrv/authentication/AuthManagerProxy.java
-    com/netscape/certsrv/authentication/AuthToken.java
-    com/netscape/certsrv/authentication/AuthCredentials.java
-    com/netscape/certsrv/authentication/EAuthMgrPluginNotFound.java
-    com/netscape/certsrv/authentication/ISSLClientCertProvider.java
-    com/netscape/certsrv/authentication/EMissingCredential.java
-    com/netscape/certsrv/authentication/EAuthException.java
-    com/netscape/certsrv/authentication/IAuthSubsystem.java
-    com/netscape/certsrv/authentication/IAuthCredentials.java
-    com/netscape/certsrv/authentication/AuthResources.java
-    com/netscape/certsrv/authentication/EFormSubjectDN.java
-    com/netscape/certsrv/authorization/AuthzManagerProxy.java
-    com/netscape/certsrv/authorization/IAuthzManager.java
-    com/netscape/certsrv/authorization/EAuthzUnknownProtectedRes.java
-    com/netscape/certsrv/authorization/AuthzMgrPlugin.java
-    com/netscape/certsrv/authorization/AuthzToken.java
-    com/netscape/certsrv/authorization/IAuthzSubsystem.java
-    com/netscape/certsrv/authorization/AuthzResources.java
-    com/netscape/certsrv/authorization/EAuthzUnknownOperation.java
-    com/netscape/certsrv/authorization/EAuthzAccessDenied.java
-    com/netscape/certsrv/authorization/EAuthzException.java
-    com/netscape/certsrv/authorization/EAuthzMgrNotFound.java
-    com/netscape/certsrv/authorization/EAuthzInternalError.java
-    com/netscape/certsrv/authorization/EAuthzMgrPluginNotFound.java
-    com/netscape/certsrv/extensions/ICMSExtension.java
-    com/netscape/certsrv/extensions/ExtensionsResources.java
-    com/netscape/certsrv/extensions/EExtensionsException.java
-    com/netscape/certsrv/authority/ICertAuthority.java
-    com/netscape/certsrv/authority/IAuthority.java
-    com/netscape/certsrv/template/IArgValue.java
-    com/netscape/certsrv/template/ArgString.java
-    com/netscape/certsrv/template/ArgSet.java
-    com/netscape/certsrv/template/ArgList.java
-    com/netscape/certsrv/ra/IRAService.java
-    com/netscape/certsrv/ra/IRegistrationAuthority.java
-    com/netscape/certsrv/password/IPasswordCheck.java
-    com/netscape/certsrv/password/IConfigPasswordCheck.java
-    com/netscape/certsrv/password/EPasswordCheckException.java
-    com/netscape/certsrv/jobs/JobPlugin.java
-    com/netscape/certsrv/jobs/IJob.java
-    com/netscape/certsrv/jobs/EJobsException.java
-    com/netscape/certsrv/jobs/IJobCron.java
-    com/netscape/certsrv/jobs/JobsResources.java
-    com/netscape/certsrv/jobs/IJobsScheduler.java
-    com/netscape/certsrv/selftests/ESelfTestException.java
-    com/netscape/certsrv/selftests/EMissingSelfTestException.java
-    com/netscape/certsrv/selftests/EInvalidSelfTestException.java
-    com/netscape/certsrv/selftests/ISelfTest.java
-    com/netscape/certsrv/selftests/SelfTestResources.java
-    com/netscape/certsrv/selftests/ISelfTestSubsystem.java
-    com/netscape/certsrv/selftests/EDuplicateSelfTestException.java
-    com/netscape/certsrv/request/ldap/IRequestMod.java
-    com/netscape/certsrv/request/IRequestNotifier.java
-    com/netscape/certsrv/request/IRequestSubsystem.java
-    com/netscape/certsrv/request/PolicyResult.java
-    com/netscape/certsrv/request/INotify.java
-    com/netscape/certsrv/request/IRequestList.java
-    com/netscape/certsrv/request/IEnrollmentRequest.java
-    com/netscape/certsrv/request/AgentApprovals.java
-    com/netscape/certsrv/request/IRequestRecord.java
-    com/netscape/certsrv/request/RequestId.java
-    com/netscape/certsrv/request/IService.java
-    com/netscape/certsrv/request/IRequestListener.java
-    com/netscape/certsrv/request/AgentApproval.java
-    com/netscape/certsrv/request/RequestStatus.java
-    com/netscape/certsrv/request/IRequestScheduler.java
-    com/netscape/certsrv/request/IRequest.java
-    com/netscape/certsrv/request/IRequestQueue.java
-    com/netscape/certsrv/request/ARequestNotifier.java
-    com/netscape/certsrv/request/PolicyMessage.java
-    com/netscape/certsrv/request/IPolicy.java
-    com/netscape/certsrv/request/IRequestVirtualList.java
-    com/netscape/certsrv/evaluators/IAccessEvaluator.java
-    com/netscape/certsrv/tks/ITKSAuthority.java
-    com/netscape/certsrv/property/EPropertyException.java
-    com/netscape/certsrv/property/PropertySet.java
-    com/netscape/certsrv/property/IConfigTemplate.java
-    com/netscape/certsrv/property/IDescriptor.java
-    com/netscape/certsrv/property/Descriptor.java
-    com/netscape/certsrv/logging/LogResources.java
-    com/netscape/certsrv/logging/ConsoleError.java
-    com/netscape/certsrv/logging/ILogEventFactory.java
-    com/netscape/certsrv/logging/SignedAuditEvent.java
-    com/netscape/certsrv/logging/SystemEvent.java
-    com/netscape/certsrv/logging/AuditFormat.java
-    com/netscape/certsrv/logging/AuditEvent.java
-    com/netscape/certsrv/logging/ELogNotFound.java
-    com/netscape/certsrv/logging/ILogEvent.java
-    com/netscape/certsrv/logging/ELogException.java
-    com/netscape/certsrv/logging/ConsoleLog.java
-    com/netscape/certsrv/logging/LogPlugin.java
-    com/netscape/certsrv/logging/ILogSubsystem.java
-    com/netscape/certsrv/logging/IBundleLogEvent.java
-    com/netscape/certsrv/logging/ELogPluginNotFound.java
-    com/netscape/certsrv/logging/ILogger.java
-    com/netscape/certsrv/logging/ILogQueue.java
-    com/netscape/certsrv/logging/ILogEventListener.java
-    com/netscape/certsrv/ca/ICMSCRLExtensions.java
-    com/netscape/certsrv/ca/ICertificateAuthority.java
-    com/netscape/certsrv/ca/EErrorPublishCRL.java
-    com/netscape/certsrv/ca/ICAService.java
-    com/netscape/certsrv/ca/ECAException.java
-    com/netscape/certsrv/ca/ICMSCRLExtension.java
-    com/netscape/certsrv/ca/ICRLIssuingPoint.java
-    com/netscape/certsrv/ca/CAResources.java
-    com/netscape/certsrv/connector/IConnector.java
-    com/netscape/certsrv/connector/IHttpConnFactory.java
-    com/netscape/certsrv/connector/IPKIMessage.java
-    com/netscape/certsrv/connector/IRequestEncoder.java
-    com/netscape/certsrv/connector/IResender.java
-    com/netscape/certsrv/connector/IHttpPKIMessage.java
-    com/netscape/certsrv/connector/IHttpConnection.java
-    com/netscape/certsrv/connector/IRemoteAuthority.java
-    com/netscape/certsrv/security/IStorageKeyUnit.java
-    com/netscape/certsrv/security/IEncryptionUnit.java
-    com/netscape/certsrv/security/KeyCertData.java
-    com/netscape/certsrv/security/ICryptoSubsystem.java
-    com/netscape/certsrv/security/ITransportKeyUnit.java
-    com/netscape/certsrv/security/IToken.java
-    com/netscape/certsrv/security/ISigningUnit.java
-    com/netscape/certsrv/security/Credential.java
-    com/netscape/certsrv/client/connection/IAuthenticator.java
-    com/netscape/certsrv/client/connection/IConnectionFactory.java
-    com/netscape/certsrv/client/connection/IConnection.java
-    com/netscape/certsrv/client/IDataProcessor.java
-    com/netscape/certsrv/ocsp/IOCSPService.java
-    com/netscape/certsrv/ocsp/IOCSPStore.java
-    com/netscape/certsrv/ocsp/IDefStore.java
-    com/netscape/certsrv/ocsp/IOCSPAuthority.java
-    com/netscape/certsrv/notification/IEmailFormProcessor.java
-    com/netscape/certsrv/notification/IMailNotification.java
-    com/netscape/certsrv/notification/IEmailTemplate.java
-    com/netscape/certsrv/notification/IEmailResolver.java
-    com/netscape/certsrv/notification/IEmailResolverKeys.java
-    com/netscape/certsrv/notification/ENotificationException.java
-    com/netscape/certsrv/notification/NotificationResources.java
-    com/netscape/certsrv/profile/IProfileEx.java
-    com/netscape/certsrv/profile/ERejectException.java
-    com/netscape/certsrv/profile/ICertInfoPolicyDefault.java
-    com/netscape/certsrv/profile/IPolicyConstraint.java
-    com/netscape/certsrv/profile/IProfileInput.java
-    com/netscape/certsrv/profile/IProfileAuthenticator.java
-    com/netscape/certsrv/profile/IProfile.java
-    com/netscape/certsrv/profile/IProfileOutput.java
-    com/netscape/certsrv/profile/IProfileContext.java
-    com/netscape/certsrv/profile/EDeferException.java
-    com/netscape/certsrv/profile/EProfileException.java
-    com/netscape/certsrv/profile/CertInfoProfile.java
-    com/netscape/certsrv/profile/IPolicyDefault.java
-    com/netscape/certsrv/profile/IEnrollProfile.java
-    com/netscape/certsrv/profile/IProfileSubsystem.java
-    com/netscape/certsrv/profile/IProfileUpdater.java
-    com/netscape/certsrv/profile/IProfilePolicy.java
-)
-
-set(pki-cms_java_SRCS
-    com/netscape/cms/listeners/PinRemovalListener.java
-    com/netscape/cms/listeners/RequestInQListener.java
-    com/netscape/cms/listeners/CertificateIssuedListener.java
-    com/netscape/cms/listeners/CertificateRevokedListener.java
-    com/netscape/cms/publish/mappers/LdapCertSubjMap.java
-    com/netscape/cms/publish/mappers/MapRDNPattern.java
-    com/netscape/cms/publish/mappers/NoMap.java
-    com/netscape/cms/publish/mappers/LdapEnhancedMap.java
-    com/netscape/cms/publish/mappers/MapDNPattern.java
-    com/netscape/cms/publish/mappers/LdapCertCompsMap.java
-    com/netscape/cms/publish/mappers/AVAPattern.java
-    com/netscape/cms/publish/mappers/LdapCaSimpleMap.java
-    com/netscape/cms/publish/mappers/LdapCertExactMap.java
-    com/netscape/cms/publish/mappers/MapAVAPattern.java
-    com/netscape/cms/publish/mappers/LdapCrlIssuerCompsMap.java
-    com/netscape/cms/publish/mappers/LdapDNCompsMap.java
-    com/netscape/cms/publish/mappers/LdapSimpleMap.java
-    com/netscape/cms/publish/publishers/LdapEncryptCertPublisher.java
-    com/netscape/cms/publish/publishers/LdapUserCertPublisher.java
-    com/netscape/cms/publish/publishers/LdapCaCertPublisher.java
-    com/netscape/cms/publish/publishers/FileBasedPublisher.java
-    com/netscape/cms/publish/publishers/LdapCrlPublisher.java
-    com/netscape/cms/publish/publishers/LdapCertificatePairPublisher.java
-    com/netscape/cms/publish/publishers/Utils.java
-    com/netscape/cms/publish/publishers/OCSPPublisher.java
-    com/netscape/cms/publish/publishers/LdapCertSubjPublisher.java
-    com/netscape/cms/policy/constraints/UniqueSubjectNameConstraints.java
-    com/netscape/cms/policy/constraints/AgentPolicy.java
-    com/netscape/cms/policy/constraints/KeyAlgorithmConstraints.java
-    com/netscape/cms/policy/constraints/IssuerConstraints.java
-    com/netscape/cms/policy/constraints/RevocationConstraints.java
-    com/netscape/cms/policy/constraints/DefaultRevocation.java
-    com/netscape/cms/policy/constraints/RSAKeyConstraints.java
-    com/netscape/cms/policy/constraints/DSAKeyConstraints.java
-    com/netscape/cms/policy/constraints/UniqueSubjectName.java
-    com/netscape/cms/policy/constraints/ManualAuthentication.java
-    com/netscape/cms/policy/constraints/RenewalValidityConstraints.java
-    com/netscape/cms/policy/constraints/SigningAlgorithmConstraints.java
-    com/netscape/cms/policy/constraints/AttributePresentConstraints.java
-    com/netscape/cms/policy/constraints/ValidityConstraints.java
-    com/netscape/cms/policy/constraints/RenewalConstraints.java
-    com/netscape/cms/policy/constraints/SubCANameConstraints.java
-    com/netscape/cms/policy/APolicyRule.java
-    com/netscape/cms/policy/extensions/OCSPNoCheckExt.java
-    com/netscape/cms/policy/extensions/AuthorityKeyIdentifierExt.java
-    com/netscape/cms/policy/extensions/CertificatePoliciesExt.java
-    com/netscape/cms/policy/extensions/SubjAltNameExt.java
-    com/netscape/cms/policy/extensions/RemoveBasicConstraintsExt.java
-    com/netscape/cms/policy/extensions/CertificateScopeOfUseExt.java
-    com/netscape/cms/policy/extensions/GenericASN1Ext.java
-    com/netscape/cms/policy/extensions/ExtendedKeyUsageExt.java
-    com/netscape/cms/policy/extensions/SubjectDirectoryAttributesExt.java
-    com/netscape/cms/policy/extensions/AuthInfoAccessExt.java
-    com/netscape/cms/policy/extensions/NameConstraintsExt.java
-    com/netscape/cms/policy/extensions/PolicyConstraintsExt.java
-    com/netscape/cms/policy/extensions/PresenceExt.java
-    com/netscape/cms/policy/extensions/NSCCommentExt.java
-    com/netscape/cms/policy/extensions/BasicConstraintsExt.java
-    com/netscape/cms/policy/extensions/IssuerAltNameExt.java
-    com/netscape/cms/policy/extensions/PolicyMappingsExt.java
-    com/netscape/cms/policy/extensions/SubjectAltNameExt.java
-    com/netscape/cms/policy/extensions/CRLDistributionPointsExt.java
-    com/netscape/cms/policy/extensions/SubjectKeyIdentifierExt.java
-    com/netscape/cms/policy/extensions/CertificateRenewalWindowExt.java
-    com/netscape/cms/policy/extensions/PrivateKeyUsagePeriodExt.java
-    com/netscape/cms/policy/extensions/KeyUsageExt.java
-    com/netscape/cms/policy/extensions/NSCertTypeExt.java
-    com/netscape/cms/servlet/filter/AdminRequestFilter.java
-    com/netscape/cms/servlet/filter/EEClientAuthRequestFilter.java
-    com/netscape/cms/servlet/filter/EERequestFilter.java
-    com/netscape/cms/servlet/filter/AgentRequestFilter.java
-    com/netscape/cms/servlet/common/GenRejectedTemplateFiller.java
-    com/netscape/cms/servlet/common/ICMSTemplateFiller.java
-    com/netscape/cms/servlet/common/IndexTemplateFiller.java
-    com/netscape/cms/servlet/common/GenSuccessTemplateFiller.java
-    com/netscape/cms/servlet/common/ECMSGWException.java
-    com/netscape/cms/servlet/common/CMSTemplate.java
-    com/netscape/cms/servlet/common/GenErrorTemplateFiller.java
-    com/netscape/cms/servlet/common/AuthCredentials.java
-    com/netscape/cms/servlet/common/CMSLoadTemplate.java
-    com/netscape/cms/servlet/common/CMSFileLoader.java
-    com/netscape/cms/servlet/common/RawJS.java
-    com/netscape/cms/servlet/common/GenSvcPendingTemplateFiller.java
-    com/netscape/cms/servlet/common/CMSTemplateParams.java
-    com/netscape/cms/servlet/common/GenUnauthorizedTemplateFiller.java
-    com/netscape/cms/servlet/common/CMCOutputTemplate.java
-    com/netscape/cms/servlet/common/CMSGateway.java
-    com/netscape/cms/servlet/common/CMSRequest.java
-    com/netscape/cms/servlet/common/CMSFile.java
-    com/netscape/cms/servlet/common/IRawJS.java
-    com/netscape/cms/servlet/common/Utils.java
-    com/netscape/cms/servlet/common/GenPendingTemplateFiller.java
-    com/netscape/cms/servlet/common/CMSGWResources.java
-    com/netscape/cms/servlet/common/GenUnexpectedErrorTemplateFiller.java
-    com/netscape/cms/servlet/cert/UpdateCRL.java
-    com/netscape/cms/servlet/cert/GetInfo.java
-    com/netscape/cms/servlet/cert/RevocationSuccessTemplateFiller.java
-    com/netscape/cms/servlet/cert/DoUnrevoke.java
-    com/netscape/cms/servlet/cert/DisplayBySerial.java
-    com/netscape/cms/servlet/cert/GetCertFromRequest.java
-    com/netscape/cms/servlet/cert/HashEnrollServlet.java
-    com/netscape/cms/servlet/cert/UpdateDir.java
-    com/netscape/cms/servlet/cert/scep/ExtensionsRequested.java
-    com/netscape/cms/servlet/cert/scep/CRSEnrollment.java
-    com/netscape/cms/servlet/cert/scep/ChallengePassword.java
-    com/netscape/cms/servlet/cert/EnrollServlet.java
-    com/netscape/cms/servlet/cert/DisableEnrollResult.java
-    com/netscape/cms/servlet/cert/GetEnableStatus.java
-    com/netscape/cms/servlet/cert/DisplayHashUserEnroll.java
-    com/netscape/cms/servlet/cert/DoRevoke.java
-    com/netscape/cms/servlet/cert/ChallengeRevocationServlet1.java
-    com/netscape/cms/servlet/cert/CloneRedirect.java
-    com/netscape/cms/servlet/cert/EnableEnrollResult.java
-    com/netscape/cms/servlet/cert/ImportCertsTemplateFiller.java
-    com/netscape/cms/servlet/cert/GetCAChain.java
-    com/netscape/cms/servlet/cert/SrchCerts.java
-    com/netscape/cms/servlet/cert/Monitor.java
-    com/netscape/cms/servlet/cert/GetCRL.java
-    com/netscape/cms/servlet/cert/ReasonToRevoke.java
-    com/netscape/cms/servlet/cert/ListCerts.java
-    com/netscape/cms/servlet/cert/RenewalServlet.java
-    com/netscape/cms/servlet/cert/DoRevokeTPS.java
-    com/netscape/cms/servlet/cert/DirAuthServlet.java
-    com/netscape/cms/servlet/cert/RemoteAuthConfig.java
-    com/netscape/cms/servlet/cert/DoUnrevokeTPS.java
-    com/netscape/cms/servlet/cert/RevocationServlet.java
-    com/netscape/cms/servlet/cert/CMCRevReqServlet.java
-    com/netscape/cms/servlet/cert/GetBySerial.java
-    com/netscape/cms/servlet/cert/DisplayCRL.java
-    com/netscape/cms/servlet/admin/OCSPAdminServlet.java
-    com/netscape/cms/servlet/admin/CMSAdminServlet.java
-    com/netscape/cms/servlet/admin/JobsAdminServlet.java
-    com/netscape/cms/servlet/admin/PublisherAdminServlet.java
-    com/netscape/cms/servlet/admin/ProfileAdminServlet.java
-    com/netscape/cms/servlet/admin/ACLAdminServlet.java
-    com/netscape/cms/servlet/admin/AuthCredentials.java
-    com/netscape/cms/servlet/admin/CAAdminServlet.java
-    com/netscape/cms/servlet/admin/PolicyAdminServlet.java
-    com/netscape/cms/servlet/admin/RegistryAdminServlet.java
-    com/netscape/cms/servlet/admin/AuthAdminServlet.java
-    com/netscape/cms/servlet/admin/UsrGrpAdminServlet.java
-    com/netscape/cms/servlet/admin/AdminServlet.java
-    com/netscape/cms/servlet/admin/KRAAdminServlet.java
-    com/netscape/cms/servlet/admin/LogAdminServlet.java
-    com/netscape/cms/servlet/admin/RAAdminServlet.java
-    com/netscape/cms/servlet/admin/AdminResources.java
-    com/netscape/cms/servlet/key/DisplayBySerial.java
-    com/netscape/cms/servlet/key/SrchKey.java
-    com/netscape/cms/servlet/key/DisplayTransport.java
-    com/netscape/cms/servlet/key/GrantRecovery.java
-    com/netscape/cms/servlet/key/SrchKeyForRecovery.java
-    com/netscape/cms/servlet/key/GrantAsyncRecovery.java
-    com/netscape/cms/servlet/key/GetApprovalStatus.java
-    com/netscape/cms/servlet/key/ConfirmRecoverBySerial.java
-    com/netscape/cms/servlet/key/ExamineRecovery.java
-    com/netscape/cms/servlet/key/GetPk12.java
-    com/netscape/cms/servlet/key/GetAsyncPk12.java
-    com/netscape/cms/servlet/key/RecoverBySerial.java
-    com/netscape/cms/servlet/key/KeyRecordParser.java
-    com/netscape/cms/servlet/key/DisplayBySerialForRecovery.java
-    com/netscape/cms/servlet/base/IndexServlet.java
-    com/netscape/cms/servlet/base/UserInfo.java
-    com/netscape/cms/servlet/base/PortsServlet.java
-    com/netscape/cms/servlet/base/CMSServlet.java
-    com/netscape/cms/servlet/base/CMSStartServlet.java
-    com/netscape/cms/servlet/base/ProxyServlet.java
-    com/netscape/cms/servlet/base/DynamicVariablesServlet.java
-    com/netscape/cms/servlet/base/GetStats.java
-    com/netscape/cms/servlet/base/SystemInfoServlet.java
-    com/netscape/cms/servlet/base/DisplayHtmlServlet.java
-    com/netscape/cms/servlet/csadmin/BaseServlet.java
-    com/netscape/cms/servlet/csadmin/ConfigCertReqServlet.java
-    com/netscape/cms/servlet/csadmin/ImportAdminCertPanel.java
-    com/netscape/cms/servlet/csadmin/ConfigHSMLoginPanel.java
-    com/netscape/cms/servlet/csadmin/SizePanel.java
-    com/netscape/cms/servlet/csadmin/Cert.java
-    com/netscape/cms/servlet/csadmin/UpdateConnector.java
-    com/netscape/cms/servlet/csadmin/DonePanel.java
-    com/netscape/cms/servlet/csadmin/GetTokenInfo.java
-    com/netscape/cms/servlet/csadmin/WizardPanelBase.java
-    com/netscape/cms/servlet/csadmin/CheckIdentity.java
-    com/netscape/cms/servlet/csadmin/UpdateNumberRange.java
-    com/netscape/cms/servlet/csadmin/ConfigCertApprovalCallback.java
-    com/netscape/cms/servlet/csadmin/AgentAuthenticatePanel.java
-    com/netscape/cms/servlet/csadmin/ConfigRootCAServlet.java
-    com/netscape/cms/servlet/csadmin/ConfigJoinServlet.java
-    com/netscape/cms/servlet/csadmin/AuthenticatePanel.java
-    com/netscape/cms/servlet/csadmin/ConfigCloneServlet.java
-    com/netscape/cms/servlet/csadmin/ImportCAChainPanel.java
-    com/netscape/cms/servlet/csadmin/DisplayServlet.java
-    com/netscape/cms/servlet/csadmin/DatabasePanel.java
-    com/netscape/cms/servlet/csadmin/WelcomePanel.java
-    com/netscape/cms/servlet/csadmin/DatabaseServlet.java
-    com/netscape/cms/servlet/csadmin/CAInfoPanel.java
-    com/netscape/cms/servlet/csadmin/GetTransportCert.java
-    com/netscape/cms/servlet/csadmin/ImportTransportCert.java
-    com/netscape/cms/servlet/csadmin/SessionTimer.java
-    com/netscape/cms/servlet/csadmin/ModulePanel.java
-    com/netscape/cms/servlet/csadmin/GetConfigEntries.java
-    com/netscape/cms/servlet/csadmin/UpdateDomainXML.java
-    com/netscape/cms/servlet/csadmin/GetStatus.java
-    com/netscape/cms/servlet/csadmin/BackupKeyCertPanel.java
-    com/netscape/cms/servlet/csadmin/TokenAuthenticate.java
-    com/netscape/cms/servlet/csadmin/SecurityDomainLogin.java
-    com/netscape/cms/servlet/csadmin/ConfigDatabaseServlet.java
-    com/netscape/cms/servlet/csadmin/ConfigBaseServlet.java
-    com/netscape/cms/servlet/csadmin/CertUtil.java
-    com/netscape/cms/servlet/csadmin/SecurityDomainPanel.java
-    com/netscape/cms/servlet/csadmin/ConfigImportCertServlet.java
-    com/netscape/cms/servlet/csadmin/SecurityDomainSessionTable.java
-    com/netscape/cms/servlet/csadmin/GetCertChain.java
-    com/netscape/cms/servlet/csadmin/CreateSubsystemPanel.java
-    com/netscape/cms/servlet/csadmin/DisplayCertChainPanel.java
-    com/netscape/cms/servlet/csadmin/UpdateOCSPConfig.java
-    com/netscape/cms/servlet/csadmin/GetDomainXML.java
-    com/netscape/cms/servlet/csadmin/LDAPSecurityDomainSessionTable.java
-    com/netscape/cms/servlet/csadmin/AdminAuthenticatePanel.java
-    com/netscape/cms/servlet/csadmin/ModuleServlet.java
-    com/netscape/cms/servlet/csadmin/GetCookie.java
-    com/netscape/cms/servlet/csadmin/CertRequestPanel.java
-    com/netscape/cms/servlet/csadmin/RegisterUser.java
-    com/netscape/cms/servlet/csadmin/GetSubsystemCert.java
-    com/netscape/cms/servlet/csadmin/CertPrettyPrintPanel.java
-    com/netscape/cms/servlet/csadmin/WelcomeServlet.java
-    com/netscape/cms/servlet/csadmin/LoginServlet.java
-    com/netscape/cms/servlet/csadmin/AdminPanel.java
-    com/netscape/cms/servlet/csadmin/RestoreKeyCertPanel.java
-    com/netscape/cms/servlet/csadmin/ConfigHSMServlet.java
-    com/netscape/cms/servlet/csadmin/MainPageServlet.java
-    com/netscape/cms/servlet/csadmin/HierarchyPanel.java
-    com/netscape/cms/servlet/csadmin/DownloadPKCS12.java
-    com/netscape/cms/servlet/csadmin/SavePKCS12Panel.java
-    com/netscape/cms/servlet/csadmin/NamePanel.java
-    com/netscape/cms/servlet/wizard/WizardServlet.java
-    com/netscape/cms/servlet/wizard/IWizardPanel.java
-    com/netscape/cms/servlet/processors/PKCS10Processor.java
-    com/netscape/cms/servlet/processors/PKIProcessor.java
-    com/netscape/cms/servlet/processors/KeyGenProcessor.java
-    com/netscape/cms/servlet/processors/CRMFProcessor.java
-    com/netscape/cms/servlet/processors/IPKIProcessor.java
-    com/netscape/cms/servlet/processors/CMCProcessor.java
-    com/netscape/cms/servlet/request/ProcessReq.java
-    com/netscape/cms/servlet/request/CheckRequest.java
-    com/netscape/cms/servlet/request/IReqParser.java
-    com/netscape/cms/servlet/request/ReqParser.java
-    com/netscape/cms/servlet/request/QueryReq.java
-    com/netscape/cms/servlet/request/SearchReqs.java
-    com/netscape/cms/servlet/request/ProcessCertReq.java
-    com/netscape/cms/servlet/request/CertReqParser.java
-    com/netscape/cms/servlet/request/KeyReqParser.java
-    com/netscape/cms/servlet/tks/TokenServlet.java
-    com/netscape/cms/servlet/connector/CloneServlet.java
-    com/netscape/cms/servlet/connector/TokenKeyRecoveryServlet.java
-    com/netscape/cms/servlet/connector/GenerateKeyPairServlet.java
-    com/netscape/cms/servlet/connector/ConnectorServlet.java
-    com/netscape/cms/servlet/ocsp/OCSPServlet.java
-    com/netscape/cms/servlet/ocsp/ListCAServlet.java
-    com/netscape/cms/servlet/ocsp/AddCRLServlet.java
-    com/netscape/cms/servlet/ocsp/CheckCertServlet.java
-    com/netscape/cms/servlet/ocsp/RemoveCAServlet.java
-    com/netscape/cms/servlet/ocsp/GetOCSPInfo.java
-    com/netscape/cms/servlet/ocsp/AddCAServlet.java
-    com/netscape/cms/servlet/profile/ProfileSubmitServlet.java
-    com/netscape/cms/servlet/profile/ProfileSubmitCMCServlet.java
-    com/netscape/cms/servlet/profile/ProfileSelectServlet.java
-    com/netscape/cms/servlet/profile/ProfileProcessServlet.java
-    com/netscape/cms/servlet/profile/ProfileListServlet.java
-    com/netscape/cms/servlet/profile/ProfileApproveServlet.java
-    com/netscape/cms/servlet/profile/ProfileReviewServlet.java
-    com/netscape/cms/servlet/profile/SSLClientCertProvider.java
-    com/netscape/cms/servlet/profile/ProfileServlet.java
-    com/netscape/cms/authentication/AgentCertAuthentication.java
-    com/netscape/cms/authentication/PortalEnroll.java
-    com/netscape/cms/authentication/UdnPwdDirAuthentication.java
-    com/netscape/cms/authentication/TokenAuthentication.java
-    com/netscape/cms/authentication/Crypt.java
-    com/netscape/cms/authentication/CMCAuth.java
-    com/netscape/cms/authentication/HashAuthData.java
-    com/netscape/cms/authentication/SharedSecret.java
-    com/netscape/cms/authentication/FlatFileAuth.java
-    com/netscape/cms/authentication/AVAPattern.java
-    com/netscape/cms/authentication/RDNPattern.java
-    com/netscape/cms/authentication/DNPattern.java
-    com/netscape/cms/authentication/DirBasedAuthentication.java
-    com/netscape/cms/authentication/HashAuthentication.java
-    com/netscape/cms/authentication/UidPwdPinDirAuthentication.java
-    com/netscape/cms/authentication/SSLclientCertAuthentication.java
-    com/netscape/cms/authentication/UidPwdDirAuthentication.java
-    com/netscape/cms/authentication/UserPwdDirAuthentication.java
-    com/netscape/cms/authorization/BasicAclAuthz.java
-    com/netscape/cms/authorization/AAclAuthz.java
-    com/netscape/cms/authorization/DirAclAuthz.java
-    com/netscape/cms/shares/OldJoinShares.java
-    com/netscape/cms/shares/OldShare.java
-    com/netscape/cms/password/PasswordChecker.java
-    com/netscape/cms/jobs/UnpublishExpiredJob.java
-    com/netscape/cms/jobs/RenewalNotificationJob.java
-    com/netscape/cms/jobs/RequestInQueueJob.java
-    com/netscape/cms/jobs/AJobBase.java
-    com/netscape/cms/jobs/PublishCertsJob.java
-    com/netscape/cms/selftests/ASelfTest.java
-    com/netscape/cms/selftests/kra/KRAPresence.java
-    com/netscape/cms/selftests/ra/RAPresence.java
-    com/netscape/cms/selftests/tks/TKSKnownSessionKey.java
-    com/netscape/cms/selftests/ca/CAPresence.java
-    com/netscape/cms/selftests/ca/CAValidity.java
-    com/netscape/cms/selftests/common/SystemCertsVerification.java
-    com/netscape/cms/selftests/ocsp/OCSPValidity.java
-    com/netscape/cms/selftests/ocsp/OCSPPresence.java
-    com/netscape/cms/request/RequestScheduler.java
-    com/netscape/cms/crl/CMSIssuingDistributionPointExtension.java
-    com/netscape/cms/crl/CMSAuthInfoAccessExtension.java
-    com/netscape/cms/crl/CMSCRLReasonExtension.java
-    com/netscape/cms/crl/CMSDeltaCRLIndicatorExtension.java
-    com/netscape/cms/crl/CMSCertificateIssuerExtension.java
-    com/netscape/cms/crl/CMSHoldInstructionExtension.java
-    com/netscape/cms/crl/CMSCRLNumberExtension.java
-    com/netscape/cms/crl/CMSIssuerAlternativeNameExtension.java
-    com/netscape/cms/crl/CMSFreshestCRLExtension.java
-    com/netscape/cms/crl/CMSAuthorityKeyIdentifierExtension.java
-    com/netscape/cms/crl/CMSInvalidityDateExtension.java
-    com/netscape/cms/evaluators/IPAddressAccessEvaluator.java
-    com/netscape/cms/evaluators/UserOrigReqAccessEvaluator.java
-    com/netscape/cms/evaluators/GroupAccessEvaluator.java
-    com/netscape/cms/evaluators/UserAccessEvaluator.java
-    com/netscape/cms/logging/LogEntry.java
-    com/netscape/cms/logging/LogFile.java
-    com/netscape/cms/logging/RollingLogFile.java
-    com/netscape/cms/ocsp/DefStore.java
-    com/netscape/cms/ocsp/LDAPStore.java
-    com/netscape/cms/notification/MailNotification.java
-    com/netscape/cms/profile/common/CACertCAEnrollProfile.java
-    com/netscape/cms/profile/common/ProfilePolicy.java
-    com/netscape/cms/profile/common/EnrollProfile.java
-    com/netscape/cms/profile/common/ServerCertCAEnrollProfile.java
-    com/netscape/cms/profile/common/CAEnrollProfile.java
-    com/netscape/cms/profile/common/RAEnrollProfile.java
-    com/netscape/cms/profile/common/ProfileContext.java
-    com/netscape/cms/profile/common/EnrollProfileContext.java
-    com/netscape/cms/profile/common/BasicProfile.java
-    com/netscape/cms/profile/common/UserCertCAEnrollProfile.java
-    com/netscape/cms/profile/def/UserSubjectNameDefault.java
-    com/netscape/cms/profile/def/AutoAssignDefault.java
-    com/netscape/cms/profile/def/AuthInfoAccessExtDefault.java
-    com/netscape/cms/profile/def/CRLDistributionPointsExtDefault.java
-    com/netscape/cms/profile/def/SubjectAltNameExtDefault.java
-    com/netscape/cms/profile/def/IssuerAltNameExtDefault.java
-    com/netscape/cms/profile/def/CAEnrollDefault.java
-    com/netscape/cms/profile/def/ExtendedKeyUsageExtDefault.java
-    com/netscape/cms/profile/def/SubjectNameDefault.java
-    com/netscape/cms/profile/def/NoDefault.java
-    com/netscape/cms/profile/def/SubjectInfoAccessExtDefault.java
-    com/netscape/cms/profile/def/PolicyConstraintsExtDefault.java
-    com/netscape/cms/profile/def/InhibitAnyPolicyExtDefault.java
-    com/netscape/cms/profile/def/nsTokenUserKeySubjectNameDefault.java
-    com/netscape/cms/profile/def/EnrollDefault.java
-    com/netscape/cms/profile/def/OCSPNoCheckExtDefault.java
-    com/netscape/cms/profile/def/BasicConstraintsExtDefault.java
-    com/netscape/cms/profile/def/SigningAlgDefault.java
-    com/netscape/cms/profile/def/GenericExtDefault.java
-    com/netscape/cms/profile/def/nsNKeySubjectNameDefault.java
-    com/netscape/cms/profile/def/AuthorityKeyIdentifierExtDefault.java
-    com/netscape/cms/profile/def/UserKeyDefault.java
-    com/netscape/cms/profile/def/NSCCommentExtDefault.java
-    com/netscape/cms/profile/def/CertificateVersionDefault.java
-    com/netscape/cms/profile/def/ValidityDefault.java
-    com/netscape/cms/profile/def/ImageDefault.java
-    com/netscape/cms/profile/def/PolicyMappingsExtDefault.java
-    com/netscape/cms/profile/def/NSCertTypeExtDefault.java
-    com/netscape/cms/profile/def/CAValidityDefault.java
-    com/netscape/cms/profile/def/UserSigningAlgDefault.java
-    com/netscape/cms/profile/def/SubjectDirAttributesExtDefault.java
-    com/netscape/cms/profile/def/PrivateKeyUsagePeriodExtDefault.java
-    com/netscape/cms/profile/def/UserValidityDefault.java
-    com/netscape/cms/profile/def/EnrollExtDefault.java
-    com/netscape/cms/profile/def/nsTokenDeviceKeySubjectNameDefault.java
-    com/netscape/cms/profile/def/KeyUsageExtDefault.java
-    com/netscape/cms/profile/def/FreshestCRLExtDefault.java
-    com/netscape/cms/profile/def/AuthTokenSubjectNameDefault.java
-    com/netscape/cms/profile/def/nsHKeySubjectNameDefault.java
-    com/netscape/cms/profile/def/UserExtensionDefault.java
-    com/netscape/cms/profile/def/NameConstraintsExtDefault.java
-    com/netscape/cms/profile/def/SubjectKeyIdentifierExtDefault.java
-    com/netscape/cms/profile/def/CertificatePoliciesExtDefault.java
-    com/netscape/cms/profile/input/SubjectDNInput.java
-    com/netscape/cms/profile/input/SerialNumRenewInput.java
-    com/netscape/cms/profile/input/SubjectNameInput.java
-    com/netscape/cms/profile/input/KeyGenInput.java
-    com/netscape/cms/profile/input/ImageInput.java
-    com/netscape/cms/profile/input/EnrollInput.java
-    com/netscape/cms/profile/input/nsNKeyCertReqInput.java
-    com/netscape/cms/profile/input/FileSigningInput.java
-    com/netscape/cms/profile/input/nsHKeyCertReqInput.java
-    com/netscape/cms/profile/input/CertReqInput.java
-    com/netscape/cms/profile/input/SubmitterInfoInput.java
-    com/netscape/cms/profile/input/GenericInput.java
-    com/netscape/cms/profile/input/DualKeyGenInput.java
-    com/netscape/cms/profile/input/CMCCertReqInput.java
-    com/netscape/cms/profile/constraint/KeyConstraint.java
-    com/netscape/cms/profile/constraint/KeyUsageExtConstraint.java
-    com/netscape/cms/profile/constraint/NSCertTypeExtConstraint.java
-    com/netscape/cms/profile/constraint/EnrollConstraint.java
-    com/netscape/cms/profile/constraint/RenewGracePeriodConstraint.java
-    com/netscape/cms/profile/constraint/ExtensionConstraint.java
-    com/netscape/cms/profile/constraint/BasicConstraintsExtConstraint.java
-    com/netscape/cms/profile/constraint/NoConstraint.java
-    com/netscape/cms/profile/constraint/SubjectNameConstraint.java
-    com/netscape/cms/profile/constraint/ExtendedKeyUsageExtConstraint.java
-    com/netscape/cms/profile/constraint/UniqueSubjectNameConstraint.java
-    com/netscape/cms/profile/constraint/CAEnrollConstraint.java
-    com/netscape/cms/profile/constraint/SigningAlgConstraint.java
-    com/netscape/cms/profile/constraint/ValidityConstraint.java
-    com/netscape/cms/profile/constraint/UniqueKeyConstraint.java
-    com/netscape/cms/profile/constraint/CAValidityConstraint.java
-    com/netscape/cms/profile/updater/SubsystemGroupUpdater.java
-    com/netscape/cms/profile/output/CertOutput.java
-    com/netscape/cms/profile/output/EnrollOutput.java
-    com/netscape/cms/profile/output/nsNKeyOutput.java
-    com/netscape/cms/profile/output/PKCS7Output.java
-    com/netscape/cms/profile/output/CMMFOutput.java
-)
 
-set(pki-cmscore_java_SRCS
-    com/netscape/cmscore/apps/PKIServerEvent.java
-    com/netscape/cmscore/apps/Upgrade.java
-    com/netscape/cmscore/apps/PKIServerListener.java
-    com/netscape/cmscore/apps/CommandQueue.java
-    com/netscape/cmscore/apps/CMSEngine.java
-    com/netscape/cmscore/apps/Setup.java
-    com/netscape/cmscore/ldap/LdapSimpleExpression.java
-    com/netscape/cmscore/ldap/LdapAndExpression.java
-    com/netscape/cmscore/ldap/LdapPublishModule.java
-    com/netscape/cmscore/ldap/LdapPredicateParser.java
-    com/netscape/cmscore/ldap/LdapRequestListener.java
-    com/netscape/cmscore/ldap/LdapConnModule.java
-    com/netscape/cmscore/ldap/LdapOrExpression.java
-    com/netscape/cmscore/ldap/PublishObject.java
-    com/netscape/cmscore/ldap/PublisherProcessor.java
-    com/netscape/cmscore/ldap/LdapRule.java
-    com/netscape/cmscore/listeners/ListenerPlugin.java
-    com/netscape/cmscore/usrgrp/CertDNCertUserLocator.java
-    com/netscape/cmscore/usrgrp/Group.java
-    com/netscape/cmscore/usrgrp/ExactMatchCertUserLocator.java
-    com/netscape/cmscore/usrgrp/UGSubsystem.java
-    com/netscape/cmscore/usrgrp/User.java
-    com/netscape/cmscore/crmf/CRMFParser.java
-    com/netscape/cmscore/crmf/PKIArchiveOptionsContainer.java
-    com/netscape/cmscore/util/AssertionException.java
-    com/netscape/cmscore/util/ProfileSubsystem.java
-    com/netscape/cmscore/util/FileAsString.java
-    com/netscape/cmscore/util/Assert.java
-    com/netscape/cmscore/util/UtilMessage.java
-    com/netscape/cmscore/util/PFXUtils.java
-    com/netscape/cmscore/util/ExceptionFormatter.java
-    com/netscape/cmscore/util/StatsSubsystem.java
-    com/netscape/cmscore/util/FileDialogFilter.java
-    com/netscape/cmscore/util/OsSubsystem.java
-    com/netscape/cmscore/util/Debug.java
-    com/netscape/cmscore/util/UtilResources.java
-    com/netscape/cmscore/policy/JavaScriptRequestProxy.java
-    com/netscape/cmscore/policy/SimpleExpression.java
-    com/netscape/cmscore/policy/GeneralNameUtil.java
-    com/netscape/cmscore/policy/PolicyPredicateParser.java
-    com/netscape/cmscore/policy/AndExpression.java
-    com/netscape/cmscore/policy/PolicySet.java
-    com/netscape/cmscore/policy/GenericPolicyProcessor.java
-    com/netscape/cmscore/policy/OrExpression.java
-    com/netscape/cmscore/cert/CertificatePair.java
-    com/netscape/cmscore/cert/X500NameSubsystem.java
-    com/netscape/cmscore/cert/CertUtils.java
-    com/netscape/cmscore/cert/ExtPrettyPrint.java
-    com/netscape/cmscore/cert/OidLoaderSubsystem.java
-    com/netscape/cmscore/cert/CrlPrettyPrint.java
-    com/netscape/cmscore/cert/CertPrettyPrint.java
-    com/netscape/cmscore/cert/PrettyPrintResources.java
-    com/netscape/cmscore/cert/PrettyPrintFormat.java
-    com/netscape/cmscore/cert/CrossCertPairSubsystem.java
-    com/netscape/cmscore/cert/CertDateCompare.java
-    com/netscape/cmscore/cert/PubKeyPrettyPrint.java
-    com/netscape/cmscore/cert/CrlCachePrettyPrint.java
-    com/netscape/cmscore/registry/PluginInfo.java
-    com/netscape/cmscore/registry/PluginRegistry.java
-    com/netscape/cmscore/base/ArgBlock.java
-    com/netscape/cmscore/base/FileConfigStore.java
-    com/netscape/cmscore/base/SimpleProperties.java
-    com/netscape/cmscore/base/SourceConfigStore.java
-    com/netscape/cmscore/base/PropConfigStore.java
-    com/netscape/cmscore/base/JDialogPasswordCallback.java
-    com/netscape/cmscore/base/SubsystemRegistry.java
-    com/netscape/cmscore/base/SubsystemLoader.java
-    com/netscape/cmscore/dbs/CRLRepository.java
-    com/netscape/cmscore/dbs/CertRecord.java
-    com/netscape/cmscore/dbs/RevocationInfoMapper.java
-    com/netscape/cmscore/dbs/BigIntegerMapper.java
-    com/netscape/cmscore/dbs/X509CertImplMapper.java
-    com/netscape/cmscore/dbs/KeyRecord.java
-    com/netscape/cmscore/dbs/KeyStateMapper.java
-    com/netscape/cmscore/dbs/StringVectorMapper.java
-    com/netscape/cmscore/dbs/DBSSession.java
-    com/netscape/cmscore/dbs/DBSubsystem.java
-    com/netscape/cmscore/dbs/StringMapper.java
-    com/netscape/cmscore/dbs/LongMapper.java
-    com/netscape/cmscore/dbs/CertRecordList.java
-    com/netscape/cmscore/dbs/MetaInfoMapper.java
-    com/netscape/cmscore/dbs/RepositorySchema.java
-    com/netscape/cmscore/dbs/PublicKeyMapper.java
-    com/netscape/cmscore/dbs/KeyDBSchema.java
-    com/netscape/cmscore/dbs/LdapFilterConverter.java
-    com/netscape/cmscore/dbs/ObjectStreamMapper.java
-    com/netscape/cmscore/dbs/Repository.java
-    com/netscape/cmscore/dbs/CertificateRepository.java
-    com/netscape/cmscore/dbs/DBVirtualList.java
-    com/netscape/cmscore/dbs/KeyRecordList.java
-    com/netscape/cmscore/dbs/RepositoryRecord.java
-    com/netscape/cmscore/dbs/CRLIssuingPointRecord.java
-    com/netscape/cmscore/dbs/DBRegistry.java
-    com/netscape/cmscore/dbs/CRLDBSchema.java
-    com/netscape/cmscore/dbs/CertDBSchema.java
-    com/netscape/cmscore/dbs/DateMapper.java
-    com/netscape/cmscore/dbs/ByteArrayMapper.java
-    com/netscape/cmscore/dbs/CertRecordMapper.java
-    com/netscape/cmscore/dbs/DBSearchResults.java
-    com/netscape/cmscore/dbs/IntegerMapper.java
-    com/netscape/cmscore/dbs/RevocationInfo.java
-    com/netscape/cmscore/dbs/DBSUtil.java
-    com/netscape/cmscore/dbs/X500NameMapper.java
-    com/netscape/cmscore/dbs/KeyRepository.java
-    com/netscape/cmscore/dbs/ReplicaIDRepository.java
-    com/netscape/cmscore/dbs/DateArrayMapper.java
-    com/netscape/cmscore/dbs/KeyRecordMapper.java
-    com/netscape/cmscore/authentication/PasswdUserDBAuthentication.java
-    com/netscape/cmscore/authentication/NullAuthentication.java
-    com/netscape/cmscore/authentication/SSLClientCertAuthentication.java
-    com/netscape/cmscore/authentication/AuthSubsystem.java
-    com/netscape/cmscore/authentication/CertUserDBAuthentication.java
-    com/netscape/cmscore/authentication/VerifiedCert.java
-    com/netscape/cmscore/authentication/VerifiedCerts.java
-    com/netscape/cmscore/authentication/ChallengePhraseAuthentication.java
-    com/netscape/cmscore/authorization/AuthzSubsystem.java
-    com/netscape/cmscore/extensions/CMSExtensionsMap.java
-    com/netscape/cmscore/extensions/KeyUsage.java
-    com/netscape/cmscore/jobs/CronRange.java
-    com/netscape/cmscore/jobs/JobsScheduler.java
-    com/netscape/cmscore/jobs/CronItem.java
-    com/netscape/cmscore/jobs/JobCron.java
-    com/netscape/cmscore/selftests/SelfTestOrderedInstance.java
-    com/netscape/cmscore/selftests/SelfTestSubsystem.java
-    com/netscape/cmscore/request/ExtDataHashtable.java
-    com/netscape/cmscore/request/RequestAttr.java
-    com/netscape/cmscore/request/RequestQueue.java
-    com/netscape/cmscore/request/Schema.java
-    com/netscape/cmscore/request/RequestRepository.java
-    com/netscape/cmscore/request/ARequestRecord.java
-    com/netscape/cmscore/request/ARequestQueue.java
-    com/netscape/cmscore/request/CertRequestConstants.java
-    com/netscape/cmscore/request/RequestRecord.java
-    com/netscape/cmscore/request/RequestSubsystem.java
-    com/netscape/cmscore/ldapconn/LdapBoundConnection.java
-    com/netscape/cmscore/ldapconn/LdapConnInfo.java
-    com/netscape/cmscore/ldapconn/LdapAuthInfo.java
-    com/netscape/cmscore/ldapconn/LdapJssSSLSocketFactory.java
-    com/netscape/cmscore/ldapconn/LdapAnonConnFactory.java
-    com/netscape/cmscore/ldapconn/LdapBoundConnFactory.java
-    com/netscape/cmscore/ldapconn/LdapAnonConnection.java
-    com/netscape/cmscore/logging/AuditEventFactory.java
-    com/netscape/cmscore/logging/LogQueue.java
-    com/netscape/cmscore/logging/LogSubsystem.java
-    com/netscape/cmscore/logging/AuditFormat.java
-    com/netscape/cmscore/logging/Logger.java
-    com/netscape/cmscore/logging/SignedAuditEventFactory.java
-    com/netscape/cmscore/logging/SignedAuditLogger.java
-    com/netscape/cmscore/logging/SystemEventFactory.java
-    com/netscape/cmscore/connector/LocalConnector.java
-    com/netscape/cmscore/connector/HttpConnection.java
-    com/netscape/cmscore/connector/RequestTransfer.java
-    com/netscape/cmscore/connector/RemoteAuthority.java
-    com/netscape/cmscore/connector/HttpPKIMessage.java
-    com/netscape/cmscore/connector/HttpConnector.java
-    com/netscape/cmscore/connector/HttpConnFactory.java
-    com/netscape/cmscore/connector/HttpRequestEncoder.java
-    com/netscape/cmscore/connector/Resender.java
-    com/netscape/cmscore/security/OCSPSigningCert.java
-    com/netscape/cmscore/security/Provider.java
-    com/netscape/cmscore/security/KeyCertUtil.java
-    com/netscape/cmscore/security/KRATransportCert.java
-    com/netscape/cmscore/security/SSLCert.java
-    com/netscape/cmscore/security/SSLSelfSignedCert.java
-    com/netscape/cmscore/security/JssSubsystem.java
-    com/netscape/cmscore/security/SubsystemCert.java
-    com/netscape/cmscore/security/PWsdrCache.java
-    com/netscape/cmscore/security/CertificateInfo.java
-    com/netscape/cmscore/security/PWCBsdr.java
-    com/netscape/cmscore/security/PWUtil.java
-    com/netscape/cmscore/security/CASigningCert.java
-    com/netscape/cmscore/security/RASigningCert.java
-    com/netscape/cmscore/notification/ReqCertSANameEmailResolver.java
-    com/netscape/cmscore/notification/EmailResolverKeys.java
-    com/netscape/cmscore/notification/EmailTemplate.java
-    com/netscape/cmscore/notification/EmailFormProcessor.java
-    com/netscape/cmscore/notification/ReqCertEmailResolver.java
-    com/netscape/cmscore/profile/ProfileSubsystem.java
-    com/netscape/cmscore/time/SimpleTimeSource.java
-)
-
-set(pki-cmsbundle_RCS
-    LogMessages.properties
-    UserMessages.properties
+# build pki-certsrv
+javac(pki-certsrv-classes
+    SOURCES
+        com/netscape/certsrv/*.java
+    CLASSPATH
+        ${PKI_NSUTIL_JAR} ${PKI_CMSUTIL_JAR}
+        ${LDAPJDK_JAR} ${SERVLET_JAR} ${VELOCITY_JAR} ${XALAN_JAR} ${XERCES_JAR}
+        ${JSS_JAR} ${OSUTIL_JAR} ${SYMKEY_JAR}
+    OUTPUT_DIR
+        ${CMAKE_BINARY_DIR}/classes
+    DEPENDS
+        pki-nsutil-jar pki-cmsutil-jar
+)
+
+jar(pki-certsrv-jar
+    CREATE
+        ${CMAKE_BINARY_DIR}/dist/pki-certsrv.jar
+    INPUT_DIR
+        ${CMAKE_BINARY_DIR}/classes
+    FILES
+        com/netscape/certsrv/*.class
+    DEPENDS
+        pki-certsrv-classes
+)
+
+install(
+    FILES
+        ${CMAKE_BINARY_DIR}/dist/pki-certsrv.jar
+    DESTINATION
+        ${JAVA_JAR_INSTALL_DIR}/pki
 )
 
-set(CMAKE_JAVA_INCLUDE_PATH
-    ${PKI_NSUTIL_JAR} ${PKI_CMSUTIL_JAR}
-    ${LDAPJDK_JAR} ${SERVLET_JAR} ${VELOCITY_JAR} ${XALAN_JAR} ${XERCES_JAR}
-    ${JSS_JAR} ${OSUTIL_JAR} ${SYMKEY_JAR})
-
-set(CMAKE_JAVA_TARGET_VERSION ${APPLICATION_VERSION})
+set(PKI_CERTSRV_JAR ${CMAKE_BINARY_DIR}/dist/pki-certsrv.jar CACHE INTERNAL "pki-certsrv jar file")
 
-# build pki-certsrv
-set(CMAKE_JAR_CLASSES_PREFIX com/netscape/certsrv)
-add_jar(pki-certsrv ${pki-certsrv_java_SRCS})
-add_dependencies(pki-certsrv osutil pki-nsutil pki-cmsutil)
-install_jar(pki-certsrv ${JAVA_JAR_INSTALL_DIR}/pki)
-set(PKI_CERTSRV_JAR ${pki-certsrv_JAR_FILE} CACHE INTERNAL "pki-certsrv jar file")
 
 # build pki-cms
-set(CMAKE_JAR_CLASSES_PREFIX com/netscape/cms)
-add_jar(pki-cms ${pki-cms_java_SRCS})
-add_dependencies(pki-cms osutil pki-nsutil pki-cmsutil pki-certsrv)
-install_jar(pki-cms ${JAVA_JAR_INSTALL_DIR}/pki)
-set(PKI_CMS_JAR ${pki-cms_JAR_FILE} CACHE INTERNAL "pki-cms jar file")
-
-create_javadoc(pki-common-${APPLICATION_VERSION}
-    FILES ${pki-cms_java_SRCS} ${pki-certsrv_java_SRCS}
-    CLASSPATH ${CMAKE_JAVA_INCLUDE_PATH} ${pki-certsrv_JAR_FILE}
-    WINDOWTITLE "pki-common"
-    DOCTITLE "<h1>pki-common</h1>"
-    AUTHOR TRUE
-    USE TRUE
-    VERSION TRUE
+javac(pki-cms-classes
+    SOURCES
+        com/netscape/cms/*.java
+    CLASSPATH
+        ${PKI_NSUTIL_JAR} ${PKI_CMSUTIL_JAR}
+        ${LDAPJDK_JAR} ${SERVLET_JAR} ${VELOCITY_JAR} ${XALAN_JAR} ${XERCES_JAR}
+        ${JSS_JAR} ${OSUTIL_JAR} ${SYMKEY_JAR}
+    OUTPUT_DIR
+        ${CMAKE_BINARY_DIR}/classes
+    DEPENDS
+        pki-nsutil-jar pki-cmsutil-jar pki-certsrv-jar
+)
+
+jar(pki-cms-jar
+    CREATE
+        ${CMAKE_BINARY_DIR}/dist/pki-cms.jar
+    INPUT_DIR
+        ${CMAKE_BINARY_DIR}/classes
+    FILES
+        com/netscape/cms/*.class
+    DEPENDS
+        pki-cms-classes
+)
+
+install(
+    FILES
+        ${CMAKE_BINARY_DIR}/dist/pki-cms.jar
+    DESTINATION
+        ${JAVA_JAR_INSTALL_DIR}/pki
+)
+
+set(PKI_CMS_JAR ${CMAKE_BINARY_DIR}/dist/pki-cms.jar CACHE INTERNAL "pki-cms jar file")
+
+
+javadoc(pki-common
+    SOURCEPATH
+        ${CMAKE_SOURCE_DIR}/base/common/src
+    DEST
+        ${CMAKE_CURRENT_BINARY_DIR}/javadoc/pki-common-${APPLICATION_VERSION}
+    SUBPACKAGES
+        com.netscape.cms
+        com.netscape.certsrv
+    CLASSPATH
+        ${PKI_NSUTIL_JAR} ${PKI_CMSUTIL_JAR}
+        ${LDAPJDK_JAR} ${SERVLET_JAR} ${VELOCITY_JAR} ${XALAN_JAR} ${XERCES_JAR}
+        ${JSS_JAR} ${OSUTIL_JAR} ${SYMKEY_JAR}
+    OPTIONS
+        -windowtitle 'pki-common'
+        -doctitle '<h1>pki-common</h1>'
+        -author
+        -use
+        -version
+    DEPENDS
+        pki-cms-jar pki-certsrv-jar
+)
+
+install(
+    FILES
+        ${CMAKE_CURRENT_BINARY_DIR}/javadoc/pki-common-${APPLICATION_VERSION}
+    DESTINATION
+        ${CMAKE_INSTALL_PREFIX}/share/javadoc
 )
-add_dependencies(pki-common-${APPLICATION_VERSION}_javadoc pki-cms pki-certsrv)
+
 
 # build pki-cmscore
-set(CMAKE_JAR_CLASSES_PREFIX com/netscape/cmscore)
-add_jar(pki-cmscore ${pki-cmscore_java_SRCS})
-add_dependencies(pki-cmscore osutil pki-nsutil pki-cmsutil pki-certsrv pki-cms)
-install_jar(pki-cmscore ${JAVA_JAR_INSTALL_DIR}/pki)
-set(PKI_CMSCORE_JAR ${pki-cmscore_JAR_FILE} CACHE INTERNAL "pki-cmscore jar file")
+javac(pki-cmscore-classes
+    SOURCES
+        com/netscape/cmscore/*.java
+    CLASSPATH
+        ${PKI_NSUTIL_JAR} ${PKI_CMSUTIL_JAR}
+        ${LDAPJDK_JAR} ${SERVLET_JAR} ${VELOCITY_JAR} ${XALAN_JAR} ${XERCES_JAR}
+        ${JSS_JAR} ${OSUTIL_JAR} ${SYMKEY_JAR}
+    OUTPUT_DIR
+        ${CMAKE_BINARY_DIR}/classes
+    DEPENDS
+        pki-nsutil-jar pki-cmsutil-jar pki-certsrv-jar pki-cms-jar
+)
+
+jar(pki-cmscore-jar
+    CREATE
+        ${CMAKE_BINARY_DIR}/dist/pki-cmscore.jar
+    INPUT_DIR
+        ${CMAKE_BINARY_DIR}/classes
+    FILES
+        com/netscape/cmscore/*.class
+    DEPENDS
+        pki-cmscore-classes
+)
+
+install(
+    FILES
+        ${CMAKE_BINARY_DIR}/dist/pki-cmscore.jar
+    DESTINATION
+        ${JAVA_JAR_INSTALL_DIR}/pki
+)
+
+set(PKI_CMSCORE_JAR ${CMAKE_BINARY_DIR}/dist/pki-cmscore.jar CACHE INTERNAL "pki-cmscore jar file")
+
 
 # build pki-cmsbundle
-add_jar(pki-cmsbundle ${pki-cmsbundle_RCS})
-add_dependencies(pki-cmsbundle osutil pki-nsutil pki-cmsutil pki-certsrv pki-cms pki-cmscore)
-install_jar(pki-cmsbundle ${JAVA_JAR_INSTALL_DIR}/pki)
-set(PKI_CMSBUNDLE_JAR ${pki-cmsbundle_JAR_FILE} CACHE INTERNAL "pki-cmsbundle jar file")
+jar(pki-cmsbundle-jar
+    CREATE
+        ${CMAKE_BINARY_DIR}/dist/pki-cmsbundle.jar
+    FILES
+        LogMessages.properties
+        UserMessages.properties
+    DEPENDS
+        pki-nsutil-jar pki-cmsutil-jar pki-certsrv-jar pki-cms-jar pki-cmscore-jar
+)
+
+install(
+    FILES
+        ${CMAKE_BINARY_DIR}/dist/pki-cmsbundle.jar
+    DESTINATION
+        ${JAVA_JAR_INSTALL_DIR}/pki
+)
+
+set(PKI_CMSBUNDLE_JAR ${CMAKE_BINARY_DIR}/dist/pki-cmsbundle.jar CACHE INTERNAL "pki-cmsbundle jar file")
diff -rupN pki-core-9.0.3.orig/base/java-tools/CMakeLists.txt pki-core-9.0.3/base/java-tools/CMakeLists.txt
--- pki-core-9.0.3.orig/base/java-tools/CMakeLists.txt	2011-02-04 08:56:20.000000000 -0800
+++ pki-core-9.0.3/base/java-tools/CMakeLists.txt	2015-02-04 15:53:28.000000000 -0800
@@ -1,4 +1,4 @@
-project(java-tools Java)
+project(java-tools NONE)
 
 add_subdirectory(src)
 add_subdirectory(templates)
diff -rupN pki-core-9.0.3.orig/base/java-tools/src/CMakeLists.txt pki-core-9.0.3/base/java-tools/src/CMakeLists.txt
--- pki-core-9.0.3.orig/base/java-tools/src/CMakeLists.txt	2011-02-04 08:56:20.000000000 -0800
+++ pki-core-9.0.3/base/java-tools/src/CMakeLists.txt	2015-02-04 16:25:46.000000000 -0800
@@ -1,4 +1,4 @@
-project(pki-tools_java Java)
+project(pki-tools_java NONE)
 
 find_file(JSS_JAR
     NAMES
@@ -32,50 +32,66 @@ find_file(XERCES_JAR
         /usr/share/java
 )
 
-set(pki-tools_java_SRCS
-    com/netscape/cmstools/PrettyPrintCrl.java
-    com/netscape/cmstools/BtoA.java
-    com/netscape/cmstools/PasswordCache.java
-    com/netscape/cmstools/OCSPClient.java
-    com/netscape/cmstools/PKCS12Export.java
-    com/netscape/cmstools/TestCRLSigning.java
-    com/netscape/cmstools/CRMFPopClient.java
-    com/netscape/cmstools/AuditVerify.java
-    com/netscape/cmstools/PrettyPrintCert.java
-    com/netscape/cmstools/HttpClient.java
-    com/netscape/cmstools/GenExtKeyUsage.java
-    com/netscape/cmstools/CMCRevoke.java
-    com/netscape/cmstools/TokenInfo.java
-    com/netscape/cmstools/CMCEnroll.java
-    com/netscape/cmstools/ExtJoiner.java
-    com/netscape/cmstools/CMCRequest.java
-    com/netscape/cmstools/AtoB.java
-    com/netscape/cmstools/GenIssuerAltNameExt.java
-    com/netscape/cmstools/GenSubjectAltNameExt.java
-    com/netscape/cmstools/CMCResponse.java
-    com/netscape/cmstools/PKCS10Client.java
-)
-
-set(CMAKE_JAVA_INCLUDE_PATH
-    ${PKI_NSUTIL_JAR} ${PKI_CMSUTIL_JAR}
-    ${XALAN_JAR} ${XERCES_JAR}
-    ${JSS_JAR} ${OSUTIL_JAR})
-
-set(CMAKE_JAVA_TARGET_VERSION ${APPLICATION_VERSION})
 
 # build pki-tools
-add_jar(pki-tools ${pki-tools_java_SRCS})
-add_dependencies(pki-tools osutil pki-nsutil pki-cmsutil)
-install_jar(pki-tools ${JAVA_JAR_INSTALL_DIR}/pki)
-set(PKI_TOOLS_JAR ${pki-tools_JAR_FILE} CACHE INTERNAL "pki-tools jar file")
-
-create_javadoc(pki-java-tools-${APPLICATION_VERSION}
-    FILES ${pki-tools_java_SRCS}
-    CLASSPATH ${CMAKE_JAVA_INCLUDE_PATH}
-    WINDOWTITLE "pki-java-tools"
-    DOCTITLE "<h1>pki-java-tools</h1>"
-    AUTHOR TRUE
-    USE TRUE
-    VERSION TRUE
+javac(pki-tools-classes
+    SOURCES
+        com/netscape/cmstools/*.java
+    CLASSPATH
+        ${PKI_NSUTIL_JAR} ${PKI_CMSUTIL_JAR}
+        ${XALAN_JAR} ${XERCES_JAR}
+        ${JSS_JAR} ${OSUTIL_JAR}
+    OUTPUT_DIR
+        ${CMAKE_BINARY_DIR}/classes
+    DEPENDS
+        pki-nsutil-jar pki-cmsutil-jar
+)
+
+jar(pki-tools-jar
+    CREATE
+        ${CMAKE_BINARY_DIR}/dist/pki-tools.jar
+    INPUT_DIR
+        ${CMAKE_BINARY_DIR}/classes
+    FILES
+        com/netscape/cmstools/*.class
+    DEPENDS
+        pki-tools-classes
+)
+
+install(
+    FILES
+        ${CMAKE_BINARY_DIR}/dist/pki-tools.jar
+    DESTINATION
+        ${JAVA_JAR_INSTALL_DIR}/pki
+)
+
+set(PKI_TOOLS_JAR ${CMAKE_BINARY_DIR}/dist/pki-tools.jar CACHE INTERNAL "pki-tools jar file")
+
+
+javadoc(pki-java-tools
+    SOURCEPATH
+        ${CMAKE_SOURCE_DIR}/base/java-tools/src
+    DEST
+        ${CMAKE_CURRENT_BINARY_DIR}/javadoc/pki-java-tools-${APPLICATION_VERSION}
+    SUBPACKAGES
+        com.netscape.cmstools
+    CLASSPATH
+        ${PKI_NSUTIL_JAR} ${PKI_CMSUTIL_JAR}
+        ${XALAN_JAR} ${XERCES_JAR}
+        ${JSS_JAR} ${OSUTIL_JAR}
+    OPTIONS
+        -windowtitle 'pki-java-tools'
+        -doctitle '<h1>pki-java-tools</h1>'
+        -author
+        -use
+        -version
+    DEPENDS
+        pki-tools-jar
+)
+
+install(
+    FILES
+        ${CMAKE_CURRENT_BINARY_DIR}/javadoc/pki-java-tools-${APPLICATION_VERSION}
+    DESTINATION
+        ${CMAKE_INSTALL_PREFIX}/share/javadoc
 )
-add_dependencies(pki-java-tools-${APPLICATION_VERSION}_javadoc pki-tools)
diff -rupN pki-core-9.0.3.orig/base/native-tools/src/tkstool/secutil.c pki-core-9.0.3/base/native-tools/src/tkstool/secutil.c
--- pki-core-9.0.3.orig/base/native-tools/src/tkstool/secutil.c	2015-02-04 15:42:25.000000000 -0800
+++ pki-core-9.0.3/base/native-tools/src/tkstool/secutil.c	2015-02-04 15:53:28.000000000 -0800
@@ -1003,7 +1003,7 @@ secu_PrintTime(FILE *out, int64 time, ch
     }
 
     PR_FormatTime(timeString, 100, "%a %b %d %H:%M:%S %Y", &printableTime);
-    fprintf(out, timeString);
+    fprintf(out, "%s", timeString);
 
     if (m != NULL)
 	fprintf(out, "\n");
@@ -2584,7 +2584,7 @@ SECU_PrintCRLInfo(FILE *out, CERTCrl *cr
 	iv = 0;
 	while ((entry = crl->entries[iv++]) != NULL) {
 	    sprintf(om, "Entry (%x):\n", iv); 
-	    SECU_Indent(out, level + 1); fprintf(out, om);
+	    SECU_Indent(out, level + 1); fprintf(out, "%s", om);
 	    SECU_PrintInteger(out, &(entry->serialNumber), "Serial Number",
 			      level + 2);
 	    SECU_PrintTimeChoice(out, &(entry->revocationDate), 
diff -rupN pki-core-9.0.3.orig/base/silent/CMakeLists.txt pki-core-9.0.3/base/silent/CMakeLists.txt
--- pki-core-9.0.3.orig/base/silent/CMakeLists.txt	2011-02-04 08:57:25.000000000 -0800
+++ pki-core-9.0.3/base/silent/CMakeLists.txt	2015-02-04 15:53:28.000000000 -0800
@@ -1,4 +1,4 @@
-project(silent Java)
+project(silent NONE)
 
 add_subdirectory(src)
 add_subdirectory(scripts)
diff -rupN pki-core-9.0.3.orig/base/silent/src/CMakeLists.txt pki-core-9.0.3/base/silent/src/CMakeLists.txt
--- pki-core-9.0.3.orig/base/silent/src/CMakeLists.txt	2015-02-04 15:42:28.000000000 -0800
+++ pki-core-9.0.3/base/silent/src/CMakeLists.txt	2015-02-04 21:16:00.000000000 -0800
@@ -1,4 +1,4 @@
-project(pki-silent_java Java)
+project(pki-silent_java NONE)
 
 find_file(JAKARTA_COMMONS_IO_JAR
     NAMES
@@ -32,64 +32,48 @@ find_file(XERCES_JAR
         /usr/share/java
 )
 
-set(pki-silent_java_SRCS
-    common/AutoInstaller.java
-    common/CMSConfig.java
-    common/ParseXML.java
-    common/ServerInfo.java
-    common/CMSTask.java
-    common/TestClient.java
-    common/Certificate_Record.java
-    common/ComCrypto.java
-    common/CMSLDAP.java
-    common/createinstance.java
-    common/Utilities.java
-    common/BaseState.java
-    common/PostQuery.java
-    common/Con2Agent.java
-    common/CMSProperties.java
-    common/CMSInstance.java
-    argparser/IntHolder.java
-    argparser/StringScanException.java
-    argparser/StringHolder.java
-    argparser/CharHolder.java
-    argparser/ArgParser.java
-    argparser/FloatHolder.java
-    argparser/BooleanHolder.java
-    argparser/StringScanner.java
-    argparser/ObjectHolder.java
-    argparser/SimpleExample.java
-    argparser/ArgParserTest.java
-    argparser/DoubleHolder.java
-    argparser/ArgParseException.java
-    argparser/LongHolder.java
-    tps/ConfigureTPS.java
-    ra/ConfigureRA.java
-    subca/ConfigureSubCA.java
-    http/HTTPResponse.java
-    http/HTTPClient.java
-    http/HTMLDocument.java
-    http/CertSelection.java
-    tks/ConfigureTKS.java
-    ca/DirEnroll.java
-    ca/UserEnroll.java
-    ca/Request.java
-    ca/checkRequest.java
-    ca/ConfigureCA.java
-    drm/ConfigureDRM.java
-    ocsp/ConfigureOCSP.java
-)
-
-set(CMAKE_JAVA_INCLUDE_PATH
-    ${PKI_CERTSRV_JAR} ${PKI_CMS_JAR}
-    ${PKI_CMSUTIL_JAR} ${PKI_NSUTIL_JAR}
-    ${JAKARTA_COMMONS_IO_JAR}
-    ${LDAPJDK_JAR} ${XERCES_JAR}
-    ${JSS_JAR} ${OSUTIL_JAR} ${SYMKEY_JAR})
-
-set(CMAKE_JAVA_TARGET_VERSION ${APPLICATION_VERSION})
-
-add_jar(pki-silent ${pki-silent_java_SRCS})
-add_dependencies(pki-silent osutil symkey pki-cmsutil pki-nsutil pki-certsrv pki-cms)
-install_jar(pki-silent ${JAVA_JAR_INSTALL_DIR}/pki)
-set(PKI_SILENT_JAR ${pki-silent_JAR_FILE} CACHE INTERNAL "pki-silent jar file")
+
+# build pki-silent
+javac(pki-silent-classes
+    SOURCES
+        common/*.java
+        argparser/*.java
+        tps/*.java
+        ra/*.java
+        subca/*.java
+        http/*.java
+        tks/*.java
+        ca/*.java
+        drm/*.java
+        ocsp/*.java
+    CLASSPATH
+        ${PKI_CERTSRV_JAR} ${PKI_CMS_JAR}
+        ${PKI_CMSUTIL_JAR} ${PKI_NSUTIL_JAR}
+        ${JAKARTA_COMMONS_IO_JAR}
+        ${LDAPJDK_JAR} ${XERCES_JAR}
+        ${JSS_JAR} ${OSUTIL_JAR} ${SYMKEY_JAR}
+    OUTPUT_DIR
+        ${CMAKE_BINARY_DIR}/classes
+    DEPENDS
+        symkey-jar pki-cmsutil-jar pki-nsutil-jar pki-certsrv-jar pki-cms-jar
+)
+
+jar(pki-silent-jar
+    CREATE
+        ${CMAKE_BINARY_DIR}/dist/pki-silent.jar
+    INPUT_DIR
+        ${CMAKE_BINARY_DIR}/classes
+    FILES
+        *.class
+    DEPENDS
+        pki-silent-classes
+)
+
+install(
+    FILES
+        ${CMAKE_BINARY_DIR}/dist/pki-silent.jar
+    DESTINATION
+        ${JAVA_JAR_INSTALL_DIR}/pki
+)
+
+set(PKI_SILENT_JAR ${CMAKE_BINARY_DIR}/dist/pki-silent.jar CACHE INTERNAL "pki-silent jar file")
diff -rupN pki-core-9.0.3.orig/base/symkey/src/CMakeLists.txt pki-core-9.0.3/base/symkey/src/CMakeLists.txt
--- pki-core-9.0.3.orig/base/symkey/src/CMakeLists.txt	2011-02-04 08:56:22.000000000 -0800
+++ pki-core-9.0.3/base/symkey/src/CMakeLists.txt	2015-02-04 22:28:07.000000000 -0800
@@ -1,24 +1,39 @@
-project(symkey Java)
+project(symkey NONE)
 
 find_file(JSS_JAR
     NAMES
         jss4.jar
     PATHS
-    /usr/lib/java
+    ${JAVA_LIB_INSTALL_DIR}
     /usr/share/java
 )
 
-set(symkey_java_SRCS
-    com/netscape/symkey/SessionKey.java
+# build symkey
+javac(symkey-classes
+    SOURCES
+        com/netscape/symkey/*.java
+    CLASSPATH
+        ${JSS_JAR}
+    OUTPUT_DIR
+        ${CMAKE_BINARY_DIR}/classes
 )
 
-set(CMAKE_JNI_TARGET TRUE)
-set(CMAKE_JAVA_INCLUDE_PATH ${JSS_JAR})
-set(CMAKE_JAVA_TARGET_VERSION ${APPLICATION_VERSION})
+jar(symkey-jar
+    CREATE
+        ${CMAKE_BINARY_DIR}/dist/symkey.jar
+    INPUT_DIR
+        ${CMAKE_BINARY_DIR}/classes
+    FILES
+        com/netscape/symkey/*.class
+    DEPENDS
+        symkey-classes
+)
 
-add_jar(symkey ${symkey_java_SRCS})
-install_jar(symkey ${LIB_INSTALL_DIR}/symkey)
-install_jni_symlink(symkey ${JAVA_LIB_INSTALL_DIR})
+install(
+    FILES
+        ${CMAKE_BINARY_DIR}/dist/symkey.jar
+    DESTINATION
+        ${JAVA_LIB_INSTALL_DIR}
+)
 
-set(SYMKEY_JAVA_OBJECT_DIR ${symkey_CLASS_DIR} PARENT_SCOPE)
-set(SYMKEY_JAR ${symkey_JAR_FILE} CACHE INTERNAL "symkey jar file")
+set(SYMKEY_JAR ${CMAKE_BINARY_DIR}/dist/symkey.jar CACHE INTERNAL "symkey jar file")
diff -rupN pki-core-9.0.3.orig/base/symkey/src/com/netscape/symkey/CMakeLists.txt pki-core-9.0.3/base/symkey/src/com/netscape/symkey/CMakeLists.txt
--- pki-core-9.0.3.orig/base/symkey/src/com/netscape/symkey/CMakeLists.txt	2011-02-04 08:56:22.000000000 -0800
+++ pki-core-9.0.3/base/symkey/src/com/netscape/symkey/CMakeLists.txt	2015-02-04 15:53:28.000000000 -0800
@@ -40,15 +40,15 @@ add_custom_command(
     OUTPUT
         ${symkey_library_HDRS}
     COMMAND
-        ${JAVA_HEADER}
-            -classpath ${SYMKEY_JAVA_OBJECT_DIR}:/usr/lib/java/jss4.jar
+        ${Java_JAVAH_EXECUTABLE}
+            -classpath ${CMAKE_BINARY_DIR}/classes:${JAVA_LIB_INSTALL_DIR}/jss4.jar
             -jni -d ${CMAKE_CURRENT_BINARY_DIR}
             com.netscape.symkey.SessionKey
 )
 
 add_library(${SYMKEY_SHARED_LIBRARY} SHARED ${symkey_library_HDRS} ${symkey_library_SRCS})
 target_link_libraries(${SYMKEY_SHARED_LIBRARY} ${SYMKEY_LINK_LIBRARIES})
-add_dependencies(${SYMKEY_SHARED_LIBRARY} symkey)
+add_dependencies(${SYMKEY_SHARED_LIBRARY} symkey-jar)
 
 set_target_properties(${SYMKEY_SHARED_LIBRARY}
     PROPERTIES
diff -rupN pki-core-9.0.3.orig/base/util/CMakeLists.txt pki-core-9.0.3/base/util/CMakeLists.txt
--- pki-core-9.0.3.orig/base/util/CMakeLists.txt	2011-02-04 08:58:35.000000000 -0800
+++ pki-core-9.0.3/base/util/CMakeLists.txt	2015-02-04 15:53:28.000000000 -0800
@@ -1,3 +1,3 @@
-project(util Java)
+project(util NONE)
 
 add_subdirectory(src)
diff -rupN pki-core-9.0.3.orig/base/util/src/CMakeLists.txt pki-core-9.0.3/base/util/src/CMakeLists.txt
--- pki-core-9.0.3.orig/base/util/src/CMakeLists.txt	2011-02-04 08:58:34.000000000 -0800
+++ pki-core-9.0.3/base/util/src/CMakeLists.txt	2015-02-04 15:53:28.000000000 -0800
@@ -1,4 +1,4 @@
-project(pki-cmsutil_java Java)
+project(pki-cmsutil_java NONE)
 
 find_file(JSS_JAR
     NAMES
@@ -40,333 +40,105 @@ find_file(XERCES_JAR
         /usr/share/java
 )
 
-set(pki-nsutil_java_SRCS
-    netscape/net/TransferProtocolClient.java
-    netscape/net/smtp/SmtpProtocolException.java
-    netscape/net/smtp/SmtpClient.java
-    netscape/net/NetworkClient.java
-    netscape/security/pkcs/ParsingException.java
-    netscape/security/pkcs/PKCS9Attribute.java
-    netscape/security/pkcs/EncodingException.java
-    netscape/security/pkcs/SignerInfo.java
-    netscape/security/pkcs/PKCS10Attribute.java
-    netscape/security/pkcs/PKCS9Attributes.java
-    netscape/security/pkcs/ContentInfo.java
-    netscape/security/pkcs/PKCS10.java
-    netscape/security/pkcs/PKCS10Attributes.java
-    netscape/security/pkcs/PKCS7.java
-    netscape/security/pkcs/PKCS8Key.java
-    netscape/security/x509/OIDName.java
-    netscape/security/x509/CertificateChain.java
-    netscape/security/x509/CertificateVersion.java
-    netscape/security/x509/LdapV3DNStrConverter.java
-    netscape/security/x509/IssuerAlternativeNameExtension.java
-    netscape/security/x509/PolicyMappingsExtension.java
-    netscape/security/x509/CRLExtensions.java
-    netscape/security/x509/X500NameAttrMap.java
-    netscape/security/x509/CertificatePolicySet.java
-    netscape/security/x509/X509Cert.java
-    netscape/security/x509/NSCCommentExtension.java
-    netscape/security/x509/Attribute.java
-    netscape/security/x509/PrivateKeyUsageExtension.java
-    netscape/security/x509/X509CRLImpl.java
-    netscape/security/x509/X500Signer.java
-    netscape/security/x509/CPSuri.java
-    netscape/security/x509/AlgorithmId.java
-    netscape/security/x509/SerialNumber.java
-    netscape/security/x509/X509CertImpl.java
-    netscape/security/x509/CertificatePolicyInfo.java
-    netscape/security/x509/CertException.java
-    netscape/security/x509/CRLNumberExtension.java
-    netscape/security/x509/GeneralNameInterface.java
-    netscape/security/x509/PolicyQualifiers.java
-    netscape/security/x509/AVA.java
-    netscape/security/x509/CertificateX509Key.java
-    netscape/security/x509/RFC822Name.java
-    netscape/security/x509/Extensions.java
-    netscape/security/x509/FreshestCRLExtension.java
-    netscape/security/x509/UserNotice.java
-    netscape/security/x509/ReasonFlags.java
-    netscape/security/x509/InvalidIPAddressException.java
-    netscape/security/x509/IPAddressName.java
-    netscape/security/x509/SubjectKeyIdentifierExtension.java
-    netscape/security/x509/GenericValueConverter.java
-    netscape/security/x509/CRLReasonExtension.java
-    netscape/security/x509/CertificateAlgorithmId.java
-    netscape/security/x509/DisplayText.java
-    netscape/security/x509/CertificateValidity.java
-    netscape/security/x509/PKIXExtensions.java
-    netscape/security/x509/PrintableConverter.java
-    netscape/security/x509/AttributeNameEnumeration.java
-    netscape/security/x509/SubjectDirAttributesExtension.java
-    netscape/security/x509/CRLDistributionPoint.java
-    netscape/security/x509/NameConstraintsExtension.java
-    netscape/security/x509/X509AttributeName.java
-    netscape/security/x509/RFC1779StrConverter.java
-    netscape/security/x509/X500Name.java
-    netscape/security/x509/DNSName.java
-    netscape/security/x509/URIName.java
-    netscape/security/x509/CertAndKeyGen.java
-    netscape/security/x509/RevocationReason.java
-    netscape/security/x509/AVAValueConverter.java
-    netscape/security/x509/CRLDistributionPointsExtension.java
-    netscape/security/x509/GeneralSubtree.java
-    netscape/security/x509/X509Key.java
-    netscape/security/x509/PolicyConstraintsExtension.java
-    netscape/security/x509/X509CertInfo.java
-    netscape/security/x509/LdapDNStrConverter.java
-    netscape/security/x509/X509ExtensionException.java
-    netscape/security/x509/AuthorityKeyIdentifierExtension.java
-    netscape/security/x509/NoticeReference.java
-    netscape/security/x509/IA5StringConverter.java
-    netscape/security/x509/UniqueIdentity.java
-    netscape/security/x509/RevokedCertificate.java
-    netscape/security/x509/CertificateExtensions.java
-    netscape/security/x509/HoldInstructionExtension.java
-    netscape/security/x509/IssuingDistributionPoint.java
-    netscape/security/x509/GeneralName.java
-    netscape/security/x509/CertificateIssuerName.java
-    netscape/security/x509/IssuingDistributionPointExtension.java
-    netscape/security/x509/AlgIdDSA.java
-    netscape/security/x509/DeltaCRLIndicatorExtension.java
-    netscape/security/x509/GeneralSubtrees.java
-    netscape/security/x509/BasicConstraintsExtension.java
-    netscape/security/x509/CertAttrSet.java
-    netscape/security/x509/GeneralNamesException.java
-    netscape/security/x509/ACertAttrSet.java
-    netscape/security/x509/Qualifier.java
-    netscape/security/x509/KeyIdentifier.java
-    netscape/security/x509/CertificateSerialNumber.java
-    netscape/security/x509/KeyUsageExtension.java
-    netscape/security/x509/SubjectAlternativeNameExtension.java
-    netscape/security/x509/CertificateSubjectUniqueIdentity.java
-    netscape/security/x509/CertificateSubjectName.java
-    netscape/security/x509/GeneralNames.java
-    netscape/security/x509/Extension.java
-    netscape/security/x509/CertificatePoliciesExtension.java
-    netscape/security/x509/CertificateIssuerExtension.java
-    netscape/security/x509/RDN.java
-    netscape/security/x509/CertificatePolicyMap.java
-    netscape/security/x509/DirStrConverter.java
-    netscape/security/x509/CertificateIssuerUniqueIdentity.java
-    netscape/security/x509/PolicyQualifierInfo.java
-    netscape/security/x509/EDIPartyName.java
-    netscape/security/x509/InvalidityDateExtension.java
-    netscape/security/x509/CertificatePolicyId.java
-    netscape/security/x509/CertParseError.java
-    netscape/security/x509/OIDMap.java
-    netscape/security/x509/PolicyConstraint.java
-    netscape/security/x509/RevokedCertImpl.java
-    netscape/security/x509/OtherName.java
-    netscape/security/util/BigInt.java
-    netscape/security/util/DerOutputStream.java
-    netscape/security/util/ASN1CharStrConvMap.java
-    netscape/security/util/ByteToCharUnicode.java
-    netscape/security/util/DerValue.java
-    netscape/security/util/CharToByteIA5String.java
-    netscape/security/util/DerInputBuffer.java
-    netscape/security/util/CharToBytePrintable.java
-    netscape/security/util/ObjectIdentifier.java
-    netscape/security/util/DerEncoder.java
-    netscape/security/util/ExtPrettyPrint.java
-    netscape/security/util/ByteArrayLexOrder.java
-    netscape/security/util/BitArray.java
-    netscape/security/util/CrlPrettyPrint.java
-    netscape/security/util/CertPrettyPrint.java
-    netscape/security/util/ByteArrayTagOrder.java
-    netscape/security/util/PrettyPrintResources.java
-    netscape/security/util/PrettyPrintFormat.java
-    netscape/security/util/ArraySet.java
-    netscape/security/util/CharToByteUniversalString.java
-    netscape/security/util/ByteToCharIA5String.java
-    netscape/security/util/PubKeyPrettyPrint.java
-    netscape/security/util/ByteToCharPrintable.java
-    netscape/security/util/DerInputStream.java
-    netscape/security/util/ByteToCharUniversalString.java
-    netscape/security/provider/DSA.java
-    netscape/security/provider/DSAPrivateKey.java
-    netscape/security/provider/DSAParameters.java
-    netscape/security/provider/DSAPublicKey.java
-    netscape/security/provider/SystemIdentity.java
-    netscape/security/provider/RSAPublicKey.java
-    netscape/security/provider/SHA.java
-    netscape/security/provider/SystemSigner.java
-    netscape/security/provider/MD5.java
-    netscape/security/provider/DSAParameterGenerator.java
-    netscape/security/provider/CMS.java
-    netscape/security/provider/DSAKeyPairGenerator.java
-    netscape/security/provider/DSAKeyFactory.java
-    netscape/security/provider/Sun.java
-    netscape/security/provider/X509CertificateFactory.java
-    netscape/security/extensions/SubjectInfoAccessExtension.java
-    netscape/security/extensions/GenericASN1Extension.java
-    netscape/security/extensions/NSCertTypeExtension.java
-    netscape/security/extensions/CertificateScopeEntry.java
-    netscape/security/extensions/KerberosName.java
-    netscape/security/extensions/CertificateRenewalWindowExtension.java
-    netscape/security/extensions/PresenceServerExtension.java
-    netscape/security/extensions/OCSPNoCheckExtension.java
-    netscape/security/extensions/CertInfo.java
-    netscape/security/extensions/AccessDescription.java
-    netscape/security/extensions/InhibitAnyPolicyExtension.java
-    netscape/security/extensions/CertificateScopeOfUseExtension.java
-    netscape/security/extensions/AuthInfoAccessExtension.java
-    netscape/security/extensions/ExtendedKeyUsageExtension.java
-    netscape/security/acl/AclImpl.java
-    netscape/security/acl/AllPermissionsImpl.java
-    netscape/security/acl/PrincipalImpl.java
-    netscape/security/acl/AclEntryImpl.java
-    netscape/security/acl/OwnerImpl.java
-    netscape/security/acl/WorldGroupImpl.java
-    netscape/security/acl/GroupImpl.java
-    netscape/security/acl/PermissionImpl.java
-)
-
-set(pki-cmsutil_java_SRCS
-    com/netscape/cmsutil/ldap/LDAPUtil.java
-    com/netscape/cmsutil/xml/XMLObject.java
-    com/netscape/cmsutil/scep/CRSPKIMessage.java
-    com/netscape/cmsutil/util/Cert.java
-    com/netscape/cmsutil/util/Fmt.java
-    com/netscape/cmsutil/util/HMACDigest.java
-    com/netscape/cmsutil/util/Utils.java
-    com/netscape/cmsutil/net/ISocketFactory.java
-    com/netscape/cmsutil/crypto/Token.java
-    com/netscape/cmsutil/crypto/Module.java
-    com/netscape/cmsutil/crypto/CryptoUtil.java
-    com/netscape/cmsutil/password/PlainPasswordReader.java
-    com/netscape/cmsutil/password/IPasswordWriter.java
-    com/netscape/cmsutil/password/IPasswordStore.java
-    com/netscape/cmsutil/password/IPasswordReader.java
-    com/netscape/cmsutil/password/PlainPasswordWriter.java
-    com/netscape/cmsutil/password/PlainPasswordFile.java
-    com/netscape/cmsutil/radius/FramedProtocolAttribute.java
-    com/netscape/cmsutil/radius/TerminationActionAttribute.java
-    com/netscape/cmsutil/radius/NASPortTypeAttribute.java
-    com/netscape/cmsutil/radius/LoginLATServiceAttribute.java
-    com/netscape/cmsutil/radius/VendorSpecificAttribute.java
-    com/netscape/cmsutil/radius/ServiceTypeAttribute.java
-    com/netscape/cmsutil/radius/FramedAppleTalkLinkAttribute.java
-    com/netscape/cmsutil/radius/RadiusConn.java
-    com/netscape/cmsutil/radius/StateAttribute.java
-    com/netscape/cmsutil/radius/Attribute.java
-    com/netscape/cmsutil/radius/ReplyMessageAttribute.java
-    com/netscape/cmsutil/radius/ResponseAuthenticator.java
-    com/netscape/cmsutil/radius/GenericAttribute.java
-    com/netscape/cmsutil/radius/AccessChallenge.java
-    com/netscape/cmsutil/radius/FramedMTUAttribute.java
-    com/netscape/cmsutil/radius/NASPortAttribute.java
-    com/netscape/cmsutil/radius/CallingStationIdAttribute.java
-    com/netscape/cmsutil/radius/UserNameAttribute.java
-    com/netscape/cmsutil/radius/PacketFactory.java
-    com/netscape/cmsutil/radius/UserPasswordAttribute.java
-    com/netscape/cmsutil/radius/NASPacket.java
-    com/netscape/cmsutil/radius/FramedRoutingAttribute.java
-    com/netscape/cmsutil/radius/LoginLATNodeAttribute.java
-    com/netscape/cmsutil/radius/AttributeSet.java
-    com/netscape/cmsutil/radius/RequestAuthenticator.java
-    com/netscape/cmsutil/radius/CHAPPasswordAttribute.java
-    com/netscape/cmsutil/radius/FramedIPNetmaskAttribute.java
-    com/netscape/cmsutil/radius/LoginLATPortAttribute.java
-    com/netscape/cmsutil/radius/CallbackNumberAttribute.java
-    com/netscape/cmsutil/radius/RejectException.java
-    com/netscape/cmsutil/radius/ChallengeException.java
-    com/netscape/cmsutil/radius/NASClassAttribute.java
-    com/netscape/cmsutil/radius/LoginTCPPortAttribute.java
-    com/netscape/cmsutil/radius/IdleTimeoutAttribute.java
-    com/netscape/cmsutil/radius/AccessReject.java
-    com/netscape/cmsutil/radius/SessionTimeoutAttribute.java
-    com/netscape/cmsutil/radius/FramedIPAddressAttribute.java
-    com/netscape/cmsutil/radius/FramedRouteAttribute.java
-    com/netscape/cmsutil/radius/AccessAccept.java
-    com/netscape/cmsutil/radius/FramedAppleTalkNetworkAttribute.java
-    com/netscape/cmsutil/radius/ProxyStateAttribute.java
-    com/netscape/cmsutil/radius/FilterIdAttribute.java
-    com/netscape/cmsutil/radius/NASIdentifierAttribute.java
-    com/netscape/cmsutil/radius/LoginIPHostAttribute.java
-    com/netscape/cmsutil/radius/LoginServiceAttribute.java
-    com/netscape/cmsutil/radius/PortLimitAttribute.java
-    com/netscape/cmsutil/radius/AttributeFactory.java
-    com/netscape/cmsutil/radius/ServerPacket.java
-    com/netscape/cmsutil/radius/FramedAppleTalkZoneAttribute.java
-    com/netscape/cmsutil/radius/CHAPChallengeAttribute.java
-    com/netscape/cmsutil/radius/AccessRequest.java
-    com/netscape/cmsutil/radius/CallerStationIdAttribute.java
-    com/netscape/cmsutil/radius/Packet.java
-    com/netscape/cmsutil/radius/CallbackIdAttribute.java
-    com/netscape/cmsutil/radius/FramedIPXNetworkAttribute.java
-    com/netscape/cmsutil/radius/LoginLATGroupAttribute.java
-    com/netscape/cmsutil/radius/Authenticator.java
-    com/netscape/cmsutil/radius/NASIPAddressAttribute.java
-    com/netscape/cmsutil/radius/FramedCompressionAttribute.java
-    com/netscape/cmsutil/http/ConnectAsync.java
-    com/netscape/cmsutil/http/JssSSLSocketFactory.java
-    com/netscape/cmsutil/http/HttpClient.java
-    com/netscape/cmsutil/http/HttpMessage.java
-    com/netscape/cmsutil/http/HttpRequest.java
-    com/netscape/cmsutil/http/HttpResponse.java
-    com/netscape/cmsutil/http/Http.java
-    com/netscape/cmsutil/http/HttpEofException.java
-    com/netscape/cmsutil/http/HttpProtocolException.java
-    com/netscape/cmsutil/ocsp/Signature.java
-    com/netscape/cmsutil/ocsp/RevokedInfo.java
-    com/netscape/cmsutil/ocsp/TBSRequest.java
-    com/netscape/cmsutil/ocsp/CertID.java
-    com/netscape/cmsutil/ocsp/NameID.java
-    com/netscape/cmsutil/ocsp/KeyHashID.java
-    com/netscape/cmsutil/ocsp/OCSPRequest.java
-    com/netscape/cmsutil/ocsp/Response.java
-    com/netscape/cmsutil/ocsp/GoodInfo.java
-    com/netscape/cmsutil/ocsp/SingleResponse.java
-    com/netscape/cmsutil/ocsp/BasicOCSPResponse.java
-    com/netscape/cmsutil/ocsp/ResponseBytes.java
-    com/netscape/cmsutil/ocsp/OCSPResponse.java
-    com/netscape/cmsutil/ocsp/UnknownInfo.java
-    com/netscape/cmsutil/ocsp/OCSPResponseStatus.java
-    com/netscape/cmsutil/ocsp/CertStatus.java
-    com/netscape/cmsutil/ocsp/ResponseData.java
-    com/netscape/cmsutil/ocsp/Request.java
-    com/netscape/cmsutil/ocsp/ResponderID.java
-)
-
-set(CMAKE_JAVA_INCLUDE_PATH
-    ${LDAPJDK_JAR} ${XALAN_JAR} ${XERCES_JAR}
-    ${JSS_JAR} ${OSUTIL_JAR})
-
-set(CMAKE_JAVA_TARGET_VERSION ${APPLICATION_VERSION})
 
 # build pki-nsutil
-set(CMAKE_JAR_CLASSES_PREFIX netscape)
-add_jar(pki-nsutil ${pki-nsutil_java_SRCS})
-add_dependencies(pki-nsutil osutil)
-install_jar(pki-nsutil ${JAVA_JAR_INSTALL_DIR}/pki)
-set(PKI_NSUTIL_JAR ${pki-nsutil_JAR_FILE} CACHE INTERNAL "pki-nsutil jar file")
+javac(pki-nsutil-classes
+    SOURCES
+        netscape/*.java
+    CLASSPATH
+        ${LDAPJDK_JAR} ${XALAN_JAR} ${XERCES_JAR}
+        ${JSS_JAR} ${OSUTIL_JAR}
+    OUTPUT_DIR
+        ${CMAKE_BINARY_DIR}/classes
+)
+
+jar(pki-nsutil-jar
+    CREATE
+        ${CMAKE_BINARY_DIR}/dist/pki-nsutil.jar
+    INPUT_DIR
+        ${CMAKE_BINARY_DIR}/classes
+    FILES
+        netscape/*.class
+    DEPENDS
+        pki-nsutil-classes
+)
+
+install(
+    FILES
+        ${CMAKE_BINARY_DIR}/dist/pki-nsutil.jar
+    DESTINATION
+        ${JAVA_JAR_INSTALL_DIR}/pki
+)
+
+set(PKI_NSUTIL_JAR ${CMAKE_BINARY_DIR}/dist/pki-nsutil.jar CACHE INTERNAL "pki-nsutil jar file")
+
 
 # build pki-cmsutil
-set(CMAKE_JAR_CLASSES_PREFIX com/netscape/cmsutil)
-add_jar(pki-cmsutil ${pki-cmsutil_java_SRCS})
-add_dependencies(pki-cmsutil osutil pki-nsutil)
-install_jar(pki-cmsutil ${JAVA_JAR_INSTALL_DIR}/pki)
-set(PKI_CMSUTIL_JAR ${pki-cmsutil_JAR_FILE} CACHE INTERNAL "pki-cmsutil jar file")
-
-create_javadoc(pki-util-${APPLICATION_VERSION}
-    PACKAGES com.netscape.cmsutil.crypto
-             com.netscape.cmsutil.http
-             com.netscape.cmsutil.ldap
-             com.netscape.cmsutil.net
-             com.netscape.cmsutil.ocsp
-             com.netscape.cmsutil.password
-             com.netscape.cmsutil.radius
-             com.netscape.cmsutil.scep
-             com.netscape.cmsutil.util
-             com.netscape.cmsutil.xml
-    SOURCEPATH ${CMAKE_CURRENT_SOURCE_DIR}
-    CLASSPATH ${CMAKE_JAVA_INCLUDE_PATH}
-    WINDOWTITLE "pki-util"
-    WINDOWTITLE "pki-util"
-    DOCTITLE "<h1>dogtag</h1>"
-    AUTHOR TRUE
-    USE TRUE
-    VERSION TRUE
+javac(pki-cmsutil-classes
+    SOURCES
+        com/netscape/cmsutil/*.java
+    CLASSPATH
+        ${LDAPJDK_JAR} ${XALAN_JAR} ${XERCES_JAR}
+        ${JSS_JAR} ${OSUTIL_JAR}
+    OUTPUT_DIR
+        ${CMAKE_BINARY_DIR}/classes
+    DEPENDS
+        pki-nsutil-jar
+)
+
+jar(pki-cmsutil-jar
+    CREATE
+        ${CMAKE_BINARY_DIR}/dist/pki-cmsutil.jar
+    INPUT_DIR
+        ${CMAKE_BINARY_DIR}/classes
+    FILES
+        com/netscape/cmsutil/*.class
+    DEPENDS
+        pki-cmsutil-classes
+)
+
+install(
+    FILES
+        ${CMAKE_BINARY_DIR}/dist/pki-cmsutil.jar
+    DESTINATION
+        ${JAVA_JAR_INSTALL_DIR}/pki
+)
+
+set(PKI_CMSUTIL_JAR ${CMAKE_BINARY_DIR}/dist/pki-cmsutil.jar CACHE INTERNAL "pki-cmsutil jar file")
+
+
+javadoc(pki-util
+    SOURCEPATH
+        ${CMAKE_SOURCE_DIR}/base/util/src
+    DEST
+        ${CMAKE_CURRENT_BINARY_DIR}/javadoc/pki-util-${APPLICATION_VERSION}
+    SUBPACKAGES
+        com.netscape.cmsutil.crypto
+        com.netscape.cmsutil.http
+        com.netscape.cmsutil.ldap
+        com.netscape.cmsutil.net
+        com.netscape.cmsutil.ocsp
+        com.netscape.cmsutil.password
+        com.netscape.cmsutil.radius
+        com.netscape.cmsutil.scep
+        com.netscape.cmsutil.util
+        com.netscape.cmsutil.xml
+    CLASSPATH
+        ${LDAPJDK_JAR} ${XALAN_JAR} ${XERCES_JAR}
+        ${JSS_JAR} ${OSUTIL_JAR}
+    OPTIONS
+        -windowtitle 'pki-util'
+        -doctitle '<h1>dogtag</h1>'
+        -author
+        -use
+        -version
+    DEPENDS
+        pki-cmsutil-jar
+)
+
+install(
+    FILES
+        ${CMAKE_CURRENT_BINARY_DIR}/javadoc/pki-util-${APPLICATION_VERSION}
+    DESTINATION
+        ${CMAKE_INSTALL_PREFIX}/share/javadoc
 )
-add_dependencies(pki-util-${APPLICATION_VERSION}_javadoc pki-cmsutil)
diff -rupN pki-core-9.0.3.orig/cmake/Modules/CMakeDetermineJavaCompiler.cmake pki-core-9.0.3/cmake/Modules/CMakeDetermineJavaCompiler.cmake
--- pki-core-9.0.3.orig/cmake/Modules/CMakeDetermineJavaCompiler.cmake	2011-02-04 08:55:45.000000000 -0800
+++ pki-core-9.0.3/cmake/Modules/CMakeDetermineJavaCompiler.cmake	1969-12-31 16:00:00.000000000 -0800
@@ -1,103 +0,0 @@
-
-#=============================================================================
-# Copyright 2002-2009 Kitware, Inc.
-#
-# Distributed under the OSI-approved BSD License (the "License");
-# see accompanying file Copyright.txt for details.
-#
-# This software is distributed WITHOUT ANY WARRANTY; without even the
-# implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
-# See the License for more information.
-#=============================================================================
-# (To distributed this file outside of CMake, substitute the full
-#  License text for the above reference.)
-
-# determine the compiler to use for Java programs
-# NOTE, a generator may set CMAKE_Java_COMPILER before
-# loading this file to force a compiler.
-
-IF(NOT CMAKE_Java_COMPILER)
-
-  # prefer the environment variable JAVA_COMPILER
-  IF($ENV{JAVA_COMPILER} MATCHES ".+")
-    GET_FILENAME_COMPONENT(CMAKE_Java_COMPILER_INIT $ENV{JAVA_COMPILER} PROGRAM PROGRAM_ARGS CMAKE_Java_FLAGS_ENV_INIT)
-    IF(CMAKE_Java_FLAGS_ENV_INIT)
-      SET(CMAKE_Java_COMPILER_ARG1 "${CMAKE_Java_FLAGS_ENV_INIT}" CACHE STRING "First argument to Java compiler")
-    ENDIF(CMAKE_Java_FLAGS_ENV_INIT)
-    IF(NOT EXISTS ${CMAKE_Java_COMPILER_INIT})
-      MESSAGE(SEND_ERROR "Could not find compiler set in environment variable JAVA_COMPILER:\n$ENV{JAVA_COMPILER}.")
-    ENDIF(NOT EXISTS ${CMAKE_Java_COMPILER_INIT})
-  ENDIF($ENV{JAVA_COMPILER} MATCHES ".+")
-
-  IF($ENV{JAVA_RUNTIME} MATCHES ".+")
-    GET_FILENAME_COMPONENT(CMAKE_Java_RUNTIME_INIT $ENV{JAVA_RUNTIME} PROGRAM PROGRAM_ARGS CMAKE_Java_FLAGS_ENV_INIT)
-    IF(NOT EXISTS ${CMAKE_Java_RUNTIME_INIT})
-      MESSAGE(SEND_ERROR "Could not find compiler set in environment variable JAVA_RUNTIME:\n$ENV{JAVA_RUNTIME}.")
-    ENDIF(NOT EXISTS ${CMAKE_Java_RUNTIME_INIT})
-  ENDIF($ENV{JAVA_RUNTIME} MATCHES ".+")
-
-  IF($ENV{JAVA_ARCHIVE} MATCHES ".+")
-    GET_FILENAME_COMPONENT(CMAKE_Java_ARCHIVE_INIT $ENV{JAVA_ARCHIVE} PROGRAM PROGRAM_ARGS CMAKE_Java_FLAGS_ENV_INIT)
-    IF(NOT EXISTS ${CMAKE_Java_ARCHIVE_INIT})
-      MESSAGE(SEND_ERROR "Could not find compiler set in environment variable JAVA_ARCHIVE:\n$ENV{JAVA_ARCHIVE}.")
-    ENDIF(NOT EXISTS ${CMAKE_Java_ARCHIVE_INIT})
-  ENDIF($ENV{JAVA_ARCHIVE} MATCHES ".+")
-
-  SET(Java_BIN_PATH
-    "[HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit\\2.0;JavaHome]/bin"
-    "[HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit\\1.9;JavaHome]/bin"
-    "[HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit\\1.8;JavaHome]/bin"
-    "[HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit\\1.7;JavaHome]/bin"
-    "[HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit\\1.6;JavaHome]/bin"
-    "[HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit\\1.5;JavaHome]/bin"
-    "[HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit\\1.4;JavaHome]/bin"
-    "[HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit\\1.3;JavaHome]/bin"
-    $ENV{JAVA_HOME}/bin
-    /usr/bin
-    /usr/lib/java/bin
-    /usr/share/java/bin
-    /usr/local/bin
-    /usr/local/java/bin
-    /usr/local/java/share/bin
-    /usr/java/j2sdk1.4.2_04
-    /usr/lib/j2sdk1.4-sun/bin
-    /usr/java/j2sdk1.4.2_09/bin
-    /usr/lib/j2sdk1.5-sun/bin
-    /opt/sun-jdk-1.5.0.04/bin
-    )
-  # if no compiler has been specified yet, then look for one
-  IF(CMAKE_Java_COMPILER_INIT)
-    SET(CMAKE_Java_COMPILER ${CMAKE_Java_COMPILER_INIT} CACHE PATH "Java Compiler")
-  ELSE(CMAKE_Java_COMPILER_INIT)
-    FIND_PROGRAM(CMAKE_Java_COMPILER
-      NAMES javac
-      PATHS ${Java_BIN_PATH}
-    )
-  ENDIF(CMAKE_Java_COMPILER_INIT)
-
-  # if no runtime has been specified yet, then look for one
-  IF(CMAKE_Java_RUNTIME_INIT)
-    SET(CMAKE_Java_RUNTIME ${CMAKE_Java_RUNTIME_INIT} CACHE PATH "Java Runtime")
-  ELSE(CMAKE_Java_RUNTIME_INIT)
-    FIND_PROGRAM(CMAKE_Java_RUNTIME
-      NAMES java
-      PATHS ${Java_BIN_PATH}
-    )
-  ENDIF(CMAKE_Java_RUNTIME_INIT)
-
-  # if no archive has been specified yet, then look for one
-  IF(CMAKE_Java_ARCHIVE_INIT)
-    SET(CMAKE_Java_ARCHIVE ${CMAKE_Java_ARCHIVE_INIT} CACHE PATH "Java Archive")
-  ELSE(CMAKE_Java_ARCHIVE_INIT)
-    FIND_PROGRAM(CMAKE_Java_ARCHIVE
-      NAMES jar
-      PATHS ${Java_BIN_PATH}
-    )
-  ENDIF(CMAKE_Java_ARCHIVE_INIT)
-ENDIF(NOT CMAKE_Java_COMPILER)
-MARK_AS_ADVANCED(CMAKE_Java_COMPILER)
-
-# configure variables set in this file for fast reload later on
-CONFIGURE_FILE(${CMAKE_ROOT}/Modules/CMakeJavaCompiler.cmake.in
-  ${CMAKE_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeJavaCompiler.cmake IMMEDIATE @ONLY)
-SET(CMAKE_Java_COMPILER_ENV_VAR "JAVA_COMPILER")
diff -rupN pki-core-9.0.3.orig/cmake/Modules/CMakeJavaCompiler.cmake.in pki-core-9.0.3/cmake/Modules/CMakeJavaCompiler.cmake.in
--- pki-core-9.0.3.orig/cmake/Modules/CMakeJavaCompiler.cmake.in	2011-02-04 08:55:45.000000000 -0800
+++ pki-core-9.0.3/cmake/Modules/CMakeJavaCompiler.cmake.in	1969-12-31 16:00:00.000000000 -0800
@@ -1,14 +0,0 @@
-SET(CMAKE_Java_COMPILER "@CMAKE_Java_COMPILER@")
-SET(CMAKE_Java_COMPILER_ARG1 "@CMAKE_Java_COMPILER_ARG1@")
-SET(CMAKE_Java_RUNTIME  "@CMAKE_Java_RUNTIME@")
-SET(CMAKE_Java_ARCHIVE  "@CMAKE_Java_ARCHIVE@")
-SET(CMAKE_Java_HEADER  "@CMAKE_Java_HEADER@")
-SET(CMAKE_Java_COMPILER_LOADED 1)
-
-SET(CMAKE_Java_SOURCE_FILE_EXTENSIONS java)
-SET(CMAKE_Java_LINKER_PREFERENCE 40)
-SET(CMAKE_Java_OUTPUT_EXTENSION_REPLACE 1)
-SET(CMAKE_Java_IGNORE_EXTENSIONS class;CLASS)
-SET(CMAKE_STATIC_LIBRARY_PREFIX_Java "")
-SET(CMAKE_STATIC_LIBRARY_SUFFIX_Java ".jar")
-SET(CMAKE_Java_COMPILER_ENV_VAR "JAVA_COMPILER")
diff -rupN pki-core-9.0.3.orig/cmake/Modules/CMakeJavaInformation.cmake pki-core-9.0.3/cmake/Modules/CMakeJavaInformation.cmake
--- pki-core-9.0.3.orig/cmake/Modules/CMakeJavaInformation.cmake	2011-02-04 08:55:45.000000000 -0800
+++ pki-core-9.0.3/cmake/Modules/CMakeJavaInformation.cmake	1969-12-31 16:00:00.000000000 -0800
@@ -1,73 +0,0 @@
-#=============================================================================
-# Copyright 2004-2009 Kitware, Inc.
-#
-# Distributed under the OSI-approved BSD License (the "License");
-# see accompanying file Copyright.txt for details.
-#
-# This software is distributed WITHOUT ANY WARRANTY; without even the
-# implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
-# See the License for more information.
-#=============================================================================
-# (To distributed this file outside of CMake, substitute the full
-#  License text for the above reference.)
-
-# This should be included before the _INIT variables are
-# used to initialize the cache.  Since the rule variables
-# have if blocks on them, users can still define them here.
-# But, it should still be after the platform file so changes can
-# be made to those values.
-
-set(CMAKE_Java_OUTPUT_EXTENSION .class)
-
-if (CMAKE_USER_MAKE_RULES_OVERRIDE)
-    include(${CMAKE_USER_MAKE_RULES_OVERRIDE})
-endif (CMAKE_USER_MAKE_RULES_OVERRIDE)
-
-if (CMAKE_USER_MAKE_RULES_OVERRIDE_Java)
-   include(${CMAKE_USER_MAKE_RULES_OVERRIDE_Java})
-endif (CMAKE_USER_MAKE_RULES_OVERRIDE_Java)
-
-# this is a place holder if java needed flags for javac they would go here.
-if (NOT CMAKE_Java_CREATE_STATIC_LIBRARY)
-#    if (WIN32)
-#        set(class_files_mask "*.class")
-#    else(WIN32)
-         set(class_files_mask ".")
-#    endif(WIN32)
-
-    set(CMAKE_Java_CREATE_STATIC_LIBRARY
-        "<CMAKE_Java_ARCHIVE> -cf <TARGET> -C <OBJECT_DIR> ${class_files_mask}")
-    # "${class_files_mask}" should really be "<OBJECTS>" but compling a *.java
-    # file can create more than one *.class file...
-endif (NOT CMAKE_Java_CREATE_STATIC_LIBRARY)
-
-if (NOT CMAKE_Java_CREATE_SHARED_LIBRARY)
-    set(CMAKE_Java_CREATE_SHARED_LIBRARY ${CMAKE_Java_CREATE_STATIC_LIBRARY})
-endif (NOT CMAKE_Java_CREATE_SHARED_LIBRARY)
-
-# compile a Java file into an object file
-if (NOT CMAKE_Java_COMPILE_OBJECT)
-    set(CMAKE_Java_COMPILE_OBJECT
-        "<CMAKE_Java_COMPILER> <FLAGS> <SOURCE> -d <OBJECT_DIR>")
-endif (NOT CMAKE_Java_COMPILE_OBJECT)
-
-if (NOT ${CMAKE_Java_LINK_EXECUTABLE})
-#    if (WIN32)
-#        set(class_files_mask "*.class")
-#    else(WIN32)
-         set(class_files_mask ".")
-#    endif(WIN32)
-
-    set(CMAKE_Java_LINK_EXECUTABLE
-        "<CMAKE_Java_ARCHIVE> -cf <TARGET> -C <OBJECT_DIR> ${class_files_mask}")
-    # "${class_files_mask}" should really be "<OBJECTS>" but compling a *.java
-    # file can create more than one *.class file...
-endif (NOT ${CMAKE_Java_LINK_EXECUTABLE})
-
-# set java include flag option and the separator for multiple include paths
-set(CMAKE_INCLUDE_FLAG_Java "-classpath ")
-if (WIN32 AND NOT CYGWIN)
-    set(CMAKE_INCLUDE_FLAG_SEP_Java ";")
-else (WIN32 AND NOT CYGWIN)
-    set(CMAKE_INCLUDE_FLAG_SEP_Java ":")
-endif(WIN32 AND NOT CYGWIN)
diff -rupN pki-core-9.0.3.orig/cmake/Modules/CMakeTestJavaCompiler.cmake pki-core-9.0.3/cmake/Modules/CMakeTestJavaCompiler.cmake
--- pki-core-9.0.3.orig/cmake/Modules/CMakeTestJavaCompiler.cmake	2011-02-04 08:55:45.000000000 -0800
+++ pki-core-9.0.3/cmake/Modules/CMakeTestJavaCompiler.cmake	1969-12-31 16:00:00.000000000 -0800
@@ -1,47 +0,0 @@
-#=============================================================================
-# Copyright 2004-2009 Kitware, Inc.
-#
-# Distributed under the OSI-approved BSD License (the "License");
-# see accompanying file Copyright.txt for details.
-#
-# This software is distributed WITHOUT ANY WARRANTY; without even the
-# implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
-# See the License for more information.
-#=============================================================================
-# (To distributed this file outside of CMake, substitute the full
-#  License text for the above reference.)
-
-# This file is used by EnableLanguage in cmGlobalGenerator to
-# determine that that selected Java compiler can actually compile
-# and link the most basic of programs.   If not, a fatal error
-# is set and cmake stops processing commands and will not generate
-# any makefiles or projects.
-
-set(CMAKE_Java_COMPILER_WORKS 1 CACHE INTERNAL "")
-
-if (NOT CMAKE_Java_COMPILER_WORKS)
-    message(STATUS "Check for working Java compiler: ${CMAKE_Java_COMPILER}")
-
-    file(WRITE ${CMAKE_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeTmp/testJavaCompiler.java
-        "class HelloWorldApp {\n"
-        "  public static void main(String[] args) {\n"
-        "    System.out.println("Hello World!");\n"
-        "  }\n"
-        "}\n"
-    )
-
-    try_compile(CMAKE_Java_COMPILER_WORKS
-        ${CMAKE_BINARY_DIR}
-        ${CMAKE_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeTmp/testJavaCompiler.java
-        OUTPUT_VARIABLE OUTPUT
-    )
-
-    if (CMAKE_Java_COMPILER_WORKS)
-        message(STATUS "Check for working Java compiler: ${CMAKE_C_COMPILER} -- works")
-        file(APPEND ${CMAKE_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/CMakeOutput.log
-            "Determining if the C compiler works passed with "
-            "the following output:\n${OUTPUT}\n\n"
-        )
-        set(CMAKE_Java_COMPILER_WORKS 1 CACHE INTERNAL "")
-    endif (CMAKE_Java_COMPILER_WORKS)
-endif (NOT CMAKE_Java_COMPILER_WORKS)
diff -rupN pki-core-9.0.3.orig/cmake/Modules/DefineCompilerFlags.cmake pki-core-9.0.3/cmake/Modules/DefineCompilerFlags.cmake
--- pki-core-9.0.3.orig/cmake/Modules/DefineCompilerFlags.cmake	2011-02-04 08:55:45.000000000 -0800
+++ pki-core-9.0.3/cmake/Modules/DefineCompilerFlags.cmake	2015-02-04 15:53:28.000000000 -0800
@@ -11,7 +11,9 @@ if (UNIX AND NOT WIN32)
         # add -Wconversion ?
         #set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -std=gnu99 -pedantic -pedantic-errors")
         set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -Wall -Wextra -Wshadow -Wmissing-prototypes -Wdeclaration-after-statement")
-        set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -Wunused -Wfloat-equal -Wpointer-arith -Wwrite-strings -Wformat-security")
+        # FESCo Ticket #1185 (https://fedorahosted.org/fesco/ticket/1185):
+        #       replace '-Wformat-security' with '-Werror=format-security'
+        set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -Wunused -Wfloat-equal -Wpointer-arith -Wwrite-strings -Werror=format-security")
         set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -Wmissing-format-attribute")
 
         # with -fPIC
diff -rupN pki-core-9.0.3.orig/cmake/Modules/DefineInstallationPaths.cmake pki-core-9.0.3/cmake/Modules/DefineInstallationPaths.cmake
--- pki-core-9.0.3.orig/cmake/Modules/DefineInstallationPaths.cmake	2011-02-04 08:55:45.000000000 -0800
+++ pki-core-9.0.3/cmake/Modules/DefineInstallationPaths.cmake	2015-02-04 15:53:28.000000000 -0800
@@ -8,7 +8,6 @@ if (UNIX)
   SET(LIB_SUFFIX
     CACHE STRING "Define suffix of directory name (32/64)"
   )
-
   SET(EXEC_INSTALL_PREFIX
     "${CMAKE_INSTALL_PREFIX}"
     CACHE PATH  "Base directory for executables and libraries"
diff -rupN pki-core-9.0.3.orig/cmake/Modules/FindJNI.cmake pki-core-9.0.3/cmake/Modules/FindJNI.cmake
--- pki-core-9.0.3.orig/cmake/Modules/FindJNI.cmake	2011-02-04 08:55:45.000000000 -0800
+++ pki-core-9.0.3/cmake/Modules/FindJNI.cmake	1969-12-31 16:00:00.000000000 -0800
@@ -1,254 +0,0 @@
-# - Find JNI java libraries.
-# This module finds if Java is installed and determines where the
-# include files and libraries are. It also determines what the name of
-# the library is. This code sets the following variables:
-#
-#  JNI_INCLUDE_DIRS      = the include dirs to use
-#  JNI_LIBRARIES         = the libraries to use
-#  JAVA_AWT_LIBRARY      = the path to the jawt library
-#  JAVA_JVM_LIBRARY      = the path to the jvm library
-#  JAVA_INCLUDE_PATH     = the include path to jni.h
-#  JAVA_INCLUDE_PATH2    = the include path to jni_md.h
-#  JAVA_AWT_INCLUDE_PATH = the include path to jawt.h
-#
-
-#=============================================================================
-# Copyright 2001-2009 Kitware, Inc.
-#
-# Distributed under the OSI-approved BSD License (the "License");
-# see accompanying file Copyright.txt for details.
-#
-# This software is distributed WITHOUT ANY WARRANTY; without even the
-# implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
-# See the License for more information.
-#=============================================================================
-# (To distributed this file outside of CMake, substitute the full
-#  License text for the above reference.)
-
-# Expand {libarch} occurences to java_libarch subdirectory(-ies) and set ${_var}
-macro(JAVA_APPEND_LIBRARY_DIRECTORIES _var)
-    # Determine java arch-specific library subdir
-    if (CMAKE_SYSTEM_NAME MATCHES "Linux")
-        # Based on openjdk/jdk/make/common/shared/Platform.gmk as of 6b16
-        # and kaffe as of 1.1.8 which uses the first part of the
-        # GNU config.guess platform triplet.
-        if (CMAKE_SYSTEM_PROCESSOR MATCHES "^i[3-9]86$")
-            set(_java_libarch "i386")
-        elseif (CMAKE_SYSTEM_PROCESSOR STREQUAL "x86_64")
-            set(_java_libarch "amd64" "x86_64")
-        elseif (CMAKE_SYSTEM_PROCESSOR MATCHES "^ppc")
-            set(_java_libarch "ppc" "powerpc" "ppc64")
-        elseif (CMAKE_SYSTEM_PROCESSOR MATCHES "^sparc")
-            set(_java_libarch "sparc" "sparcv9")
-        else (CMAKE_SYSTEM_PROCESSOR MATCHES "^i[3-9]86$")
-            set(_java_libarch "${CMAKE_SYSTEM_PROCESSOR}")
-        endif(CMAKE_SYSTEM_PROCESSOR MATCHES "^i[3-9]86$")
-    else (CMAKE_SYSTEM_NAME MATCHES "Linux")
-        set(_java_libarch "i386" "amd64" "ppc") # previous default
-    endif (CMAKE_SYSTEM_NAME MATCHES "Linux")
-
-    foreach(_path ${ARGN})
-        if (_path MATCHES "{libarch}")
-            foreach(_libarch ${_java_libarch})
-                string(REPLACE "{libarch}" "${_libarch}" _newpath "${_path}")
-                list(APPEND ${_var} "${_newpath}")
-            endforeach(_libarch)
-        else (_path MATCHES "{libarch}")
-            list(APPEND ${_var} "${_path}")
-        endif (_path MATCHES "{libarch}")
-    endforeach(_path)
-endmacro(JAVA_APPEND_LIBRARY_DIRECTORIES)
-
-file(TO_CMAKE_PATH "$ENV{JAVA_HOME}" _JAVA_HOME)
-
-get_filename_component(java_install_version
-  "[HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit;CurrentVersion]" NAME
-)
-
-set(JAVA_AWT_LIBRARY_DIRECTORIES
-    "[HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit\\1.4;JavaHome]/lib"
-    "[HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit\\1.3;JavaHome]/lib"
-    "[HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit\\${java_install_version};JavaHome]/lib"
-)
-
-
-java_append_library_directories(JAVA_AWT_LIBRARY_DIRECTORIES
-    ${_JAVA_HOME}/jre/lib/{libarch}
-    ${_JAVA_HOME}/jre/lib
-    ${_JAVA_HOME}/lib
-    ${_JAVA_HOME}
-    /usr/lib
-    /usr/local/lib
-    /usr/lib/jvm/java/lib
-    /usr/lib/java/jre/lib/{libarch}
-    /usr/local/lib/java/jre/lib/{libarch}
-    /usr/local/share/java/jre/lib/{libarch}
-    /usr/lib/j2sdk1.4-sun/jre/lib/{libarch}
-    /usr/lib/j2sdk1.5-sun/jre/lib/{libarch}
-    /opt/sun-jdk-1.5.0.04/jre/lib/{libarch}
-    /usr/lib/jvm/java-6-sun/jre/lib/{libarch}
-    /usr/lib/jvm/java-1.5.0-sun/jre/lib/{libarch}
-    /usr/lib/jvm/java-6-sun-1.6.0.00/jre/lib/{libarch}       # can this one be removed according to #8821 ? Alex
-    /usr/lib/jvm/java-openjdk/jre/lib/{libarch}
-    /usr/lib/jvm/java-6-openjdk/jre/lib/{libarch}
-    /usr/lib/jvm/java-openjdk/jre/lib/{libarch}
-    # Debian specific paths for default JVM
-    /usr/lib/jvm/default-java/jre/lib/{libarch}
-    /usr/lib/jvm/default-java/jre/lib
-    /usr/lib/jvm/default-java/lib
-)
-
-set(JAVA_JVM_LIBRARY_DIRECTORIES)
-foreach (dir ${JAVA_AWT_LIBRARY_DIRECTORIES})
-    set(JAVA_JVM_LIBRARY_DIRECTORIES
-        ${JAVA_JVM_LIBRARY_DIRECTORIES}
-        "${dir}"
-        "${dir}/client"
-        "${dir}/server"
-    )
-endforeach (dir)
-
-
-set(JAVA_AWT_INCLUDE_DIRECTORIES
-    "[HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit\\1.4;JavaHome]/include"
-    "[HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit\\1.3;JavaHome]/include"
-    "[HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit\\${java_install_version};JavaHome]/include"
-    ${_JAVA_HOME}/include
-    /usr/include
-    /usr/local/include
-    /usr/lib/java/include
-    /usr/local/lib/java/include
-    /usr/lib/jvm/java/include
-    /usr/lib/jvm/java-6-sun/include
-    /usr/lib/jvm/java-1.5.0-sun/include
-    /usr/lib/jvm/java-6-sun-1.6.0.00/include       # can this one be removed according to #8821 ? Alex
-    /usr/lib/jvm/java-6-openjdk/include
-    /usr/local/share/java/include
-    /usr/lib/j2sdk1.4-sun/include
-    /usr/lib/j2sdk1.5-sun/include
-    /opt/sun-jdk-1.5.0.04/include
-    # Debian specific path for default JVM
-    /usr/lib/jvm/default-java/include
-)
-
-foreach(JAVA_PROG "${JAVA_RUNTIME}" "${JAVA_COMPILE}" "${JAVA_ARCHIVE}" "${JAVA_HEADER}")
-    get_filename_component(jpath "${JAVA_PROG}" PATH)
-    foreach (JAVA_INC_PATH ../include ../java/include ../share/java/include)
-        if (EXISTS ${jpath}/${JAVA_INC_PATH})
-            set(JAVA_AWT_INCLUDE_DIRECTORIES
-                ${JAVA_AWT_INCLUDE_DIRECTORIES}
-                "${jpath}/${JAVA_INC_PATH}"
-            )
-        endif (EXISTS ${jpath}/${JAVA_INC_PATH})
-    endforeach (JAVA_INC_PATH)
-
-    foreach (JAVA_LIB_PATH
-            ../lib ../jre/lib ../jre/lib/i386
-            ../java/lib ../java/jre/lib ../java/jre/lib/i386
-            ../share/java/lib ../share/java/jre/lib ../share/java/jre/lib/i386)
-        if (EXISTS ${jpath}/${JAVA_LIB_PATH})
-            set(JAVA_AWT_LIBRARY_DIRECTORIES
-                ${JAVA_AWT_LIBRARY_DIRECTORIES}
-                "${jpath}/${JAVA_LIB_PATH}"
-            )
-        endif (EXISTS ${jpath}/${JAVA_LIB_PATH})
-    endforeach (JAVA_LIB_PATH)
-endforeach (JAVA_PROG)
-
-if (APPLE)
-    if (EXISTS ~/Library/Frameworks/JavaVM.framework)
-        set(JAVA_HAVE_FRAMEWORK 1)
-    endif (EXISTS ~/Library/Frameworks/JavaVM.framework)
-
-    if (EXISTS /Library/Frameworks/JavaVM.framework)
-        SET(JAVA_HAVE_FRAMEWORK 1)
-    endif (EXISTS /Library/Frameworks/JavaVM.framework)
-
-    if (EXISTS /System/Library/Frameworks/JavaVM.framework)
-        set(JAVA_HAVE_FRAMEWORK 1)
-    endif(EXISTS /System/Library/Frameworks/JavaVM.framework)
-
-    if (JAVA_HAVE_FRAMEWORK)
-        if(NOT JAVA_AWT_LIBRARY)
-            set(JAVA_AWT_LIBRARY "-framework JavaVM" CACHE FILEPATH "Java Frameworks" FORCE)
-        endif(NOT JAVA_AWT_LIBRARY)
-
-        if (NOT JAVA_JVM_LIBRARY)
-            set (JAVA_JVM_LIBRARY "-framework JavaVM" CACHE FILEPATH "Java Frameworks" FORCE)
-        endif (NOT JAVA_JVM_LIBRARY)
-
-        if (NOT JAVA_AWT_INCLUDE_PATH)
-            if (EXISTS /System/Library/Frameworks/JavaVM.framework/Headers/jawt.h)
-                set(JAVA_AWT_INCLUDE_PATH "/System/Library/Frameworks/JavaVM.framework/Headers" CACHE FILEPATH "jawt.h location" FORCE)
-            endif(EXISTS /System/Library/Frameworks/JavaVM.framework/Headers/jawt.h)
-        endif (NOT JAVA_AWT_INCLUDE_PATH)
-
-        #
-        # If using "-framework JavaVM", prefer its headers *before* the others in
-        # JAVA_AWT_INCLUDE_DIRECTORIES... (*prepend* to the list here)
-        #
-        set(JAVA_AWT_INCLUDE_DIRECTORIES
-            ~/Library/Frameworks/JavaVM.framework/Headers
-            /Library/Frameworks/JavaVM.framework/Headers
-            /System/Library/Frameworks/JavaVM.framework/Headers
-            ${JAVA_AWT_INCLUDE_DIRECTORIES}
-        )
-    endif(JAVA_HAVE_FRAMEWORK)
-else (APPLE)
-    find_library(JAVA_AWT_LIBRARY
-        NAMES
-            jawt
-        PATHS
-            ${JAVA_AWT_LIBRARY_DIRECTORIES}
-    )
-
-    find_library(JAVA_JVM_LIBRARY
-        NAMES
-            jvm
-            JavaVM
-        PATHS
-            ${JAVA_JVM_LIBRARY_DIRECTORIES}
-    )
-endif (APPLE)
-
-# add in the include path
-find_path(JAVA_INCLUDE_PATH
-    NAMES
-        jni.h
-    PATHS
-        ${JAVA_AWT_INCLUDE_DIRECTORIES}
-)
-
-find_path(JAVA_INCLUDE_PATH2
-    NAMES
-        jni_md.h
-    PATHS
-        ${JAVA_INCLUDE_PATH}
-        ${JAVA_INCLUDE_PATH}/win32
-        ${JAVA_INCLUDE_PATH}/linux
-        ${JAVA_INCLUDE_PATH}/freebsd
-        ${JAVA_INCLUDE_PATH}/solaris
-)
-
-find_path(JAVA_AWT_INCLUDE_PATH
-    NAMES
-        jawt.h
-    PATHS
-        ${JAVA_INCLUDE_PATH}
-)
-
-set(JNI_LIBRARIES
-    ${JAVA_AWT_LIBRARY}
-    ${JAVA_JVM_LIBRARY}
-)
-
-set(JNI_INCLUDE_DIRS
-    ${JAVA_INCLUDE_PATH}
-    ${JAVA_INCLUDE_PATH2}
-    ${JAVA_AWT_INCLUDE_PATH}
-)
-
-include(FindPackageHandleStandardArgs)
-find_package_handle_standard_args(JNI DEFAULT_MSG JNI_LIBRARIES JNI_INCLUDE_DIRS JAVA_AWT_LIBRARY JAVA_JVM_LIBRARY)
-
-mark_as_advanced(JNI_LIBRARIES JNI_INCLUDE_DIRS JAVA_AWT_LIBRARY JAVA_JVM_LIBRARY)
diff -rupN pki-core-9.0.3.orig/cmake/Modules/FindJava.cmake pki-core-9.0.3/cmake/Modules/FindJava.cmake
--- pki-core-9.0.3.orig/cmake/Modules/FindJava.cmake	2011-02-04 08:55:45.000000000 -0800
+++ pki-core-9.0.3/cmake/Modules/FindJava.cmake	1969-12-31 16:00:00.000000000 -0800
@@ -1,86 +0,0 @@
-# - Find Java
-# This module finds if Java is installed and determines where the
-# include files and libraries are. This code sets the following
-# variables:
-#
-#  JAVA_RUNTIME    = the full path to the Java runtime
-#  JAVA_COMPILE    = the full path to the Java compiler
-#  JAVA_ARCHIVE    = the full path to the Java archiver
-#  JAVA_HEADER     = the full path to the Java header generator
-#
-
-#=============================================================================
-# Copyright 2002-2009 Kitware, Inc.
-#
-# Distributed under the OSI-approved BSD License (the "License");
-# see accompanying file Copyright.txt for details.
-#
-# This software is distributed WITHOUT ANY WARRANTY; without even the
-# implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
-# See the License for more information.
-#=============================================================================
-# (To distributed this file outside of CMake, substitute the full
-#  License text for the above reference.)
-
-set(JAVA_BIN_PATH
-    "[HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit\\2.0;JavaHome]/bin"
-    "[HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit\\1.9;JavaHome]/bin"
-    "[HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit\\1.8;JavaHome]/bin"
-    "[HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit\\1.7;JavaHome]/bin"
-    "[HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit\\1.6;JavaHome]/bin"
-    "[HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit\\1.5;JavaHome]/bin"
-    "[HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit\\1.4;JavaHome]/bin"
-    "[HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit\\1.3;JavaHome]/bin"
-    $ENV{JAVA_HOME}/bin
-    /usr/bin
-    /usr/lib/java/bin
-    /usr/share/java/bin
-    /usr/local/bin
-    /usr/local/java/bin
-    /usr/local/java/share/bin
-    /usr/java/j2sdk1.4.2_04
-    /usr/lib/j2sdk1.4-sun/bin
-    /usr/java/j2sdk1.4.2_09/bin
-    /usr/lib/j2sdk1.5-sun/bin
-    /opt/sun-jdk-1.5.0.04/bin
-  )
-
-find_program(JAVA_RUNTIME
-    NAMES
-        java
-    PATHS
-        ${JAVA_BIN_PATH}
-)
-
-find_program(JAVA_ARCHIVE
-    NAMES
-        jar
-    PATHS
-        ${JAVA_BIN_PATH}
-)
-
-find_program(JAVA_COMPILE
-    NAMES
-        javac
-    PATHS
-        ${JAVA_BIN_PATH}
-)
-
-find_program(JAVA_HEADER
-    NAMES
-        javah
-    PATHS
-        ${JAVA_BIN_PATH}
-)
-
-find_program(JAVA_DOC
-    NAMES
-        javadoc
-    PATHS
-        ${JAVA_BIN_PATH}
-)
-
-include(FindPackageHandleStandardArgs)
-find_package_handle_standard_args(Java DEFAULT_MSG JAVA_RUNTIME JAVA_ARCHIVE JAVA_COMPILE)
-
-mark_as_advanced(JAVA_RUNTIME JAVA_ARCHIVE JAVA_COMPILE JAVA_HEADER JAVA_DOC)
diff -rupN pki-core-9.0.3.orig/cmake/Modules/FindLdap.cmake pki-core-9.0.3/cmake/Modules/FindLdap.cmake
--- pki-core-9.0.3.orig/cmake/Modules/FindLdap.cmake	2011-02-04 08:55:45.000000000 -0800
+++ pki-core-9.0.3/cmake/Modules/FindLdap.cmake	2015-02-04 15:53:28.000000000 -0800
@@ -39,6 +39,7 @@ else (LDAP_LIBRARIES AND LDAP_INCLUDE_DI
       ldap
     PATHS
       /usr/lib
+      /usr/lib64
       /usr/local/lib
       /opt/local/lib
       /sw/lib
@@ -49,6 +50,7 @@ else (LDAP_LIBRARIES AND LDAP_INCLUDE_DI
       lber
     PATHS
       /usr/lib
+      /usr/lib64
       /usr/local/lib
       /opt/local/lib
       /sw/lib
diff -rupN pki-core-9.0.3.orig/cmake/Modules/FindOpenSSL.cmake pki-core-9.0.3/cmake/Modules/FindOpenSSL.cmake
--- pki-core-9.0.3.orig/cmake/Modules/FindOpenSSL.cmake	2011-02-04 08:55:45.000000000 -0800
+++ pki-core-9.0.3/cmake/Modules/FindOpenSSL.cmake	1969-12-31 16:00:00.000000000 -0800
@@ -1,143 +0,0 @@
-# - Try to find OpenSSL
-# Once done this will define
-#
-#  OPENSSL_FOUND - system has OpenSSL
-#  OPENSSL_INCLUDE_DIRS - the OpenSSL include directory
-#  OPENSSL_LIBRARIES - Link these to use OpenSSL
-#  OPENSSL_DEFINITIONS - Compiler switches required for using OpenSSL
-#
-#  Copyright (c) 2009-2010 Andreas Schneider <mail@cynapses.org>
-#
-#  Redistribution and use is allowed according to the terms of the New
-#  BSD license.
-#  For details see the accompanying COPYING-CMAKE-SCRIPTS file.
-#
-
-
-if (OPENSSL_LIBRARIES AND OPENSSL_INCLUDE_DIRS)
-  # in cache already
-  set(OPENSSL_FOUND TRUE)
-else (OPENSSL_LIBRARIES AND OPENSSL_INCLUDE_DIRS)
-  if (WIN32)
-    set(_OPENSSL_DIR $ENV{PROGRAMFILES}/OpenSSL)
-  endif (WIN32)
-
-  find_package(PkgConfig)
-  if (PKG_CONFIG_FOUND)
-    pkg_check_modules(_OPENSSL openssl)
-  endif (PKG_CONFIG_FOUND)
-
-  find_path(OPENSSL_INCLUDE_DIR
-    NAMES
-      openssl/ssl.h
-    PATHS
-      ${_OPENSSL_DIR}/include
-      ${_OPENSSL_INCLUDEDIR}
-      /usr/include
-      /usr/local/include
-      /opt/local/include
-      /sw/include
-      /usr/lib/sfw/include
-  )
-
-  find_library(SSL_LIBRARY
-    NAMES
-      ssl
-      libssl
-    PATHS
-      ${_OPENSSL_DIR}/lib
-      ${_OPENSSL_LIBDIR}
-      /usr/lib
-      /usr/local/lib
-      /opt/local/lib
-      /sw/lib
-      /usr/sfw/lib/64
-      /usr/sfw/lib
-  )
-
-  find_library(SSLEAY32_LIBRARY
-    NAMES
-      ssleay32
-    PATHS
-      ${_OPENSSL_DIR}/lib
-      ${_OPENSSL_LIBDIR}
-      /usr/lib
-      /usr/local/lib
-      /opt/local/lib
-      /sw/lib
-      /usr/sfw/lib/64
-      /usr/sfw/lib
-  )
-
-  find_library(SSLEAY32MD_LIBRARY
-    NAMES
-      ssleay32MD
-    PATHS
-      ${_OPENSSL_DIR}/lib
-      ${_OPENSSL_LIBDIR}
-      /usr/lib
-      /usr/local/lib
-      /opt/local/lib
-      /sw/lib
-      /usr/sfw/lib/64
-      /usr/sfw/lib
-  )
-
-  find_library(CRYPTO_LIBRARY
-    NAMES
-      crypto
-      libcrypto
-      eay
-      eay32
-      libeay
-      libeay32
-    PATHS
-      ${_OPENSSL_DIR}/lib
-      ${_OPENSSL_LIBDIR}
-      /usr/lib
-      /usr/local/lib
-      /opt/local/lib
-      /sw/lib
-      /usr/sfw/lib/64
-      /usr/sfw/lib
-  )
-
-  set(OPENSSL_INCLUDE_DIRS
-    ${OPENSSL_INCLUDE_DIR}
-  )
-
-  if (SSL_LIBRARY)
-    set(OPENSSL_LIBRARIES
-        ${OPENSSL_LIBRARIES}
-        ${SSL_LIBRARY}
-    )
-  endif (SSL_LIBRARY)
-
-  if (SSLEAY32_LIBRARY)
-    set(OPENSSL_LIBRARIES
-        ${OPENSSL_LIBRARIES}
-        ${SSLEAY32_LIBRARY}
-    )
-  endif (SSLEAY32_LIBRARY)
-
-  if (SSLEAY32MD_LIBRARY)
-    set(OPENSSL_LIBRARIES
-        ${OPENSSL_LIBRARIES}
-        ${SSLEAY32MD_LIBRARY}
-    )
-  endif (SSLEAY32MD_LIBRARY)
-
-  if (CRYPTO_LIBRARY)
-    set(OPENSSL_LIBRARIES
-        ${OPENSSL_LIBRARIES}
-        ${CRYPTO_LIBRARY}
-    )
-  endif (CRYPTO_LIBRARY)
-
-  include(FindPackageHandleStandardArgs)
-  find_package_handle_standard_args(OpenSSL DEFAULT_MSG OPENSSL_LIBRARIES OPENSSL_INCLUDE_DIRS)
-
-  # show the OPENSSL_INCLUDE_DIRS and OPENSSL_LIBRARIES variables only in the advanced view
-  mark_as_advanced(OPENSSL_INCLUDE_DIRS OPENSSL_LIBRARIES)
-
-endif (OPENSSL_LIBRARIES AND OPENSSL_INCLUDE_DIRS)
diff -rupN pki-core-9.0.3.orig/cmake/Modules/FindZLIB.cmake pki-core-9.0.3/cmake/Modules/FindZLIB.cmake
--- pki-core-9.0.3.orig/cmake/Modules/FindZLIB.cmake	2011-02-04 08:55:45.000000000 -0800
+++ pki-core-9.0.3/cmake/Modules/FindZLIB.cmake	1969-12-31 16:00:00.000000000 -0800
@@ -1,69 +0,0 @@
-# - Try to find ZLIB
-# Once done this will define
-#
-#  ZLIB_FOUND - system has ZLIB
-#  ZLIB_INCLUDE_DIRS - the ZLIB include directory
-#  ZLIB_LIBRARIES - Link these to use ZLIB
-#  ZLIB_DEFINITIONS - Compiler switches required for using ZLIB
-#
-#  Copyright (c) 2009-2010 Andreas Schneider <mail@cynapses.org>
-#
-#  Redistribution and use is allowed according to the terms of the New
-#  BSD license.
-#  For details see the accompanying COPYING-CMAKE-SCRIPTS file.
-#
-
-
-if (ZLIB_LIBRARIES AND ZLIB_INCLUDE_DIRS)
-  # in cache already
-  set(ZLIB_FOUND TRUE)
-else (ZLIB_LIBRARIES AND ZLIB_INCLUDE_DIRS)
-  if (WIN32)
-    set(_ZLIB_DIR $ENV{PROGRAMFILES}/GnuWin32)
-  endif (WIN32)
-
-  find_path(ZLIB_INCLUDE_DIR
-    NAMES
-      zlib.h
-    PATHS
-      ${_ZLIB_DIR}/include
-      /usr/include
-      /usr/local/include
-      /opt/local/include
-      /sw/include
-      /usr/lib/sfw/include
-  )
-
-  find_library(Z_LIBRARY
-    NAMES
-      z
-      zlib
-      zlib1
-    PATHS
-      ${_ZLIB_DIR}/lib
-      /usr/lib
-      /usr/local/lib
-      /opt/local/lib
-      /sw/lib
-      /usr/sfw/lib/64
-      /usr/sfw/lib
-  )
-
-  set(ZLIB_INCLUDE_DIRS
-    ${ZLIB_INCLUDE_DIR}
-  )
-
-  if (Z_LIBRARY)
-    set(ZLIB_LIBRARIES
-        ${ZLIB_LIBRARIES}
-        ${Z_LIBRARY}
-    )
-  endif (Z_LIBRARY)
-
-  include(FindPackageHandleStandardArgs)
-  find_package_handle_standard_args(ZLIB DEFAULT_MSG ZLIB_LIBRARIES ZLIB_INCLUDE_DIRS)
-
-  # show the ZLIB_INCLUDE_DIRS and ZLIB_LIBRARIES variables only in the advanced view
-  mark_as_advanced(ZLIB_INCLUDE_DIRS ZLIB_LIBRARIES)
-
-endif (ZLIB_LIBRARIES AND ZLIB_INCLUDE_DIRS)
diff -rupN pki-core-9.0.3.orig/cmake/Modules/JUnit.cmake pki-core-9.0.3/cmake/Modules/JUnit.cmake
--- pki-core-9.0.3.orig/cmake/Modules/JUnit.cmake	1969-12-31 16:00:00.000000000 -0800
+++ pki-core-9.0.3/cmake/Modules/JUnit.cmake	2015-02-04 15:53:28.000000000 -0800
@@ -0,0 +1,65 @@
+#
+# This file provides functions for JUnit support.
+#
+# Available Functions:
+#
+#   add_junit_test(<target name>
+#       CLASSPATH [path1 ...]
+#       TESTS [class1 ...]
+#   )
+#
+#   This command creates a target for executing JUnit test classes
+#   using the specified class path.
+#
+
+find_file(JUNIT_JAR
+    NAMES
+        junit4.jar
+    PATHS
+        ${JAVA_LIB_INSTALL_DIR}
+        /usr/share/java
+)
+
+function(add_junit_test TARGET_NAME)
+
+    if (WIN32 AND NOT CYGWIN)
+        set(SEPARATOR ";")
+    else (WIN32 AND NOT CYGWIN)
+        set(SEPARATOR ":")
+    endif(WIN32 AND NOT CYGWIN)
+
+    set(REPORTS_DIR "reports")
+
+    foreach (ARG ${ARGN})
+        if (ARG MATCHES "(CLASSPATH|TESTS|REPORTS_DIR)")
+            set(TYPE ${ARG})
+
+        else (ARG MATCHES "(CLASSPATH|TESTS|REPORTS_DIR)")
+
+            if (TYPE MATCHES "CLASSPATH")
+                set(CLASSPATH "${CLASSPATH}${SEPARATOR}${ARG}")
+
+            elseif (TYPE MATCHES "TESTS")
+                set(TESTS ${TESTS} ${ARG})
+
+            elseif (TYPE MATCHES "REPORTS_DIR")
+                set(REPORTS_DIR ${ARG})
+
+            endif(TYPE MATCHES "CLASSPATH")
+
+        endif(ARG MATCHES "(CLASSPATH|TESTS|REPORTS_DIR)")
+
+    endforeach(ARG)
+
+    add_custom_target(${TARGET_NAME}
+        COMMAND
+            mkdir -p "${REPORTS_DIR}"
+        COMMAND
+            ${Java_JAVA_EXECUTABLE}
+            -Djunit.reports.dir=${REPORTS_DIR}
+            -classpath ${CLASSPATH}
+            com.netscape.test.TestRunner
+            ${TESTS}
+    )
+
+endfunction(add_junit_test)
diff -rupN pki-core-9.0.3.orig/cmake/Modules/Java.cmake pki-core-9.0.3/cmake/Modules/Java.cmake
--- pki-core-9.0.3.orig/cmake/Modules/Java.cmake	1969-12-31 16:00:00.000000000 -0800
+++ pki-core-9.0.3/cmake/Modules/Java.cmake	2015-02-04 15:53:28.000000000 -0800
@@ -0,0 +1,323 @@
+# --- BEGIN COPYRIGHT BLOCK ---
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; version 2 of the License.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License along
+# with this program; if not, write to the Free Software Foundation, Inc.,
+# 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
+#
+# (C) 2012 Red Hat, Inc.
+# All rights reserved.
+# --- END COPYRIGHT BLOCK ---
+#
+# Author: Endi S. Dewata
+
+function(javac target)
+
+    set(source_dir ${CMAKE_CURRENT_SOURCE_DIR})
+
+    foreach (arg ${ARGN})
+
+        if (arg MATCHES "(SOURCE_DIR|SOURCES|EXCLUDE|CLASSPATH|OUTPUT_DIR|DEPENDS)")
+            set(param ${arg})
+
+        else ()
+
+            if (param STREQUAL "SOURCE_DIR")
+                set(source_dir ${arg})
+
+            elseif (param STREQUAL "SOURCES")
+                list(APPEND sources ${arg})
+
+            elseif (param STREQUAL "EXCLUDE")
+                list(APPEND exclude ${arg})
+
+            elseif (param STREQUAL "CLASSPATH")
+                list(APPEND classpath ${arg})
+
+            elseif (param STREQUAL "OUTPUT_DIR")
+                set(output_dir ${arg})
+
+            elseif (param STREQUAL "DEPENDS")
+                list(APPEND depends ${arg})
+
+            endif(param STREQUAL "SOURCE_DIR")
+
+        endif(arg MATCHES "(SOURCE_DIR|SOURCES|EXCLUDE|CLASSPATH|OUTPUT_DIR|DEPENDS)")
+
+    endforeach(arg)
+
+    if (UNIX)
+        set(separator ":")
+    else (UNIX)
+        set(separator ";")
+    endif(UNIX)
+
+    foreach (path ${classpath})
+       set(native_classpath "${native_classpath}${separator}${path}")
+    endforeach(path)
+
+    set(file_list "${CMAKE_CURRENT_BINARY_DIR}/${target}.files")
+
+    add_custom_target(${target} ALL DEPENDS ${depends})
+
+    file(MAKE_DIRECTORY ${output_dir})
+
+    add_custom_command(
+        TARGET ${target}
+        COMMAND ${CMAKE_COMMAND}
+            -Doutput=${file_list}
+            -Dinput_dir=${source_dir}
+            -Dfiles="${sources}"
+            -Dexclude="${exclude}"
+            -P ${CMAKE_MODULE_PATH}/JavaFileList.cmake
+        COMMAND ${Java_JAVAC_EXECUTABLE}
+            ${CMAKE_JAVA_COMPILE_FLAGS}
+            -encoding UTF-8
+            -cp ${native_classpath}
+            -d ${output_dir}
+            @${file_list}
+        WORKING_DIRECTORY
+            ${source_dir}
+    )
+
+endfunction(javac)
+
+function(jar target)
+
+    set(size 0)
+
+    foreach (arg ${ARGN})
+
+        if (arg STREQUAL "CREATE")
+            set(param ${arg})
+            set(operation "c")
+
+        elseif (arg STREQUAL "UPDATE")
+            set(param ${arg})
+            set(operation "u")
+
+        elseif (arg STREQUAL "EXTRACT")
+            set(param ${arg})
+            set(operation "x")
+
+        elseif (arg MATCHES "(OPTIONS|PARAMS|INPUT_DIR|FILES|EXCLUDE|DEPENDS)")
+            set(param ${arg})
+
+        else ()
+
+            if (param MATCHES "(CREATE|UPDATE|EXTRACT)")
+                set(options f)
+                set(params ${arg})
+
+            elseif (param STREQUAL "OPTIONS")
+                set(options ${options}${arg})
+
+            elseif (param STREQUAL "PARAMS")
+                set(params ${params} ${arg})
+
+            elseif (param STREQUAL "INPUT_DIR")
+                set(counter ${size})
+                set(input_dir_${counter} ${arg})
+                math(EXPR size "${counter} + 1")
+
+            elseif (param STREQUAL "FILES")
+                if (NOT DEFINED counter)
+                    set(counter 0)
+                endif(NOT DEFINED counter)
+
+                list(APPEND files_${counter} ${arg})
+
+            elseif (param STREQUAL "EXCLUDE")
+                list(APPEND exclude_${counter} ${arg})
+
+            elseif (param STREQUAL "DEPENDS")
+                list(APPEND depends ${arg})
+
+            endif(param MATCHES "(CREATE|UPDATE|EXTRACT)")
+
+        endif(arg STREQUAL "CREATE")
+
+    endforeach(arg)
+
+    add_custom_target(${target} ALL DEPENDS ${depends})
+
+    foreach(i RANGE ${counter})
+
+        # by default use the current source dir
+        if (NOT DEFINED input_dir_${counter})
+            set(input_dir_${counter} ${CMAKE_CURRENT_SOURCE_DIR})
+        endif(NOT DEFINED input_dir_${counter})
+
+        # by default include all files
+        if (NOT DEFINED files_${i})
+            set(files_${i} "*")
+        endif(NOT DEFINED files_${i})
+
+        # if i == 0 do the original operation
+        # otherwise, do an update operation
+        if (${i} GREATER 0)
+            set(operation "u")
+        endif(${i} GREATER 0)
+
+        set(file_list_${i} "${CMAKE_CURRENT_BINARY_DIR}/${target}-${i}.files")
+
+        add_custom_command(
+            TARGET ${target}
+            COMMAND ${CMAKE_COMMAND}
+                -Doutput=${file_list_${i}}
+                -Dinput_dir=${input_dir_${i}}
+                -Dfiles="${files_${i}}"
+                -Dexclude="${exclude_${i}}"
+                -P ${CMAKE_MODULE_PATH}/JavaFileList.cmake
+            COMMAND ${Java_JAR_EXECUTABLE}
+                ${operation}${options} ${params}
+                @${file_list_${i}}
+            WORKING_DIRECTORY ${input_dir_${i}}
+        )
+
+    endforeach(i RANGE ${counter})
+
+endfunction(jar)
+
+function(javadoc target)
+
+    set(sourcepath ${CMAKE_CURRENT_SOURCE_DIR})
+    set(dest ${CMAKE_CURRENT_BINARY_DIR}/javadoc)
+
+    foreach (arg ${ARGN})
+
+        if (arg MATCHES "(SOURCEPATH|CLASSPATH|FILES|PACKAGES|SUBPACKAGES|EXCLUDE|OPTIONS|DEST|DEPENDS)")
+            set(param ${arg})
+
+        else ()
+
+            if (param STREQUAL "SOURCEPATH")
+                list(APPEND sourcepath ${arg})
+
+            elseif (param STREQUAL "CLASSPATH")
+                list(APPEND classpath ${arg})
+
+            elseif (param STREQUAL "FILES")
+                list(APPEND files ${arg})
+
+            elseif (param STREQUAL "PACKAGES")
+                list(APPEND packages ${arg})
+
+            elseif (param STREQUAL "SUBPACKAGES")
+                list(APPEND subpackages ${arg})
+
+            elseif (param STREQUAL "EXCLUDE")
+                list(APPEND exclude ${arg})
+
+            elseif (param STREQUAL "OPTIONS")
+                list(APPEND options ${arg})
+
+            elseif (param STREQUAL "DEST")
+                set(dest ${arg})
+
+            elseif (param STREQUAL "DEPENDS")
+                list(APPEND depends ${arg})
+
+            endif(param STREQUAL "SOURCEPATH")
+
+        endif(arg MATCHES "(SOURCEPATH|CLASSPATH|FILES|PACKAGES|SUBPACKAGES|EXCLUDE|OPTIONS|DEST|DEPENDS)")
+
+    endforeach(arg)
+
+    if (UNIX)
+        set(separator ":")
+    else (UNIX)
+        set(separator ";")
+    endif(UNIX)
+
+    set(command ${Java_JAVADOC_EXECUTABLE} -d ${dest})
+
+    if (options)
+        foreach (option ${options})
+           set(command ${command} ${option})
+        endforeach(option ${options})
+    endif(options)
+
+    if (sourcepath)
+        set(tmp)
+        foreach (path ${sourcepath})
+           set(tmp "${tmp}${separator}${path}")
+        endforeach(path)
+        set(command ${command} -sourcepath ${tmp})
+    endif(sourcepath)
+
+    if (classpath)
+        set(tmp)
+        foreach (path ${classpath})
+           set(tmp "${tmp}${separator}${path}")
+        endforeach(path)
+        set(command ${command} -classpath ${tmp})
+    endif(classpath)
+
+    if (subpackages)
+        set(tmp)
+        foreach (package ${subpackages})
+           set(tmp "${tmp}:${package}")
+        endforeach(package)
+        set(command ${command} -subpackages ${tmp})
+    endif(subpackages)
+
+    if (exclude)
+        set(tmp)
+        foreach (package ${exclude})
+           set(tmp "${tmp}:${package}")
+        endforeach(path)
+        set(command ${command} -exclude ${tmp})
+    endif(exclude)
+
+    set(command ${command} ${files} ${packages})
+
+    add_custom_target(${target} ALL DEPENDS ${depends})
+
+    add_custom_command(
+        TARGET ${target}
+        COMMAND ${command}
+    )
+
+endfunction(javadoc)
+
+function(link target)
+
+    foreach (arg ${ARGN})
+
+        if (arg MATCHES "(SOURCE|DEST|DEPENDS)")
+            set(param ${arg})
+
+        else ()
+
+            if (param STREQUAL "SOURCE")
+                set(source ${arg})
+
+            elseif (param STREQUAL "DEST")
+                set(dest ${arg})
+
+            elseif (param STREQUAL "DEPENDS")
+                list(APPEND depends ${arg})
+
+            endif(param STREQUAL "SOURCE")
+
+        endif(arg MATCHES "(SOURCE|DEST|DEPENDS)")
+
+    endforeach(arg)
+
+    add_custom_target(${target} ALL DEPENDS ${depends})
+
+    add_custom_command(
+        TARGET ${target}
+        COMMAND ${CMAKE_COMMAND}
+            -E create_symlink ${dest} ${source}
+    )
+
+endfunction(link)
diff -rupN pki-core-9.0.3.orig/cmake/Modules/JavaFileList.cmake pki-core-9.0.3/cmake/Modules/JavaFileList.cmake
--- pki-core-9.0.3.orig/cmake/Modules/JavaFileList.cmake	1969-12-31 16:00:00.000000000 -0800
+++ pki-core-9.0.3/cmake/Modules/JavaFileList.cmake	2015-02-04 15:53:29.000000000 -0800
@@ -0,0 +1,52 @@
+# --- BEGIN COPYRIGHT BLOCK ---
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; version 2 of the License.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License along
+# with this program; if not, write to the Free Software Foundation, Inc.,
+# 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
+#
+# (C) 2012 Red Hat, Inc.
+# All rights reserved.
+# --- END COPYRIGHT BLOCK ---
+#
+# Author: Endi S. Dewata
+
+file(WRITE ${output} "")
+
+separate_arguments(file_list UNIX_COMMAND ${files})
+separate_arguments(exclude_list UNIX_COMMAND ${exclude})
+
+foreach(file ${exclude_list})
+
+    file(GLOB_RECURSE absolute_files "${input_dir}/${file}")
+
+    foreach(absolute_file ${absolute_files})
+        file(RELATIVE_PATH relative_file ${input_dir} ${absolute_file})
+	    list(APPEND excluded_files ${relative_file})
+    endforeach(absolute_file ${absolute_files})
+
+endforeach(file ${exclude_list})
+
+foreach(file ${file_list})
+
+    file(GLOB_RECURSE absolute_files "${input_dir}/${file}")
+
+    foreach(absolute_file ${absolute_files})
+        file(RELATIVE_PATH relative_file ${input_dir} ${absolute_file})
+
+        list(FIND excluded_files ${relative_file} index)
+
+        if (${index} EQUAL -1)
+	        file(APPEND ${output} "${relative_file}\n")
+	    endif(${index} EQUAL -1)
+
+    endforeach(absolute_file ${absolute_files})
+
+endforeach(file ${file_list})
diff -rupN pki-core-9.0.3.orig/cmake/Modules/UseJava.cmake pki-core-9.0.3/cmake/Modules/UseJava.cmake
--- pki-core-9.0.3.orig/cmake/Modules/UseJava.cmake	2011-02-04 08:55:45.000000000 -0800
+++ pki-core-9.0.3/cmake/Modules/UseJava.cmake	1969-12-31 16:00:00.000000000 -0800
@@ -1,747 +0,0 @@
-#
-# This file provides functions for Java support.
-#
-# Available Functions:
-#
-#   add_jar(TARGET_NAME SRC1 SRC2 .. SRCN RCS1 RCS2 .. RCSN)
-#
-#   This command creates a <TARGET_NAME>.jar. It compiles the given source
-#   files (SRC) and adds the given resource files (RCS) to the jar file.
-#   If only resource files are given then just a jar file is created.
-#
-#   Additional instructions:
-#       To add compile flags to the target you can set these flags with
-#       the following variable:
-#
-#           set(CMAKE_JAVA_COMPILE_FLAGS -nowarn)
-#
-#       To add a path or a jar file to the class path you can do this
-#       with the CMAKE_JAVA_INCLUDE_PATH variable.
-#
-#           set(CMAKE_JAVA_INCLUDE_PATH /usr/share/java/shibboleet.jar)
-#
-#       To use a different output name for the target you can set it with:
-#
-#           set(CMAKE_JAVA_TARGET_OUTPUT_NAME shibboleet.jar)
-#           add_jar(foobar foobar.java)
-#
-#       To add a VERSION to the target output name you can set it using
-#       CMAKE_JAVA_TARGET_VERSION. This will create a jar file with the name
-#       shibboleet-1.0.0.jar and will create a symlink shibboleet.jar pointing
-#       to the jar with the version information.
-#
-#           set(CMAKE_JAVA_TARGET_VERSION 1.2.0)
-#           add_jar(shibboleet shibbotleet.java)
-#
-#        If the target is a JNI library, utilize the following commands to
-#        create a JNI symbolic link:
-#
-#           set(CMAKE_JNI_TARGET TRUE)
-#           set(CMAKE_JAVA_TARGET_VERSION 1.2.0)
-#           add_jar(shibboleet shibbotleet.java)
-#           install_jar(shibboleet ${LIB_INSTALL_DIR}/shibboleet)
-#           install_jni_symlink(shibboleet ${JAVA_LIB_INSTALL_DIR})
-#
-#        If a single target needs to produce more than one jar from its
-#        java source code, to prevent the accumulation of duplicate class
-#        files in subsequent jars, set/reset CMAKE_JAR_CLASSES_PREFIX prior
-#        to calling the add_jar() function:
-#
-#           set(CMAKE_JAR_CLASSES_PREFIX com/redhat/foo)
-#           add_jar(foo foo.java)
-#
-#           set(CMAKE_JAR_CLASSES_PREFIX com/redhat/bar)
-#           add_jar(bar bar.java)
-#
-#
-#   Variables set:
-#       The add_jar() functions sets some variables which can be used in the
-#       same scope where add_jar() is called.
-#
-#       <target>_INSTALL_FILES      The files which should be installed. This
-#                                   is used by install_jar().
-#       <target>_JNI_SYMLINK        The JNI symlink which should be installed.
-#                                   This is used by install_jni_symlink().
-#       <target>_JAR_FILE           The location of the jar file so that you
-#                                   can include it.
-#       <target>_CLASS_DIR          The directory where the class files can be
-#                                   found. For example to use them with javah.
-#
-#    find_jar(
-#             <VAR>
-#             name | NAMES name1 [name2 ...]
-#             [PATHS path1 [path2 ... ENV var]]
-#             [VERSIONS version1 [version2]]
-#             [DOC "cache documentation string"]
-#            )
-#
-#    This command is used to find a full path to the named jar. A cache entry
-#    named by <VAR> is created to stor the result of this command. If the full
-#    path to a jar is found the result is stored in the variable and the search
-#    will not repeated unless the variable is cleared. If nothing is found, the
-#    result will be <VAR>-NOTFOUND, and the search will be attempted again next
-#    time find_jar is invoked with the same variable.
-#    The name of the full path to a file that is searched for is specified by
-#    the names listed after NAMES argument. Additional search locations can be
-#    specified after the PATHS argument. If you require special a version of a
-#    jar file you can specify it with the VERSIONS argument. The argument after
-#    DOC will be used for the documentation string in the cache.
-#
-#    install_jar(TARGET_NAME DESTINATION)
-#
-#    This command installs the TARGET_NAME files to the given DESTINATION. It
-#    should be called in the same scope as add_jar() or it will fail.
-#
-#    install_jni_symlink(TARGET_NAME DESTINATION)
-#
-#    This command installs the TARGET_NAME JNI symlinks to the given
-#    DESTINATION. It should be called in the same scope as add_jar()
-#    or it will fail.
-#
-#=============================================================================
-# Copyright 2010      Andreas schneider <asn@redhat.com>
-# Copyright 2010      Ben Boeckel <ben.boeckel@kitware.com>
-#
-# Distributed under the OSI-approved BSD License (the "License");
-# see accompanying file Copyright.txt for details.
-#
-# This software is distributed WITHOUT ANY WARRANTY; without even the
-# implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
-# See the License for more information.
-#=============================================================================
-# (To distributed this file outside of CMake, substitute the full
-#  License text for the above reference.)
-
-function (__java_copy_file src dest comment)
-    add_custom_command(
-        OUTPUT  ${dest}
-        COMMAND cmake -E copy_if_different
-        ARGS    ${src}
-                ${dest}
-        DEPENDS ${src}
-        COMMENT ${comment})
-endfunction (__java_copy_file src dest comment)
-
-function(add_jar _TARGET_NAME)
-    set(_JAVA_SOURCE_FILES ${ARGN})
-
-    if (LIBRARY_OUTPUT_PATH)
-        set(CMAKE_JAVA_LIBRARY_OUTPUT_PATH ${LIBRARY_OUTPUT_PATH})
-    else (LIBRARY_OUTPUT_PATH)
-        set(CMAKE_JAVA_LIBRARY_OUTPUT_PATH ${CMAKE_CURRENT_BINARY_DIR})
-    endif (LIBRARY_OUTPUT_PATH)
-
-    set(CMAKE_JAVA_INCLUDE_PATH
-        ${CMAKE_JAVA_INCLUDE_PATH}
-        ${CMAKE_CURRENT_SOURCE_DIR}
-        ${CMAKE_JAVA_OBJECT_OUTPUT_PATH}
-        ${CMAKE_JAVA_LIBRARY_OUTPUT_PATH}
-    )
-
-    if (WIN32 AND NOT CYGWIN)
-        set(CMAKE_JAVA_INCLUDE_FLAG_SEP ";")
-    else (WIN32 AND NOT CYGWIN)
-        set(CMAKE_JAVA_INCLUDE_FLAG_SEP ":")
-    endif(WIN32 AND NOT CYGWIN)
-
-    foreach (JAVA_INCLUDE_DIR ${CMAKE_JAVA_INCLUDE_PATH})
-       set(CMAKE_JAVA_INCLUDE_PATH_FINAL "${CMAKE_JAVA_INCLUDE_PATH_FINAL}${CMAKE_JAVA_INCLUDE_FLAG_SEP}${JAVA_INCLUDE_DIR}")
-    endforeach(JAVA_INCLUDE_DIR)
-
-    set(CMAKE_JAVA_CLASS_OUTPUT_PATH "${CMAKE_CURRENT_BINARY_DIR}${CMAKE_FILES_DIRECTORY}/${_TARGET_NAME}.dir")
-
-    set(_JAVA_TARGET_OUTPUT_NAME "${_TARGET_NAME}.jar")
-    if (CMAKE_JAVA_TARGET_OUTPUT_NAME AND CMAKE_JAVA_TARGET_VERSION)
-        set(_JAVA_TARGET_OUTPUT_NAME "${CMAKE_JAVA_TARGET_OUTPUT_NAME}-${CMAKE_JAVA_TARGET_VERSION}.jar")
-        set(_JAVA_TARGET_OUTPUT_LINK "${CMAKE_JAVA_TARGET_OUTPUT_NAME}.jar")
-    elseif (CMAKE_JAVA_TARGET_VERSION)
-        set(_JAVA_TARGET_OUTPUT_NAME "${_TARGET_NAME}-${CMAKE_JAVA_TARGET_VERSION}.jar")
-        set(_JAVA_TARGET_OUTPUT_LINK "${_TARGET_NAME}.jar")
-    elseif (CMAKE_JAVA_TARGET_OUTPUT_NAME)
-        set(_JAVA_TARGET_OUTPUT_NAME "${CMAKE_JAVA_TARGET_OUTPUT_NAME}.jar")
-    endif (CMAKE_JAVA_TARGET_OUTPUT_NAME AND CMAKE_JAVA_TARGET_VERSION)
-    # reset
-    set(CMAKE_JAVA_TARGET_OUTPUT_NAME)
-
-    set(_JAVA_CLASS_FILES)
-    set(_JAVA_COMPILE_FILES)
-    set(_JAVA_DEPENDS)
-    set(_JAVA_RESOURCE_FILES)
-    foreach(_JAVA_SOURCE_FILE ${_JAVA_SOURCE_FILES})
-        get_filename_component(_JAVA_EXT ${_JAVA_SOURCE_FILE} EXT)
-        get_filename_component(_JAVA_FILE ${_JAVA_SOURCE_FILE} NAME_WE)
-        get_filename_component(_JAVA_PATH ${_JAVA_SOURCE_FILE} PATH)
-        get_filename_component(_JAVA_FULL ${_JAVA_SOURCE_FILE} ABSOLUTE)
-
-        file(RELATIVE_PATH _JAVA_REL_BINARY_PATH ${CMAKE_CURRENT_BINARY_DIR} ${_JAVA_FULL})
-        file(RELATIVE_PATH _JAVA_REL_SOURCE_PATH ${CMAKE_CURRENT_SOURCE_DIR} ${_JAVA_FULL})
-        string(LENGTH ${_JAVA_REL_BINARY_PATH} _BIN_LEN)
-        string(LENGTH ${_JAVA_REL_SOURCE_PATH} _SRC_LEN)
-        if (${_BIN_LEN} LESS ${_SRC_LEN})
-            set(_JAVA_REL_PATH ${_JAVA_REL_BINARY_PATH})
-        else (${_BIN_LEN} LESS ${_SRC_LEN})
-            set(_JAVA_REL_PATH ${_JAVA_REL_SOURCE_PATH})
-        endif (${_BIN_LEN} LESS ${_SRC_LEN})
-        get_filename_component(_JAVA_REL_PATH ${_JAVA_REL_PATH} PATH)
-
-        if (_JAVA_EXT MATCHES ".java")
-            list(APPEND _JAVA_COMPILE_FILES ${_JAVA_SOURCE_FILE})
-            set(_JAVA_CLASS_FILE "${CMAKE_JAVA_CLASS_OUTPUT_PATH}/${_JAVA_REL_PATH}/${_JAVA_FILE}.class")
-            set(_JAVA_CLASS_FILES ${_JAVA_CLASS_FILES} ${_JAVA_CLASS_FILE})
-
-        elseif (_JAVA_EXT MATCHES ".jar")
-            list(APPEND CMAKE_JAVA_INCLUDE_PATH ${_JAVA_SOURCE_FILE})
-
-        elseif (_JAVA_EXT STREQUAL "")
-            list(APPEND CMAKE_JAVA_INCLUDE_PATH ${JAVA_JAR_TARGET_${_JAVA_SOURCE_FILE}} ${JAVA_JAR_TARGET_${_JAVA_SOURCE_FILE}_CLASSPATH})
-            list(APPEND _JAVA_DEPENDS ${JAVA_JAR_TARGET_${_JAVA_SOURCE_FILE}})
-
-        else (_JAVA_EXT MATCHES ".java")
-            __java_copy_file(${CMAKE_CURRENT_SOURCE_DIR}/${_JAVA_SOURCE_FILE}
-                             ${CMAKE_JAVA_CLASS_OUTPUT_PATH}/${_JAVA_SOURCE_FILE}
-                             "Copying ${_JAVA_SOURCE_FILE} to the build directory")
-            list(APPEND _JAVA_RESOURCE_FILES ${_JAVA_SOURCE_FILE})
-        endif (_JAVA_EXT MATCHES ".java")
-    endforeach(_JAVA_SOURCE_FILE)
-
-    # Check if we have a local UseJavaClassFilelist.cmake
-    if (EXISTS ${CMAKE_MODULE_PATH}/UseJavaClassFilelist.cmake)
-        set(_JAVA_CLASS_FILELIST_SCRIPT ${CMAKE_MODULE_PATH}/UseJavaClassFilelist.cmake)
-    elseif (EXISTS ${CMAKE_ROOT}/Modules/UseJavaClassFilelist.cmake)
-        set(_JAVA_CLASS_FILELIST_SCRIPT ${CMAKE_ROOT}/Modules/UseJavaClassFilelist.cmake)
-    endif (EXISTS ${CMAKE_MODULE_PATH}/UseJavaClassFilelist.cmake)
-
-    # create an empty java_class_filelist
-    file(WRITE ${CMAKE_JAVA_CLASS_OUTPUT_PATH}/java_class_filelist "")
-
-    # Check if we have a local UseJavaSymlinks.cmake
-    if (EXISTS ${CMAKE_MODULE_PATH}/UseJavaSymlinks.cmake)
-        set(_JAVA_SYMLINK_SCRIPT ${CMAKE_MODULE_PATH}/UseJavaSymlinks.cmake)
-    elseif (EXISTS ${CMAKE_ROOT}/Modules/UseJavaSymlinks.cmake)
-        set(_JAVA_SYMLINK_SCRIPT ${CMAKE_ROOT}/Modules/UseJavaSymlinks.cmake)
-    endif (EXISTS ${CMAKE_MODULE_PATH}/UseJavaSymlinks.cmake)
-
-    # Add the target and make sure we have the latest resource files.
-    add_custom_target(${_TARGET_NAME} ALL DEPENDS ${_JAVA_RESOURCE_FILES} ${_JAVA_DEPENDS})
-
-    if (_JAVA_COMPILE_FILES)
-        # Compile the java files and create a list of class files
-        add_custom_command(
-            TARGET ${_TARGET_NAME}
-            COMMAND ${CMAKE_Java_COMPILER}
-                ${CMAKE_JAVA_COMPILE_FLAGS}
-                -classpath ${CMAKE_JAVA_INCLUDE_PATH_FINAL}
-                -d ${CMAKE_JAVA_CLASS_OUTPUT_PATH}
-                ${_JAVA_COMPILE_FILES}
-            COMMAND ${CMAKE_COMMAND}
-                -DCMAKE_JAVA_CLASS_OUTPUT_PATH=${CMAKE_JAVA_CLASS_OUTPUT_PATH}
-                -DCMAKE_JAR_CLASSES_PREFIX="${CMAKE_JAR_CLASSES_PREFIX}"
-                -P ${_JAVA_CLASS_FILELIST_SCRIPT}
-            WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}
-            COMMENT "Building Java objects for ${_TARGET_NAME}.jar"
-        )
-    endif (_JAVA_COMPILE_FILES)
-
-    # create the jar file
-    if (CMAKE_JNI_TARGET)
-        add_custom_command(
-            TARGET ${_TARGET_NAME}
-            COMMAND ${CMAKE_Java_ARCHIVE}
-                -cf ${CMAKE_CURRENT_BINARY_DIR}/${_JAVA_TARGET_OUTPUT_NAME}
-                ${_JAVA_RESOURCE_FILES} @java_class_filelist
-            COMMAND ${CMAKE_COMMAND}
-                -D_JAVA_TARGET_DIR=${CMAKE_CURRENT_BINARY_DIR}
-                -D_JAVA_TARGET_OUTPUT_NAME=${_JAVA_TARGET_OUTPUT_NAME}
-                -D_JAVA_TARGET_OUTPUT_LINK=${_JAVA_TARGET_OUTPUT_LINK}
-                -P ${_JAVA_SYMLINK_SCRIPT}
-            COMMAND ${CMAKE_COMMAND}
-                -D_JAVA_TARGET_DIR=${CMAKE_CURRENT_BINARY_DIR}
-                -D_JAVA_TARGET_OUTPUT_NAME=${CMAKE_CURRENT_BINARY_DIR}/${_JAVA_TARGET_OUTPUT_NAME}
-                -D_JAVA_TARGET_OUTPUT_LINK=${_JAVA_TARGET_OUTPUT_LINK}
-                -P ${_JAVA_SYMLINK_SCRIPT}
-            WORKING_DIRECTORY ${CMAKE_JAVA_CLASS_OUTPUT_PATH}
-            COMMENT "Creating Java archive ${_JAVA_TARGET_OUTPUT_NAME}"
-        )
-    else ()
-        add_custom_command(
-            TARGET ${_TARGET_NAME}
-            COMMAND ${CMAKE_Java_ARCHIVE}
-                -cf ${CMAKE_CURRENT_BINARY_DIR}/${_JAVA_TARGET_OUTPUT_NAME}
-                ${_JAVA_RESOURCE_FILES} @java_class_filelist
-            COMMAND ${CMAKE_COMMAND}
-                -D_JAVA_TARGET_DIR=${CMAKE_CURRENT_BINARY_DIR}
-                -D_JAVA_TARGET_OUTPUT_NAME=${_JAVA_TARGET_OUTPUT_NAME}
-                -D_JAVA_TARGET_OUTPUT_LINK=${_JAVA_TARGET_OUTPUT_LINK}
-                -P ${_JAVA_SYMLINK_SCRIPT}
-            WORKING_DIRECTORY ${CMAKE_JAVA_CLASS_OUTPUT_PATH}
-            COMMENT "Creating Java archive ${_JAVA_TARGET_OUTPUT_NAME}"
-        )
-    endif (CMAKE_JNI_TARGET)
-
-    set(${_TARGET_NAME}_INSTALL_FILES
-        ${CMAKE_CURRENT_BINARY_DIR}/${_JAVA_TARGET_OUTPUT_NAME}
-        PARENT_SCOPE)
-    if (_JAVA_TARGET_OUTPUT_LINK)
-        set(${_TARGET_NAME}_INSTALL_FILES
-            ${CMAKE_CURRENT_BINARY_DIR}/${_JAVA_TARGET_OUTPUT_NAME}
-            ${CMAKE_CURRENT_BINARY_DIR}/${_JAVA_TARGET_OUTPUT_LINK}
-            PARENT_SCOPE)
-        if (CMAKE_JNI_TARGET)
-            set(${_TARGET_NAME}_JNI_SYMLINK
-                ${CMAKE_CURRENT_BINARY_DIR}/${_JAVA_TARGET_OUTPUT_LINK}
-                PARENT_SCOPE)
-        endif (CMAKE_JNI_TARGET)
-    endif (_JAVA_TARGET_OUTPUT_LINK)
-    set(${_TARGET_NAME}_JAR_FILE
-        ${CMAKE_CURRENT_BINARY_DIR}/${_JAVA_TARGET_OUTPUT_NAME} PARENT_SCOPE)
-    set(${_TARGET_NAME}_CLASS_DIR
-        ${CMAKE_JAVA_CLASS_OUTPUT_PATH}
-         PARENT_SCOPE)
-endfunction(add_jar)
-
-function(INSTALL_JAR _TARGET_NAME _DESTINATION)
-    if (${_TARGET_NAME}_INSTALL_FILES)
-        install(
-            FILES
-                ${${_TARGET_NAME}_INSTALL_FILES}
-            DESTINATION
-                ${_DESTINATION}
-        )
-    else (${_TARGET_NAME}_INSTALL_FILES)
-        message(SEND_ERROR "The target ${_TARGET_NAME} is not known in this scope.")
-    endif (${_TARGET_NAME}_INSTALL_FILES)
-endfunction(INSTALL_JAR _TARGET_NAME _DESTINATION)
-
-function(INSTALL_JNI_SYMLINK _TARGET_NAME _DESTINATION)
-    if (${_TARGET_NAME}_JNI_SYMLINK)
-        install(
-            FILES
-                ${${_TARGET_NAME}_JNI_SYMLINK}
-            DESTINATION
-                ${_DESTINATION}
-        )
-    else (${_TARGET_NAME}_JNI_SYMLINK)
-        message(SEND_ERROR "The target ${_TARGET_NAME} is not known in this scope.")
-    endif (${_TARGET_NAME}_JNI_SYMLINK)
-endfunction(INSTALL_JNI_SYMLINK _TARGET_NAME _DESTINATION)
-
-function (find_jar VARIABLE)
-    set(_jar_names)
-    set(_jar_files)
-    set(_jar_versions)
-    set(_jar_paths
-        /usr/share/java/
-        /usr/local/share/java/
-        ${Java_JAR_PATHS})
-    set(_jar_doc "NOTSET")
-
-    set(_state "name")
-
-    foreach (arg ${ARGN})
-        if (${_state} STREQUAL "name")
-            if (${arg} STREQUAL "VERSIONS")
-                set(_state "versions")
-            elseif (${arg} STREQUAL "NAMES")
-                set(_state "names")
-            elseif (${arg} STREQUAL "PATHS")
-                set(_state "paths")
-            elseif (${arg} STREQUAL "DOC")
-                set(_state "doc")
-            else (${arg} STREQUAL "NAMES")
-                set(_jar_names ${arg})
-                if (_jar_doc STREQUAL "NOTSET")
-                    set(_jar_doc "Finding ${arg} jar")
-                endif (_jar_doc STREQUAL "NOTSET")
-            endif (${arg} STREQUAL "VERSIONS")
-        elseif (${_state} STREQUAL "versions")
-            if (${arg} STREQUAL "NAMES")
-                set(_state "names")
-            elseif (${arg} STREQUAL "PATHS")
-                set(_state "paths")
-            elseif (${arg} STREQUAL "DOC")
-                set(_state "doc")
-            else (${arg} STREQUAL "NAMES")
-                set(_jar_versions ${_jar_versions} ${arg})
-            endif (${arg} STREQUAL "NAMES")
-        elseif (${_state} STREQUAL "names")
-            if (${arg} STREQUAL "VERSIONS")
-                set(_state "versions")
-            elseif (${arg} STREQUAL "PATHS")
-                set(_state "paths")
-            elseif (${arg} STREQUAL "DOC")
-                set(_state "doc")
-            else (${arg} STREQUAL "VERSIONS")
-                set(_jar_names ${_jar_names} ${arg})
-                if (_jar_doc STREQUAL "NOTSET")
-                    set(_jar_doc "Finding ${arg} jar")
-                endif (_jar_doc STREQUAL "NOTSET")
-            endif (${arg} STREQUAL "VERSIONS")
-        elseif (${_state} STREQUAL "paths")
-            if (${arg} STREQUAL "VERSIONS")
-                set(_state "versions")
-            elseif (${arg} STREQUAL "NAMES")
-                set(_state "names")
-            elseif (${arg} STREQUAL "DOC")
-                set(_state "doc")
-            else (${arg} STREQUAL "VERSIONS")
-                set(_jar_paths ${_jar_paths} ${arg})
-            endif (${arg} STREQUAL "VERSIONS")
-        elseif (${_state} STREQUAL "doc")
-            if (${arg} STREQUAL "VERSIONS")
-                set(_state "versions")
-            elseif (${arg} STREQUAL "NAMES")
-                set(_state "names")
-            elseif (${arg} STREQUAL "PATHS")
-                set(_state "paths")
-            else (${arg} STREQUAL "VERSIONS")
-                set(_jar_doc ${arg})
-            endif (${arg} STREQUAL "VERSIONS")
-        endif (${_state} STREQUAL "name")
-    endforeach (arg ${ARGN})
-
-    if (${_jar_names} STREQUAL "")
-        message(FATAL_ERROR "find_jar: No name to search for given")
-    endif (${_jar_names} STREQUAL "")
-
-    foreach (jar_name ${_jar_names})
-        foreach (version ${_jar_versions})
-            set(_jar_files ${_jar_files} ${jar_name}-${version}.jar)
-        endforeach (version ${_jar_versions})
-        set(_jar_files ${_jar_files} ${jar_name}.jar)
-    endforeach (jar_name ${_jar_names})
-
-    find_file(${VARIABLE}
-        NAMES   ${_jar_files}
-        PATHS   ${_jar_paths}
-        DOC     ${_jar_doc}
-        NO_DEFAULT_PATH)
-endfunction (find_jar VARIABLE)
-
-function(create_javadoc _target)
-    set(_javadoc_packages)
-    set(_javadoc_files)
-    set(_javadoc_sourcepath)
-    set(_javadoc_classpath)
-    set(_javadoc_installpath "${CMAKE_INSTALL_PREFIX}/share/javadoc")
-    set(_javadoc_doctitle)
-    set(_javadoc_windowtitle)
-    set(_javadoc_author FALSE)
-    set(_javadoc_version FALSE)
-    set(_javadoc_use FALSE)
-
-    set(_state "package")
-
-    foreach (arg ${ARGN})
-        if (${_state} STREQUAL "package")
-            if (${arg} STREQUAL "PACKAGES")
-                set(_state "packages")
-            elseif (${arg} STREQUAL "FILES")
-                set(_state "files")
-            elseif (${arg} STREQUAL "SOURCEPATH")
-                set(_state "sourcepath")
-            elseif (${arg} STREQUAL "CLASSPATH")
-                set(_state "classpath")
-            elseif (${arg} STREQUAL "INSTALLPATH")
-                set(_state "installpath")
-            elseif (${arg} STREQUAL "DOCTITLE")
-                set(_state "doctitle")
-            elseif (${arg} STREQUAL "WINDOWTITLE")
-                set(_state "windowtitle")
-            elseif (${arg} STREQUAL "AUTHOR")
-                set(_state "author")
-            elseif (${arg} STREQUAL "USE")
-                set(_state "use")
-            elseif (${arg} STREQUAL "VERSION")
-                set(_state "version")
-            else ()
-                set(_javadoc_packages ${arg})
-                set(_state "packages")
-            endif ()
-        elseif (${_state} STREQUAL "packages")
-            if (${arg} STREQUAL "FILES")
-                set(_state "files")
-            elseif (${arg} STREQUAL "SOURCEPATH")
-                set(_state "sourcepath")
-            elseif (${arg} STREQUAL "CLASSPATH")
-                set(_state "classpath")
-            elseif (${arg} STREQUAL "INSTALLPATH")
-                set(_state "installpath")
-            elseif (${arg} STREQUAL "DOCTITLE")
-                set(_state "doctitle")
-            elseif (${arg} STREQUAL "WINDOWTITLE")
-                set(_state "windowtitle")
-            elseif (${arg} STREQUAL "AUTHOR")
-                set(_state "author")
-            elseif (${arg} STREQUAL "USE")
-                set(_state "use")
-            elseif (${arg} STREQUAL "VERSION")
-                set(_state "version")
-            else ()
-                list(APPEND _javadoc_packages ${arg})
-            endif ()
-        elseif (${_state} STREQUAL "files")
-            if (${arg} STREQUAL "PACKAGES")
-                set(_state "packages")
-            elseif (${arg} STREQUAL "SOURCEPATH")
-                set(_state "sourcepath")
-            elseif (${arg} STREQUAL "CLASSPATH")
-                set(_state "classpath")
-            elseif (${arg} STREQUAL "INSTALLPATH")
-                set(_state "installpath")
-            elseif (${arg} STREQUAL "DOCTITLE")
-                set(_state "doctitle")
-            elseif (${arg} STREQUAL "WINDOWTITLE")
-                set(_state "windowtitle")
-            elseif (${arg} STREQUAL "AUTHOR")
-                set(_state "author")
-            elseif (${arg} STREQUAL "USE")
-                set(_state "use")
-            elseif (${arg} STREQUAL "VERSION")
-                set(_state "version")
-            else ()
-                list(APPEND _javadoc_files ${arg})
-            endif ()
-        elseif (${_state} STREQUAL "sourcepath")
-            if (${arg} STREQUAL "PACKAGES")
-                set(_state "packages")
-            elseif (${arg} STREQUAL "FILES")
-                set(_state "files")
-            elseif (${arg} STREQUAL "CLASSPATH")
-                set(_state "classpath")
-            elseif (${arg} STREQUAL "INSTALLPATH")
-                set(_state "installpath")
-            elseif (${arg} STREQUAL "DOCTITLE")
-                set(_state "doctitle")
-            elseif (${arg} STREQUAL "WINDOWTITLE")
-                set(_state "windowtitle")
-            elseif (${arg} STREQUAL "AUTHOR")
-                set(_state "author")
-            elseif (${arg} STREQUAL "USE")
-                set(_state "use")
-            elseif (${arg} STREQUAL "VERSION")
-                set(_state "version")
-            else ()
-                list(APPEND _javadoc_sourcepath ${arg})
-            endif ()
-        elseif (${_state} STREQUAL "classpath")
-            if (${arg} STREQUAL "PACKAGES")
-                set(_state "packages")
-            elseif (${arg} STREQUAL "FILES")
-                set(_state "files")
-            elseif (${arg} STREQUAL "SOURCEPATH")
-                set(_state "sourcepath")
-            elseif (${arg} STREQUAL "INSTALLPATH")
-                set(_state "installpath")
-            elseif (${arg} STREQUAL "DOCTITLE")
-                set(_state "doctitle")
-            elseif (${arg} STREQUAL "WINDOWTITLE")
-                set(_state "windowtitle")
-            elseif (${arg} STREQUAL "AUTHOR")
-                set(_state "author")
-            elseif (${arg} STREQUAL "USE")
-                set(_state "use")
-            elseif (${arg} STREQUAL "VERSION")
-                set(_state "version")
-            else ()
-                list(APPEND _javadoc_classpath ${arg})
-            endif ()
-        elseif (${_state} STREQUAL "installpath")
-            if (${arg} STREQUAL "PACKAGES")
-                set(_state "packages")
-            elseif (${arg} STREQUAL "FILES")
-                set(_state "files")
-            elseif (${arg} STREQUAL "SOURCEPATH")
-                set(_state "sourcepath")
-            elseif (${arg} STREQUAL "DOCTITLE")
-                set(_state "doctitle")
-            elseif (${arg} STREQUAL "WINDOWTITLE")
-                set(_state "windowtitle")
-            elseif (${arg} STREQUAL "AUTHOR")
-                set(_state "author")
-            elseif (${arg} STREQUAL "USE")
-                set(_state "use")
-            elseif (${arg} STREQUAL "VERSION")
-                set(_state "version")
-            else ()
-                set(_javadoc_installpath ${arg})
-            endif ()
-        elseif (${_state} STREQUAL "doctitle")
-            if (${arg} STREQUAL "PACKAGES")
-                set(_state "packages")
-            elseif (${arg} STREQUAL "FILES")
-                set(_state "files")
-            elseif (${arg} STREQUAL "SOURCEPATH")
-                set(_state "sourcepath")
-            elseif (${arg} STREQUAL "INSTALLPATH")
-                set(_state "installpath")
-            elseif (${arg} STREQUAL "CLASSPATH")
-                set(_state "classpath")
-            elseif (${arg} STREQUAL "WINDOWTITLE")
-                set(_state "windowtitle")
-            elseif (${arg} STREQUAL "AUTHOR")
-                set(_state "author")
-            elseif (${arg} STREQUAL "USE")
-                set(_state "use")
-            elseif (${arg} STREQUAL "VERSION")
-                set(_state "version")
-            else ()
-                set(_javadoc_doctitle ${arg})
-            endif ()
-        elseif (${_state} STREQUAL "windowtitle")
-            if (${arg} STREQUAL "PACKAGES")
-                set(_state "packages")
-            elseif (${arg} STREQUAL "FILES")
-                set(_state "files")
-            elseif (${arg} STREQUAL "SOURCEPATH")
-                set(_state "sourcepath")
-            elseif (${arg} STREQUAL "CLASSPATH")
-                set(_state "classpath")
-            elseif (${arg} STREQUAL "INSTALLPATH")
-                set(_state "installpath")
-            elseif (${arg} STREQUAL "DOCTITLE")
-                set(_state "doctitle")
-            elseif (${arg} STREQUAL "AUTHOR")
-                set(_state "author")
-            elseif (${arg} STREQUAL "USE")
-                set(_state "use")
-            elseif (${arg} STREQUAL "VERSION")
-                set(_state "version")
-            else ()
-                set(_javadoc_windowtitle ${arg})
-            endif ()
-        elseif (${_state} STREQUAL "author")
-            if (${arg} STREQUAL "PACKAGES")
-                set(_state "packages")
-            elseif (${arg} STREQUAL "FILES")
-                set(_state "files")
-            elseif (${arg} STREQUAL "SOURCEPATH")
-                set(_state "sourcepath")
-            elseif (${arg} STREQUAL "CLASSPATH")
-                set(_state "classpath")
-            elseif (${arg} STREQUAL "INSTALLPATH")
-                set(_state "installpath")
-            elseif (${arg} STREQUAL "DOCTITLE")
-                set(_state "doctitle")
-            elseif (${arg} STREQUAL "WINDOWTITLE")
-                set(_state "windowtitle")
-            elseif (${arg} STREQUAL "AUTHOR")
-                set(_state "author")
-            elseif (${arg} STREQUAL "USE")
-                set(_state "use")
-            elseif (${arg} STREQUAL "VERSION")
-                set(_state "version")
-            else ()
-                set(_javadoc_author ${arg})
-            endif ()
-        elseif (${_state} STREQUAL "use")
-            if (${arg} STREQUAL "PACKAGES")
-                set(_state "packages")
-            elseif (${arg} STREQUAL "FILES")
-                set(_state "files")
-            elseif (${arg} STREQUAL "SOURCEPATH")
-                set(_state "sourcepath")
-            elseif (${arg} STREQUAL "CLASSPATH")
-                set(_state "classpath")
-            elseif (${arg} STREQUAL "INSTALLPATH")
-                set(_state "installpath")
-            elseif (${arg} STREQUAL "DOCTITLE")
-                set(_state "doctitle")
-            elseif (${arg} STREQUAL "WINDOWTITLE")
-                set(_state "windowtitle")
-            elseif (${arg} STREQUAL "AUTHOR")
-                set(_state "author")
-            elseif (${arg} STREQUAL "USE")
-                set(_state "use")
-            elseif (${arg} STREQUAL "VERSION")
-                set(_state "version")
-            else ()
-                set(_javadoc_use ${arg})
-            endif ()
-        elseif (${_state} STREQUAL "version")
-            if (${arg} STREQUAL "PACKAGES")
-                set(_state "packages")
-            elseif (${arg} STREQUAL "FILES")
-                set(_state "files")
-            elseif (${arg} STREQUAL "SOURCEPATH")
-                set(_state "sourcepath")
-            elseif (${arg} STREQUAL "CLASSPATH")
-                set(_state "classpath")
-            elseif (${arg} STREQUAL "INSTALLPATH")
-                set(_state "installpath")
-            elseif (${arg} STREQUAL "DOCTITLE")
-                set(_state "doctitle")
-            elseif (${arg} STREQUAL "WINDOWTITLE")
-                set(_state "windowtitle")
-            elseif (${arg} STREQUAL "AUTHOR")
-                set(_state "author")
-            elseif (${arg} STREQUAL "USE")
-                set(_state "use")
-            elseif (${arg} STREQUAL "VERSION")
-                set(_state "version")
-            else ()
-                set(_javadoc_version ${arg})
-            endif ()
-        endif (${_state} STREQUAL "package")
-    endforeach (arg ${ARGN})
-
-    set(_javadoc_builddir ${CMAKE_CURRENT_BINARY_DIR}/javadoc/${_target})
-    set(_javadoc_options -d ${_javadoc_builddir})
-
-    if (_javadoc_sourcepath)
-        set(_start TRUE)
-        foreach(_path ${_javadoc_sourcepath})
-            if (_start)
-                set(_sourcepath ${_path})
-                set(_start FALSE)
-            else (_start)
-                set(_sourcepath ${_sourcepath}:${_path})
-            endif (_start)
-        endforeach(_path ${_javadoc_sourcepath})
-        set(_javadoc_options ${_javadoc_options} -sourcepath ${_sourcepath})
-    endif (_javadoc_sourcepath)
-
-    if (_javadoc_classpath)
-        set(_start TRUE)
-        foreach(_path ${_javadoc_classpath})
-            if (_start)
-                set(_classpath ${_path})
-                set(_start FALSE)
-            else (_start)
-                set(_classpath ${_classpath}:${_path})
-            endif (_start)
-        endforeach(_path ${_javadoc_classpath})
-        set(_javadoc_options ${_javadoc_options} -classpath ${_classpath})
-    endif (_javadoc_classpath)
-
-    if (_javadoc_doctitle)
-        set(_javadoc_options ${_javadoc_options} -doctitle '${_javadoc_doctitle}')
-    endif (_javadoc_doctitle)
-
-    if (_javadoc_windowtitle)
-        set(_javadoc_options ${_javadoc_options} -windowtitle '${_javadoc_windowtitle}')
-    endif (_javadoc_windowtitle)
-
-    if (_javadoc_author)
-        set(_javadoc_options ${_javadoc_options} -author)
-    endif (_javadoc_author)
-
-    if (_javadoc_use)
-        set(_javadoc_options ${_javadoc_options} -use)
-    endif (_javadoc_use)
-
-    if (_javadoc_version)
-        set(_javadoc_options ${_javadoc_options} -version)
-    endif (_javadoc_version)
-
-    add_custom_target(${_target}_javadoc ALL
-        COMMAND ${JAVA_DOC} ${_javadoc_options}
-                            ${_javadoc_files}
-                            ${_javadoc_packages}
-        WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}
-    )
-
-    install(
-        DIRECTORY ${_javadoc_builddir}
-        DESTINATION ${_javadoc_installpath}
-    )
-endfunction(create_javadoc)
diff -rupN pki-core-9.0.3.orig/cmake/Modules/UseJavaClassFilelist.cmake pki-core-9.0.3/cmake/Modules/UseJavaClassFilelist.cmake
--- pki-core-9.0.3.orig/cmake/Modules/UseJavaClassFilelist.cmake	2011-02-04 08:55:45.000000000 -0800
+++ pki-core-9.0.3/cmake/Modules/UseJavaClassFilelist.cmake	1969-12-31 16:00:00.000000000 -0800
@@ -1,51 +0,0 @@
-#
-# This script create a list of compiled Java class files to be added to a
-# jar file. This avoids including cmake files which get created in the
-# binary directory.
-#
-#=============================================================================
-# Copyright 2010      Andreas schneider <asn@redhat.com>
-#
-# Distributed under the OSI-approved BSD License (the "License");
-# see accompanying file Copyright.txt for details.
-#
-# This software is distributed WITHOUT ANY WARRANTY; without even the
-# implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
-# See the License for more information.
-#=============================================================================
-# (To distributed this file outside of CMake, substitute the full
-#  License text for the above reference.)
-
-if (CMAKE_JAVA_CLASS_OUTPUT_PATH)
-    if (EXISTS "${CMAKE_JAVA_CLASS_OUTPUT_PATH}")
-
-        set(_JAVA_GLOBBED_FILES)
-        if (CMAKE_JAR_CLASSES_PREFIX)
-            foreach(JAR_CLASS_PREFIX ${CMAKE_JAR_CLASSES_PREFIX})
-                message(STATUS "JAR_CLASS_PREFIX: ${JAR_CLASS_PREFIX}")
-
-                file(GLOB_RECURSE _JAVA_GLOBBED_TMP_FILES "${CMAKE_JAVA_CLASS_OUTPUT_PATH}/${JAR_CLASS_PREFIX}/*.class")
-                if (_JAVA_GLOBBED_TMP_FILES)
-                    list(APPEND _JAVA_GLOBBED_FILES ${_JAVA_GLOBBED_TMP_FILES})
-                endif (_JAVA_GLOBBED_TMP_FILES)
-            endforeach(JAR_CLASS_PREFIX ${CMAKE_JAR_CLASSES_PREFIX})
-        else()
-            file(GLOB_RECURSE _JAVA_GLOBBED_FILES "${CMAKE_JAVA_CLASS_OUTPUT_PATH}/*.class")
-        endif (CMAKE_JAR_CLASSES_PREFIX)
-
-        set(_JAVA_CLASS_FILES)
-        # file(GLOB_RECURSE foo RELATIVE) is broken so we need this.
-        foreach(_JAVA_GLOBBED_FILE ${_JAVA_GLOBBED_FILES})
-            file(RELATIVE_PATH _JAVA_CLASS_FILE ${CMAKE_JAVA_CLASS_OUTPUT_PATH} ${_JAVA_GLOBBED_FILE})
-            set(_JAVA_CLASS_FILES ${_JAVA_CLASS_FILES}${_JAVA_CLASS_FILE}\n)
-        endforeach(_JAVA_GLOBBED_FILE ${_JAVA_GLOBBED_FILES})
-
-        # write to file
-        file(WRITE ${CMAKE_JAVA_CLASS_OUTPUT_PATH}/java_class_filelist ${_JAVA_CLASS_FILES})
-
-    else (EXISTS "${CMAKE_JAVA_CLASS_OUTPUT_PATH}")
-        message(SEND_ERROR "FATAL: Java class output path doesn't exist")
-    endif (EXISTS "${CMAKE_JAVA_CLASS_OUTPUT_PATH}")
-else (CMAKE_JAVA_CLASS_OUTPUT_PATH)
-    message(SEND_ERROR "FATAL: Can't find CMAKE_JAVA_CLASS_OUTPUT_PATH")
-endif (CMAKE_JAVA_CLASS_OUTPUT_PATH)
diff -rupN pki-core-9.0.3.orig/cmake/Modules/UseJavaSymlinks.cmake pki-core-9.0.3/cmake/Modules/UseJavaSymlinks.cmake
--- pki-core-9.0.3.orig/cmake/Modules/UseJavaSymlinks.cmake	2011-02-04 08:55:45.000000000 -0800
+++ pki-core-9.0.3/cmake/Modules/UseJavaSymlinks.cmake	1969-12-31 16:00:00.000000000 -0800
@@ -1,15 +0,0 @@
-if (UNIX AND _JAVA_TARGET_OUTPUT_LINK)
-    if (_JAVA_TARGET_OUTPUT_NAME)
-        find_program(LN_EXECUTABLE
-            NAMES
-                ln
-        )
-
-        execute_process(
-            COMMAND ${LN_EXECUTABLE} -sf "${_JAVA_TARGET_OUTPUT_NAME}" "${_JAVA_TARGET_OUTPUT_LINK}"
-            WORKING_DIRECTORY ${_JAVA_TARGET_DIR}
-        )
-    else (_JAVA_TARGET_OUTPUT_NAME)
-        message(SEND_ERROR "FATAL: Can't find _JAVA_TARGET_OUTPUT_NAME")
-    endif (_JAVA_TARGET_OUTPUT_NAME)
-endif (UNIX AND _JAVA_TARGET_OUTPUT_LINK)
